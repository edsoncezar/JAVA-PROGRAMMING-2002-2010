<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0087)http://www.planet-source-code.com/vb/scripts/ShowCodeAsText.asp?txtCodeId=6493&lngWId=4 -->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content="MSHTML 6.00.2719.2200" name=GENERATOR></HEAD>
<BODY><XMP>    '**************************************
    ' Name: LUHN Credit Card Checker
    ' Description:A simple ASP implementatio
    '     n of the industry standard LUHN check fo
    '     r credit card validity.
    ' By: Simon Rafferty
    '
    '
    ' Inputs:A Credit Card Number (as a stri
    '     ng)
    '
    ' Returns:True/False
    '
    'Assumes:There's plenty of descriptions 
    '     of how LUHN checks work on the web alrea
    '     dy, but having failed to find one in ASP
    '     - I wrote one! Try it on your card. Very
    '     useful for filtering card numbers entere
    '     d before sending them to your authorisin
    '     g service - much quicker too (generally)
    '     
    '
    'Side Effects:None
    'This code is copyrighted and has limite
    '     d warranties.
    'Please see http://www.Planet-Source-Cod
    '     e.com/xq/ASP/txtCodeId.6493/lngWId.4/qx/
    '     vb/scripts/ShowCode.htm
    'for details.
    '**************************************
    
    Public Function IsValidCCNum(sCardNum)
    '***************************************
    '     ***********************************
    '* This function Performs a LUHN check o
    '     n a card number. *
    '* If the card number is valid, it retur
    '     ns True (-1), otherwise False (0) *
    '***************************************
    '     ***********************************
    Dim sTemp
    Dim sCCNum
    Dim sTempMultiplier
    Dim nTotal
    Dim nCnt
    sCCNum = CStr(sCardNum) & ""
    nCnt = Len(sCCNum)
    If nCnt > 0 Then
    Do
    sTemp = Mid(sCCNum, nCnt , 1)
    nTotal = nTotal + CInt(sTemp)
    sTemp = Mid(sCCNum, nCnt - 1, 1)
    sTempMultiplier = CStr(CInt(sTemp) * 2)
    sTemp = Left(sTempMultiplier, 1)
    nTotal = nTotal + CInt(sTemp)
    If Len(sTempMultiplier) > 1 Then 
    sTemp = Right(sTempMultiplier, 1)
    nTotal = nTotal + CInt(sTemp)
    End If
    nCnt = nCnt - 2
    Loop Until nCnt = 0
    If (Len(sCCNum) Mod 2) = 1 Then
    Temp = Left(sCCNum, 1)
    nTotal = nTotal + CInt(nTemp)
    End If
    If (CInt(nTotal) Mod 10) = 0 Then
    IsValidCCNum = -1
    Else
    IsValidCCNum = 0
    End If
    Else
    	IsValidCCNum = 0
    End If
    End Function

		</XMP></BODY></HTML>
