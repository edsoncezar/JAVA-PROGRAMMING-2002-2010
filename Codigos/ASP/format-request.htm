<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0087)http://www.planet-source-code.com/vb/scripts/ShowCodeAsText.asp?txtCodeId=6464&lngWId=4 -->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content="MSHTML 6.00.2719.2200" name=GENERATOR></HEAD>
<BODY><XMP>    '**************************************
    ' Name: Format Request Varibles
    ' Description:Trying this with a blank R
    '     equest variable will fail with a data co
    '     nversion error:
    {Where Request("id") = ""}
    x = CLng(Request("id"))
    This will not fail:
    x = MakeLong(Request("id"))
    This code formats the values returned by the Request object. It is not meant to replace validation in your forms but assist in converting balnk strings, null values, etc. to the proper data type for saving. I found myself writing alot of if statements in my ASP pages for dealing with blank Request varibles and this fixes that with one line functions.
    ' By: Chris Shell
    '
    '
    ' Inputs:sValue = Value from your Reques
    '     t Variable.
    '
    ' Returns:Properly formatted data depend
    '     ing on function.
    '
    'Assumes:None
    '
    'Side Effects:None.
    'This code is copyrighted and has limite
    '     d warranties.
    'Please see http://www.Planet-Source-Cod
    '     e.com/xq/ASP/txtCodeId.6464/lngWId.4/qx/
    '     vb/scripts/ShowCode.htm
    'for details.
    '**************************************
    
    'These Make Functions Handle data conver
    '     sions smoothly.
    'Request object does not return formatte
    '     d data properly
    'and rather than have alot of if stateme
    '     nts I use these 
    'functions.
    Function MakeLong(sValue)
    	
    	MakeLong = 0
    	
    	If sValue <> "" Then
    		If IsNumeric(sValue) Then
    			MakeLong = CLng(sValue)
    		End if 
    	End if
    	
    End Function
    Function MakeInt(sValue)
    	
    	MakeInt = 0
    	
    	If sValue <> "" Then
    		If IsNumeric(sValue) Then
    			MakeInt = CInt(sValue)
    		End if 
    	End if
    	
    End Function
    Function MakeBool(sValue)
    	
    	MakeBool = False
    	
    	If sValue <> "" Then
    		If sValue = True Then
    			MakeBool = True
    		Elseif UCase(sValue) = "TRUE" OR UCase(sValue) = "ON" OR UCase(sValue) = "CHECKED" Then 
    			MakeBool = True
    		Elseif IsNumeric(sValue) Then
    			If CLng(sValue) <> 0 Then
    				MakeBool = True
    			End if
    		End if
    		
    	End if
    	
    End Function
    Function MakeDate(sValue)
    	
    	MakeDate = Null
    	
    	If sValue <> "" Then
    		If IsDate(sValue) Then
    			MakeDate = CDate(sValue)
    		End if
    		
    	End if
    	
    End Function
    Function MakeString(sValue)
    	If IsNull(sValue) THen
    		MakeString = ""
    	Else
    		MakeString = CStr(sValue)
    	End if
    End Function
    	

		</XMP></BODY></HTML>
