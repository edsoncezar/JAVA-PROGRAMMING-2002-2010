<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0087)http://www.planet-source-code.com/vb/scripts/ShowCodeAsText.asp?txtCodeId=8175&lngWId=4 -->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content="MSHTML 6.00.2719.2200" name=GENERATOR></HEAD>
<BODY><XMP>
    '**************************************
    ' for :ASP Format Function
    '**************************************
    Open Source
    '**************************************
    ' Name: ASP Format Function
    ' Description:This function operates sim
    '     ilarly to the VB Format function with on
    '     e big exception. The "#" character is us
    '     ed to represent any single character. Yo
    '     u can trim all non alphanumeric characte
    '     rs out and reformat them to stay consist
    '     ant.
    Usefull for credit cards, zipcodes, phone numbers, etc...
    ' By: Brian Reeves
    '
    '
    ' Inputs:None
    '
    ' Returns:None
    '
    'Assumes:Format("1234567890123", "(###) 
    '     ###-#### x######") would return "(123) 4
    '     56-7890 x123"
    Format("4111111111111111", "####-####-####-####")
    would return "4111-1111-1111-1111"
    '
    'Side Effects:None
    'This code is copyrighted and has limite
    '     d warranties.
    'Please see http://www.Planet-Source-Cod
    '     e.com/xq/ASP/txtCodeId.8175/lngWId.4/qx/
    '     vb/scripts/ShowCode.htm
    'for details.
    '**************************************
    
    '******
    '**		Formats a string to include standar
    '     d sets.
    '**
    '**		Example:	Format("1234567890", "(###
    '     ) ###-####")
    '**			Result =	(123) 456-7890
    '**		Modified 01/09/03 to allow extended
    '     format mask that will
    '**			not return extra ###'s brian reeve
    '     s
    '******
    Public Function Format(sValue, sMask)
    	Dim iPlaceHolder
    	Dim sTempValue
    	Dim sResult
    	
    	sTempValue = CStr(sValue)
    	sResult = sMask
    	Do Until InStr(sResult, "#") = 0
    		iPlaceHolder = InStr(sResult, "#")
    		sResult = Replace(sResult, "#", Left(sTempValue, 1), 1, 1)
    		sTempValue = Mid(sTempValue, 2)
    		If Len(sTempValue) = 0 Then sResult = Left(sResult, iPlaceHolder)
    	Loop
    	Format = sResult
    End Function
		</XMP></BODY></HTML>
