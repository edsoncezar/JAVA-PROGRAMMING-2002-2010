<HTML>
<HEAD>
<TITLE>Binomial Trees</TITLE>
</HEAD>
<BODY bgcolor="#FFFFFF">
 <img src="..\icons\cover75.gif" alt="Cover" align=right>
<b>Data Structures and Algorithms 
with Object-Oriented Design Patterns in Java</b><br>
<A NAME="tex2html6450" HREF="page369.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html6448" HREF="page367.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html6442" HREF="page367.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html6452" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html6453" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <BR><HR>
<H2><A NAME="SECTION0012410000000000000000">Binomial Trees</A></H2>
<P>
A binomial tree is a general tree with a very special shape:
<P>
<BLOCKQUOTE> <b>Definition (Binomial Tree)</b><A NAME="defnbinomialtree">&#160;</A>
The <em>binomial tree of order  <IMG WIDTH=36 HEIGHT=26 ALIGN=MIDDLE ALT="tex2html_wrap_inline60398" SRC="img723.gif"  ></em> with root <I>R</I>
is the tree  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65448" SRC="img1459.gif"  > defined as follows
<OL><LI> If <I>k</I>=0,  <IMG WIDTH=108 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65452" SRC="img1460.gif"  >.
	That is, the binomial tree of order zero consists of a single node, <I>R</I>.<LI> If <I>k</I><I>&gt;</I>0,  <IMG WIDTH=195 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65458" SRC="img1461.gif"  >.
	That is, the binomial tree of order <I>k</I><I>&gt;</I>0 comprises the root <I>R</I>,
	 and <I>k</I> binomial subtrees,  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65466" SRC="img1462.gif"  >,  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65468" SRC="img1463.gif"  >, ...,  <IMG WIDTH=35 HEIGHT=21 ALIGN=MIDDLE ALT="tex2html_wrap_inline65470" SRC="img1464.gif"  >.
</OL></BLOCKQUOTE>
<P>
Figure&nbsp;<A HREF="page368.html#figbinom1"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> shows the first five binomial trees,  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65466" SRC="img1462.gif"  >- <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65474" SRC="img1465.gif"  >.
It follows directly from Definition&nbsp;<A HREF="page368.html#defnbinomialtree"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> that the root of  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65448" SRC="img1459.gif"  >,
the binomial tree of order <I>k</I>,
has degree <I>k</I>.
Since <I>k</I> may arbitrarily large,
so too can the degree of the root.
Furthermore, the root of a binomial tree has the largest fanout of
any of the nodes in that tree.
<P>
<P><A NAME="26034">&#160;</A><A NAME="figbinom1">&#160;</A> <IMG WIDTH=575 HEIGHT=426 ALIGN=BOTTOM ALT="figure25767" SRC="img1466.gif"  ><BR>
<STRONG>Figure:</STRONG> Binomial trees  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65466" SRC="img1462.gif"  >,  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65468" SRC="img1463.gif"  >, ...,  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65474" SRC="img1465.gif"  >.<BR>
<P>
<P>
The number of nodes in a binomial tree of order <I>k</I> is a function of <I>k</I>:
<P>
<BLOCKQUOTE> <b>Theorem</b><A NAME="theorempqueuesv">&#160;</A>
The binomial tree of order <I>k</I>,  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65448" SRC="img1459.gif"  >,
contains  <IMG WIDTH=13 HEIGHT=13 ALIGN=BOTTOM ALT="tex2html_wrap_inline57764" SRC="img176.gif"  > nodes.
</BLOCKQUOTE>
<P>
	extbfProof (By induction).
Let  <IMG WIDTH=16 HEIGHT=15 ALIGN=MIDDLE ALT="tex2html_wrap_inline65510" SRC="img1467.gif"  > be the number of nodes in  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65448" SRC="img1459.gif"  >,
a binomial tree of order <I>k</I>.
<P>
<b>Base Case</b>
By definition,  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65466" SRC="img1462.gif"  > consists a single node.
Therefore  <IMG WIDTH=81 HEIGHT=26 ALIGN=MIDDLE ALT="tex2html_wrap_inline65518" SRC="img1468.gif"  >.
<P>
<b>Inductive Hypothesis</b>
Assume that  <IMG WIDTH=53 HEIGHT=28 ALIGN=MIDDLE ALT="tex2html_wrap_inline65520" SRC="img1469.gif"  > for  <IMG WIDTH=109 HEIGHT=22 ALIGN=MIDDLE ALT="tex2html_wrap_inline65522" SRC="img1470.gif"  >, for some  <IMG WIDTH=34 HEIGHT=26 ALIGN=MIDDLE ALT="tex2html_wrap_inline65524" SRC="img1471.gif"  >.
Consider the binomial tree of order <I>l</I>+1:
<P> <IMG WIDTH=359 HEIGHT=16 ALIGN=BOTTOM ALT="displaymath65436" SRC="img1472.gif"  ><P>
Therefore the number of nodes in  <IMG WIDTH=32 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65528" SRC="img1473.gif"  > is given by
<P> <IMG WIDTH=500 HEIGHT=168 ALIGN=BOTTOM ALT="eqnarray26047" SRC="img1474.gif"  ><P>
Therefore, by induction on <I>l</I>,  <IMG WIDTH=53 HEIGHT=28 ALIGN=MIDDLE ALT="tex2html_wrap_inline65520" SRC="img1469.gif"  > for all  <IMG WIDTH=36 HEIGHT=26 ALIGN=MIDDLE ALT="tex2html_wrap_inline60398" SRC="img723.gif"  >.
<P>
It follows from Theorem&nbsp;<A HREF="page368.html#theorempqueuesv"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> that binomial trees only come
in sizes that are a power of two.
That is,  <IMG WIDTH=156 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65536" SRC="img1475.gif"  >.
Furthermore, for a given power of two,
there is exactly one shape of binomial tree.
<P>
<BLOCKQUOTE> <b>Theorem</b><A NAME="theorempqueuesvi">&#160;</A>
The height of  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65448" SRC="img1459.gif"  >, the binomial tree of order <I>k</I>, is <I>k</I>.
</BLOCKQUOTE>
<P>
	extbfProof (By induction).
Let  <IMG WIDTH=14 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65544" SRC="img1476.gif"  > be the height of  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65448" SRC="img1459.gif"  >,
a binomial tree of order <I>k</I>.
<P>
<b>Base Case</b>
By definition,  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65466" SRC="img1462.gif"  > consists a single node.
Therefore  <IMG WIDTH=44 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65552" SRC="img1477.gif"  >.
<P>
<b>Inductive Hypothesis</b>
Assume that  <IMG WIDTH=45 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65554" SRC="img1478.gif"  > for  <IMG WIDTH=109 HEIGHT=22 ALIGN=MIDDLE ALT="tex2html_wrap_inline65522" SRC="img1470.gif"  >, for some  <IMG WIDTH=34 HEIGHT=26 ALIGN=MIDDLE ALT="tex2html_wrap_inline65524" SRC="img1471.gif"  >.
Consider the binomial tree of order <I>l</I>+1:
<P> <IMG WIDTH=359 HEIGHT=16 ALIGN=BOTTOM ALT="displaymath65436" SRC="img1472.gif"  ><P>
Therefore the height  <IMG WIDTH=32 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65528" SRC="img1473.gif"  > is given by
<P> <IMG WIDTH=500 HEIGHT=75 ALIGN=BOTTOM ALT="eqnarray26069" SRC="img1479.gif"  ><P>
Therefore, by induction on <I>l</I>,  <IMG WIDTH=45 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65554" SRC="img1478.gif"  > for all  <IMG WIDTH=36 HEIGHT=26 ALIGN=MIDDLE ALT="tex2html_wrap_inline60398" SRC="img723.gif"  >.
<P>
Theorem&nbsp;<A HREF="page368.html#theorempqueuesvi"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> tells us that the height of a binomial tree of order <I>k</I>
is <I>k</I> and Theorem&nbsp;<A HREF="page368.html#theorempqueuesv"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> tells us that the number of nodes is  <IMG WIDTH=53 HEIGHT=28 ALIGN=MIDDLE ALT="tex2html_wrap_inline65520" SRC="img1469.gif"  >.
Therefore, the height of  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65448" SRC="img1459.gif"  > is exactly  <IMG WIDTH=55 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline58840" SRC="img400.gif"  >.
<P>
Figure&nbsp;<A HREF="page368.html#figbinom2"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> shows that there are two ways
to think about the construction of binomial trees.
The first way follows directly from the Definition&nbsp;<A HREF="page368.html#defnbinomialtree"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
That is, binomial  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65448" SRC="img1459.gif"  > consists of a root node to which the <I>k</I> binomial trees
 <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65466" SRC="img1462.gif"  >,  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65468" SRC="img1463.gif"  >, ...,  <IMG WIDTH=35 HEIGHT=21 ALIGN=MIDDLE ALT="tex2html_wrap_inline65470" SRC="img1464.gif"  > are attached
as shown in Figure&nbsp;<A HREF="page368.html#figbinom2"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>&nbsp;(a).
<P>
<P><A NAME="26257">&#160;</A><A NAME="figbinom2">&#160;</A> <IMG WIDTH=575 HEIGHT=503 ALIGN=BOTTOM ALT="figure26080" SRC="img1480.gif"  ><BR>
<STRONG>Figure:</STRONG> Two views of binomial tree  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65474" SRC="img1465.gif"  >.<BR>
<P>
<P>
Alternatively, we can think of  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65448" SRC="img1459.gif"  > as being comprised of two binomial
trees of order <I>k</I>-1.
For example, Figure&nbsp;<A HREF="page368.html#figbinom2"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>&nbsp;(b) shows that  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65474" SRC="img1465.gif"  >
is made up of two instances of  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65610" SRC="img1481.gif"  >.
In general, suppose we have two trees of order <I>k</I>-1,
say  <IMG WIDTH=35 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65614" SRC="img1482.gif"  > and  <IMG WIDTH=36 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65616" SRC="img1483.gif"  >,
where  <IMG WIDTH=246 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65618" SRC="img1484.gif"  >.
Then we can construct a binomial tree of order <I>k</I> by combining
the trees to get
<P> <IMG WIDTH=389 HEIGHT=18 ALIGN=BOTTOM ALT="displaymath65438" SRC="img1485.gif"  ><P>
<P>
Why do we call  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65448" SRC="img1459.gif"  > a <em>binomial</em> tree?
It is because the number of nodes at a given depth in the tree
is determined by the <em>binomial coefficient</em>.
And the binomial coefficient derives its name from the <em>binomial theorem</em>.
And the binomial theorem tells us how to compute the  <IMG WIDTH=21 HEIGHT=13 ALIGN=BOTTOM ALT="tex2html_wrap_inline57406" SRC="img94.gif"  > power of
a <em>binomial</em><A NAME=26272>&#160;</A>.
And a binomial is an expression which consists of two terms, such as <I>x</I>+<I>y</I>.
That is why it is called a binomial tree!
<P>
<BLOCKQUOTE> <b>Theorem (Binomial Theorem)</b><A NAME="theorempqueuesbinom">&#160;</A>
The  <IMG WIDTH=21 HEIGHT=13 ALIGN=BOTTOM ALT="tex2html_wrap_inline57406" SRC="img94.gif"  > power of the binomial <I>x</I>+<I>y</I> for  <IMG WIDTH=38 HEIGHT=25 ALIGN=MIDDLE ALT="tex2html_wrap_inline57996" SRC="img238.gif"  >
is given by
<P> <IMG WIDTH=342 HEIGHT=43 ALIGN=BOTTOM ALT="displaymath65439" SRC="img1486.gif"  ><P>
where  <IMG WIDTH=88 HEIGHT=29 ALIGN=MIDDLE ALT="tex2html_wrap_inline65634" SRC="img1487.gif"  > is called the
<em>binomial coefficient</em><A NAME=26287>&#160;</A><A NAME=26288>&#160;</A>.
</BLOCKQUOTE>
<P>
	extbfProof
The proof of the binomial theorem
is left as an exercise for the reader (Exercise&nbsp;<A HREF="page383.html#exercisepqueuesbinom"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>).<A NAME="tex2html679" HREF="footnode.html#26443"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\foot_motif.gif"></A>
<P>
The following theorem gives the expression
for the number of nodes at a given depth in a binomial tree:
<P>
<BLOCKQUOTE> <b>Theorem</b><A NAME="theorempqueuesvii">&#160;</A>
The number of nodes at level <I>l</I> in  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65448" SRC="img1459.gif"  >,
the binomial tree of order <I>k</I>, where  <IMG WIDTH=63 HEIGHT=26 ALIGN=MIDDLE ALT="tex2html_wrap_inline65642" SRC="img1488.gif"  >,
is given by the <em>binomial coefficient</em>  <IMG WIDTH=18 HEIGHT=31 ALIGN=MIDDLE ALT="tex2html_wrap_inline65644" SRC="img1489.gif"  >.
</BLOCKQUOTE>
<P>
	extbfProof (By induction).
Let  <IMG WIDTH=33 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65646" SRC="img1490.gif"  > be the number of nodes at level <I>l</I> in  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65448" SRC="img1459.gif"  >,
a binomial tree of order <I>k</I>.
<P>
<b>Base Case</b>
Since  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65466" SRC="img1462.gif"  > contains a single node,
there is only one level in the tree, <I>l</I>=0,
and exactly one node at that level.
Therefore,  <IMG WIDTH=107 HEIGHT=29 ALIGN=MIDDLE ALT="tex2html_wrap_inline65658" SRC="img1491.gif"  >.
<P>
<b>Inductive Hypothesis</b>
Assume that  <IMG WIDTH=76 HEIGHT=31 ALIGN=MIDDLE ALT="tex2html_wrap_inline65660" SRC="img1492.gif"  > for  <IMG WIDTH=115 HEIGHT=22 ALIGN=MIDDLE ALT="tex2html_wrap_inline65662" SRC="img1493.gif"  >, for some  <IMG WIDTH=36 HEIGHT=26 ALIGN=MIDDLE ALT="tex2html_wrap_inline62578" SRC="img1080.gif"  >.
The binomial tree of order <I>h</I>+1 is composed of
two binomial trees of height <I>h</I>,
one attached under the root of the other.
Hence, the number of nodes at level <I>l</I> in  <IMG WIDTH=35 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline65672" SRC="img1494.gif"  >
is equal to the number of nodes at level <I>l</I> in  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65676" SRC="img1495.gif"  >
plus the number of nodes at level <I>l</I>-1 in  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline65676" SRC="img1495.gif"  >:
<P> <IMG WIDTH=500 HEIGHT=279 ALIGN=BOTTOM ALT="eqnarray26310" SRC="img1496.gif"  ><P>
Therefore by induction on <I>h</I>,  <IMG WIDTH=76 HEIGHT=31 ALIGN=MIDDLE ALT="tex2html_wrap_inline65660" SRC="img1492.gif"  >.
<P>
<HR><A NAME="tex2html6450" HREF="page369.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html6448" HREF="page367.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html6442" HREF="page367.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html6452" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html6453" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <P><ADDRESS>
<img src="..\icons\bruno.gif" alt="Bruno" align=right>
<a href="..\copyright.html">Copyright &#169; 1998</a> by <a href="..\signature.html">Bruno R. Preiss, P.Eng.</a>  All rights reserved.

</ADDRESS>
</BODY>
</HTML>
