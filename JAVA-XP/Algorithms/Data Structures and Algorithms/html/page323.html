<HTML>
<HEAD>
<TITLE>Inserting Items into an AVL Tree</TITLE>
</HEAD>
<BODY bgcolor="#FFFFFF">
 <img src="..\icons\cover75.gif" alt="Cover" align=right>
<b>Data Structures and Algorithms 
with Object-Oriented Design Patterns in Java</b><br>
<A NAME="tex2html5892" HREF="page324.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html5890" HREF="page319.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html5884" HREF="page322.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html5894" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html5895" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <BR><HR>
<H2><A NAME="SECTION0011520000000000000000">Inserting Items into an AVL Tree</A></H2>
<P>
Inserting an item into an AVL tree is a two-part process.
First, the item is inserted into the tree
using the usual method for insertion in binary search trees.
After the item has been inserted,
it is necessary to check that the resulting tree is still AVL balanced
and to balance the tree when it is not.
<P>
Just as in a regular binary search tree,
items are inserted into AVL trees by attaching them to the leaves.
To find the correct leaf we pretend that the item is already in the tree
and follow the path taken by the <tt>find</tt> method
to determine where the item should go.
Assuming that the item is not already in the tree,
the search is unsuccessful and terminates an an external, empty node.
The item to be inserted is placed in that external node.
<P>
Inserting an item in a given external node affects potentially
the heights of all of the nodes along
the <em>access path</em><A NAME=19235>&#160;</A><A NAME=19236>&#160;</A>,
i.e., the path from the root to that node.
Of course, when an item is inserted in a tree,
the height of the tree may increase by one.
Therefore, to ensure that it resulting tree is still AVL balanced,
the heights of all the nodes along the access path
must be recomputed and the AVL balance condition must be checked.
<P>
Sometimes increasing the height of a subtree does not violate the
AVL balance condition.
For example, consider an AVL tree  <IMG WIDTH=107 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline62666" SRC="img1093.gif"  >.
Let  <IMG WIDTH=16 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline63750" SRC="img1266.gif"  > and  <IMG WIDTH=18 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline63754" SRC="img1267.gif"  > be the heights of  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline62662" SRC="img1091.gif"  > and  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline62664" SRC="img1092.gif"  >, respectively.
Since <I>T</I> is an AVL tree, then  <IMG WIDTH=93 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline63848" SRC="img1289.gif"  >.
Now, suppose that  <IMG WIDTH=85 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline63850" SRC="img1290.gif"  >.
Then, if we insert an item into  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline62664" SRC="img1092.gif"  >,
its height may increase by one to  <IMG WIDTH=86 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline63854" SRC="img1291.gif"  >.
The resulting tree is still AVL balanced since  <IMG WIDTH=85 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline63856" SRC="img1292.gif"  >.
In fact, this particular insertion actually makes the tree more balanced!
Similarly if  <IMG WIDTH=58 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline63858" SRC="img1293.gif"  > initially,
an insertion in either subtree will not result in a violation
of the balance condition at the root of <I>T</I>.
<P>
On the other hand, if  <IMG WIDTH=85 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline63850" SRC="img1290.gif"  > and an the insertion of an item
into the left subtree  <IMG WIDTH=18 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline62662" SRC="img1091.gif"  > increases the height of that tree to  <IMG WIDTH=84 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline63866" SRC="img1294.gif"  >,
the AVL balance condition is no longer satisfied because  <IMG WIDTH=85 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline63868" SRC="img1295.gif"  >.
Therefore it is necessary to change the structure of the tree
to bring it back into balance.
<P>
<BR> <HR>
<UL> 
<LI> <A NAME="tex2html5896" HREF="page324.html#SECTION0011521000000000000000">Balancing AVL Trees</A>
<LI> <A NAME="tex2html5897" HREF="page325.html#SECTION0011522000000000000000">Single Rotations</A>
<LI> <A NAME="tex2html5898" HREF="page326.html#SECTION0011523000000000000000">Double Rotations</A>
<LI> <A NAME="tex2html5899" HREF="page327.html#SECTION0011524000000000000000">Implementation</A>
</UL>
<HR><A NAME="tex2html5892" HREF="page324.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html5890" HREF="page319.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html5884" HREF="page322.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html5894" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html5895" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <P><ADDRESS>
<img src="..\icons\bruno.gif" alt="Bruno" align=right>
<a href="..\copyright.html">Copyright &#169; 1998</a> by <a href="..\signature.html">Bruno R. Preiss, P.Eng.</a>  All rights reserved.

</ADDRESS>
</BODY>
</HTML>
