<HTML>
<HEAD>
<TITLE>Binary Insertion Sort</TITLE>
</HEAD>
<BODY bgcolor="#FFFFFF">
 <img src="..\icons\cover75.gif" alt="Cover" align=right>
<b>Data Structures and Algorithms 
with Object-Oriented Design Patterns in Java</b><br>
<A NAME="tex2html7913" HREF="page488.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html7911" HREF="page483.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html7907" HREF="page486.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html7915" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html7916" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <BR><HR>
<H2><A NAME="SECTION0016330000000000000000">Binary Insertion Sort</A></H2>
<P>
The straight insertion algorithm presented in the preceding section
does a linear search to find the position in which to do the insertion.
However, since the element is inserted into a sequence that is already sorted,
we can use a binary search instead of a linear search.
Whereas a linear search requires <I>O</I>(<I>n</I>) comparisons in the worst case,
a binary search only requires  <IMG WIDTH=55 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline58840" SRC="img400.gif"  > comparisons.
Therefore, if the cost of a comparison is significant,
the binary search may be preferred.
<P>
Program&nbsp;<A HREF="page487.html#progBinaryInsertionSortera"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> defines
the <tt>BinaryInsertionSorter</tt> class.
The <tt>BinaryInsertionSorter</tt> class extends the
<tt>AbstractSorter</tt> class defined in Program&nbsp;<A HREF="page481.html#progAbstractSortera"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
The framework of the <tt>sort</tt> method
is essentially the same as that of
the <tt>StraightInsertionSorter</tt> class.
<P>
<P><A NAME="34996">&#160;</A><A NAME="progBinaryInsertionSortera">&#160;</A> <IMG WIDTH=575 HEIGHT=447 ALIGN=BOTTOM ALT="program34823" SRC="img2030.gif"  ><BR>
<STRONG>Program:</STRONG> <tt>BinaryInsertionSorter</tt> class <tt>sort</tt> method.<BR>
<P>
<P>
Exactly, <I>n</I>-1 iterations of the outer loop are done (lines&nbsp;6-21).
In each iteration, a binary search search is done to determine
the position at which to do the insertion (lines&nbsp;8-18).
In the  <IMG WIDTH=17 HEIGHT=13 ALIGN=BOTTOM ALT="tex2html_wrap_inline57340" SRC="img77.gif"  > iteration of the outer loop,
the binary search considers array positions 0 to <I>i</I> (for  <IMG WIDTH=64 HEIGHT=25 ALIGN=MIDDLE ALT="tex2html_wrap_inline68695" SRC="img2031.gif"  >).
The running time for the binary search in the  <IMG WIDTH=17 HEIGHT=13 ALIGN=BOTTOM ALT="tex2html_wrap_inline57340" SRC="img77.gif"  >
iteration is  <IMG WIDTH=185 HEIGHT=26 ALIGN=MIDDLE ALT="tex2html_wrap_inline68699" SRC="img2032.gif"  >.
Once the correct position is found,
at most <I>i</I> swaps are needed to insert the element in its place.
<P>
The worst-case running time of the binary insertion sort
is dominated by the <I>i</I> swaps needed to do the insertion.
Therefore, the worst-case running time is  <IMG WIDTH=39 HEIGHT=25 ALIGN=MIDDLE ALT="tex2html_wrap_inline58122" SRC="img258.gif"  >.
Furthermore, since the algorithm only swaps adjacent array elements,
the average running time is also  <IMG WIDTH=39 HEIGHT=25 ALIGN=MIDDLE ALT="tex2html_wrap_inline58122" SRC="img258.gif"  > (see Section&nbsp;<A HREF="page486.html#secsortingavg"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>).
Asymptotically, the binary insertion sort is no better than straight insertion.
<P>
However, the binary insertion sort does
fewer array element comparisons than insertion sort.
In the  <IMG WIDTH=17 HEIGHT=13 ALIGN=BOTTOM ALT="tex2html_wrap_inline57340" SRC="img77.gif"  > iteration of the outer loop,
the binary search requires  <IMG WIDTH=84 HEIGHT=26 ALIGN=MIDDLE ALT="tex2html_wrap_inline68711" SRC="img2033.gif"  > comparisons,
for  <IMG WIDTH=64 HEIGHT=25 ALIGN=MIDDLE ALT="tex2html_wrap_inline68695" SRC="img2031.gif"  >.
Therefore, the total number of comparisons is
<P> <IMG WIDTH=500 HEIGHT=96 ALIGN=BOTTOM ALT="eqnarray34836" SRC="img2034.gif"  ><P>
(This result follows directly from Theorem&nbsp;<A HREF="page353.html#theorempqueuesiii"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>).
<P>
The number of comparisons required by
the straight insertion sort is  <IMG WIDTH=39 HEIGHT=25 ALIGN=MIDDLE ALT="tex2html_wrap_inline58122" SRC="img258.gif"  > in the worst case
as well as on average.
Therefore on average, the binary insertion sort
uses fewer comparisons than straight insertion sort.
On the other hand, the previous section shows that in the best case
the running time for straight insertion is <I>O</I>(<I>n</I>).
Since the binary insertion sort method <em>always</em> does the binary search,
its best case running time is  <IMG WIDTH=68 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline58846" SRC="img402.gif"  >.
Table&nbsp;<A HREF="page487.html#tblsortinginsertion"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> summarizes the asymptotic running times
for the two insertion sorts.
<P>
<P><A NAME="34847">&#160;</A>
<P>
    <A NAME="tblsortinginsertion">&#160;</A>
    <DIV ALIGN=CENTER><P ALIGN=CENTER><TABLE COLS=4 BORDER FRAME=HSIDES RULES=GROUPS>
<COL ALIGN=LEFT><COL ALIGN=CENTER><COL ALIGN=CENTER><COL ALIGN=CENTER>
<TBODY>
<TR><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP>
	</TD><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP COLSPAN=3> running time</TD></TR>
<TR><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP>
<P>
	algorithm </TD><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP> best case </TD><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP> average case </TD><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP> worst case </TD></TR>
</TBODY><TBODY>
<TR><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP>straight insertion sort </TD><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP> <I>O</I>(<I>n</I>) </TD><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>  <IMG WIDTH=39 HEIGHT=25 ALIGN=MIDDLE ALT="tex2html_wrap_inline58122" SRC="img258.gif"  > </TD><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>  <IMG WIDTH=39 HEIGHT=25 ALIGN=MIDDLE ALT="tex2html_wrap_inline58122" SRC="img258.gif"  > </TD></TR>
<TR><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 
	binary insertion sort </TD><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>  <IMG WIDTH=68 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline58846" SRC="img402.gif"  > </TD><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>  <IMG WIDTH=39 HEIGHT=25 ALIGN=MIDDLE ALT="tex2html_wrap_inline58122" SRC="img258.gif"  > </TD><TD VALIGN=BASELINE ALIGN=CENTER NOWRAP>  <IMG WIDTH=39 HEIGHT=25 ALIGN=MIDDLE ALT="tex2html_wrap_inline58122" SRC="img258.gif"  > </TD></TR>
</TBODY>
<CAPTION ALIGN=BOTTOM><STRONG>Table:</STRONG> Running times for insertion sorting.</CAPTION></TABLE>
</P></DIV><P><HR><A NAME="tex2html7913" HREF="page488.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html7911" HREF="page483.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html7907" HREF="page486.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html7915" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html7916" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <P><ADDRESS>
<img src="..\icons\bruno.gif" alt="Bruno" align=right>
<a href="..\copyright.html">Copyright &#169; 1998</a> by <a href="..\signature.html">Bruno R. Preiss, P.Eng.</a>  All rights reserved.

</ADDRESS>
</BODY>
</HTML>
