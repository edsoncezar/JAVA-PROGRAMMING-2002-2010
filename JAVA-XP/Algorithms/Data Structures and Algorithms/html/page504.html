<HTML>
<HEAD>
<TITLE>The Sorting Phase</TITLE>
</HEAD>
<BODY bgcolor="#FFFFFF">
 <img src="..\icons\cover75.gif" alt="Cover" align=right>
<b>Data Structures and Algorithms 
with Object-Oriented Design Patterns in Java</b><br>
<A NAME="tex2html8118" HREF="page505.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html8116" HREF="page502.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html8112" HREF="page503.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html8120" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html8121" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <BR><HR>
<H3><A NAME="SECTION0016532000000000000000">The Sorting Phase</A></H3>
<P>
Once the max heap has been built,
heapsort proceeds to the selection sorting phase.
In this phase the sorted sequence is obtained
by repeatedly withdrawing the largest element from the max heap.
Figure&nbsp;<A HREF="page504.html#figsort6"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> illustrates how this is done.
<P>
<P><A NAME="42270">&#160;</A><A NAME="figsort6">&#160;</A> <IMG WIDTH=575 HEIGHT=567 ALIGN=BOTTOM ALT="figure40559" SRC="img2098.gif"  ><BR>
<STRONG>Figure:</STRONG> Heap sorting.<BR>
<P>
<P>
The largest element of the heap is always found at the root
and the root of a complete tree is always in array position one.
Suppose the heap occupies array positions 1 through <I>k</I>.
When an element is withdrawn from the heap,
its length decreases by one.
That is, after the withdrawal the heap occupies array positions 1 through <I>k</I>-1.
Thus, array position <I>k</I> is no longer required by the max heap.
However, the next element of the sorted sequence belongs in position <I>k</I>!
<P>
So, the sorting phase of heapsort works like this:
We repeatedly swap the largest element in the heap (always in position 1)
into the next position of the sorted sequence.
After each such swap,
there is a new value at the root of the heap and
this new value is pushed down into the correct position in the heap
using the <tt>percolateDown</tt> method.
<P>
Program&nbsp;<A HREF="page504.html#progHeapSorterc"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> gives the <tt>sort</tt> method
of the <tt>HeapSorter</tt> class.
The <tt>sort</tt> method embodies both phases of the heapsort algorithm.
In the first phase of heapsort
the <tt>buildHeap</tt> method is called to transform
the array into a max heap.
As discussed above, this is done in <I>O</I>(<I>n</I>) time.
<P>
<P><A NAME="42506">&#160;</A><A NAME="progHeapSorterc">&#160;</A> <IMG WIDTH=575 HEIGHT=313 ALIGN=BOTTOM ALT="program42279" SRC="img2099.gif"  ><BR>
<STRONG>Program:</STRONG> <tt>HeapSorter</tt> class <tt>sort</tt> method.<BR>
<P>
<P>
The second phase of the heapsort algorithm builds the sorted list.
In all <I>n</I>-1 iterations of the loop on lines&nbsp;9-13 are required.
Each iteration involves one swap
followed by a <tt>percolateDown</tt> operation.
Since the worst-case running time for <tt>percolateDown</tt> is  <IMG WIDTH=55 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline58840" SRC="img400.gif"  >,
the total running time of the loop is  <IMG WIDTH=68 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline58846" SRC="img402.gif"  >.
The running time of the second phase asymptotically dominates
that of the first phase.
As a result, the worst-case running time of heapsort is  <IMG WIDTH=68 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline58846" SRC="img402.gif"  >.
<P>
<HR><A NAME="tex2html8118" HREF="page505.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html8116" HREF="page502.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html8112" HREF="page503.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html8120" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html8121" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <P><ADDRESS>
<img src="..\icons\bruno.gif" alt="Bruno" align=right>
<a href="..\copyright.html">Copyright &#169; 1998</a> by <a href="..\signature.html">Bruno R. Preiss, P.Eng.</a>  All rights reserved.

</ADDRESS>
</BODY>
</HTML>
