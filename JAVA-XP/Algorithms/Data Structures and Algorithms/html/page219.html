<HTML>
<HEAD>
<TITLE>Floating-Point Keys</TITLE>
</HEAD>
<BODY bgcolor="#FFFFFF">
 <img src="..\icons\cover75.gif" alt="Cover" align=right>
<b>Data Structures and Algorithms 
with Object-Oriented Design Patterns in Java</b><br>
<A NAME="tex2html4601" HREF="page220.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html4599" HREF="page217.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html4593" HREF="page218.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html4603" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html4604" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <BR><HR>
<H2><A NAME="SECTION009320000000000000000">Floating-Point Keys</A></H2>
<P>
Dealing with floating-point number involves only a little more work.
In Java the floating-point data types are <tt>float</tt> and <tt>double</tt>.
The size of a <tt>float</tt> is 32&nbsp;bits
and the size of a <tt>double</tt> is 64&nbsp;bits.
<P>
We seek a function <I>f</I> which maps a floating-point value
into a non-negative integer.
One possibility is to simply reinterpret the bit pattern
used to represent the floating point number as an integer.
However, this is only possible when the size of the floating-point type
does not exceed the size of <tt>int</tt>.
This condition is satisfied only by the <tt>float</tt> type.
<P>
Another characteristic of floating-point numbers that must be dealt with
is the extremely wide range of values which can be represented.
For example, when using IEEE floating-point,
the smallest double precision quantity that can be represented is
 <IMG WIDTH=72 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline61484" SRC="img883.gif"  >
and the largest is  <IMG WIDTH=99 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline61486" SRC="img884.gif"  >.
Somehow we need to map values in this large domain
into the range of an <tt>int</tt>.
<P>
Every non-zero floating-point quantity <I>x</I> can be written uniquely as
<P> <IMG WIDTH=320 HEIGHT=16 ALIGN=BOTTOM ALT="displaymath61480" SRC="img885.gif"  ><P>
where  <IMG WIDTH=63 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline61490" SRC="img886.gif"  >,  <IMG WIDTH=83 HEIGHT=25 ALIGN=MIDDLE ALT="tex2html_wrap_inline61492" SRC="img887.gif"  > and  <IMG WIDTH=125 HEIGHT=25 ALIGN=MIDDLE ALT="tex2html_wrap_inline61494" SRC="img888.gif"  >.
The quantity <I>s</I> is called the <em>sign</em><A NAME=10658>&#160;</A>,
<I>m</I> is called the <em>mantissa</em><A NAME=10660>&#160;</A>
or <em>significant</em><A NAME=10662>&#160;</A>
and <I>e</I> is called the <em>exponent</em><A NAME=10664>&#160;</A>.
This suggests the following definition for the function <I>f</I>:
<P><A NAME="eqnhashingfp">&#160;</A> <IMG WIDTH=500 HEIGHT=48 ALIGN=BOTTOM ALT="equation10665" SRC="img889.gif"  ><P>
where  <IMG WIDTH=54 HEIGHT=12 ALIGN=BOTTOM ALT="tex2html_wrap_inline61190" SRC="img851.gif"  > such that <I>w</I> is the word size of the machine.
<P>
This hashing method is best understood by considering
the conditions under which a collision occurs
between two distinct floating-point numbers <I>x</I> and <I>y</I>.
Let  <IMG WIDTH=20 HEIGHT=15 ALIGN=MIDDLE ALT="tex2html_wrap_inline61512" SRC="img890.gif"  > and  <IMG WIDTH=20 HEIGHT=16 ALIGN=MIDDLE ALT="tex2html_wrap_inline61514" SRC="img891.gif"  > be the mantissas of <I>x</I> and <I>y</I>, respectively.
The collision occurs when <I>f</I>(<I>x</I>)=<I>f</I>(<I>y</I>).
<P> <IMG WIDTH=500 HEIGHT=104 ALIGN=BOTTOM ALT="eqnarray10672" SRC="img892.gif"  ><P>
Thus, <I>x</I> and <I>y</I> collide if their mantissas differ by less than 1/2<I>W</I>.
Notice that the sign of the number is not considered.
Thus, <I>x</I> and -<I>x</I> collide
Also, the exponent is not considered.
Therefore, if <I>x</I> and <I>y</I> collide,
then so too do <I>x</I> and  <IMG WIDTH=43 HEIGHT=27 ALIGN=MIDDLE ALT="tex2html_wrap_inline61538" SRC="img893.gif"  > for all permissible values of <I>k</I>.
<P>
Program&nbsp;<A HREF="page219.html#progDblb"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> completes the definition of the <tt>Dbl</tt> wrapper class
introduced in Program&nbsp;<A HREF="page117.html#progDbla"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
The <tt>hashCode</tt> function shown computes the
hash function defined in Equation&nbsp;<A HREF="page219.html#eqnhashingfp"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
<P>
<P><A NAME="10979">&#160;</A><A NAME="progDblb">&#160;</A> <IMG WIDTH=575 HEIGHT=237 ALIGN=BOTTOM ALT="program10681" SRC="img894.gif"  ><BR>
<STRONG>Program:</STRONG> <tt>Dbl</tt> class <tt>hashCode</tt> method.<BR>
<P>
<P>
This implementation makes use of the fact that in the
IEEE standard floating-point format
the least-significant 52 bits of a 64-bit floating-point number
represent the quantity  <IMG WIDTH=136 HEIGHT=27 ALIGN=MIDDLE ALT="tex2html_wrap_inline61542" SRC="img895.gif"  >.
Since an <tt>int</tt> is a 32-bit quantity,  <IMG WIDTH=58 HEIGHT=13 ALIGN=BOTTOM ALT="tex2html_wrap_inline61292" SRC="img861.gif"  >,
and we can rewrite Equation&nbsp;<A HREF="page219.html#eqnhashingfp"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> as follows:
<P> <IMG WIDTH=500 HEIGHT=67 ALIGN=BOTTOM ALT="eqnarray10696" SRC="img896.gif"  ><P>
Thus, we can compute the hash function simply by shifting
the binary representation of the floating-point number
20 bits to the right as shown in Program&nbsp;<A HREF="page219.html#progDblb"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
Clearly the running time of the <tt>hashCode</tt> method is <I>O</I>(1).
<P>
<HR><A NAME="tex2html4601" HREF="page220.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html4599" HREF="page217.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html4593" HREF="page218.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html4603" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html4604" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <P><ADDRESS>
<img src="..\icons\bruno.gif" alt="Bruno" align=right>
<a href="..\copyright.html">Copyright &#169; 1998</a> by <a href="..\signature.html">Bruno R. Preiss, P.Eng.</a>  All rights reserved.

</ADDRESS>
</BODY>
</HTML>
