<HTML>
<HEAD>
<TITLE>Implementation</TITLE>
</HEAD>
<BODY bgcolor="#FFFFFF">
 <img src="..\icons\cover75.gif" alt="Cover" align=right>
<b>Data Structures and Algorithms 
with Object-Oriented Design Patterns in Java</b><br>
<A NAME="tex2html9075" HREF="page583.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html9073" HREF="page581.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html9069" HREF="page581.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html9077" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html9078" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <BR><HR>
<H3><A NAME="SECTION0017601000000000000000">Implementation</A></H3>
<P>
Given an activity-node graph,
the objective of critical path analysis is to determine
the slack time for each activity and
thereby to identify the critical activities and the critical path.
We shall assume that the activity node graph
has already been transformed to an edge-node graph.
The implementation of this transformation
is left as a project for the reader (Project&nbsp;<A HREF="page584.html#projectgraphsxform"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>).
Therefore, the first step is to compute the earliest and latest event times.
<P>
According to Equation&nbsp;<A HREF="page581.html#eqngraphsetime"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>,
the earliest event time of vertex <I>w</I>
is obtained from the earliest event times of all its predecessors.
Therefore, must compute the earliest event times
<em>in topological order</em>.
To do this, we define the <tt>EarliestTimeVisitor</tt>
shown in Program&nbsp;<A HREF="page582.html#progAlgorithmsi"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
<P>
<P><A NAME="54945">&#160;</A><A NAME="progAlgorithmsi">&#160;</A> <IMG WIDTH=575 HEIGHT=524 ALIGN=BOTTOM ALT="program54942" SRC="img2486.gif"  ><BR>
<STRONG>Program:</STRONG> Critical path analysis--computing earliest event times.<BR>
<P>
<P>
The <tt>EarliestTimeVisitor</tt> has one field, <tt>earliestTime</tt>,
which is an array used to record the  <IMG WIDTH=16 HEIGHT=23 ALIGN=MIDDLE ALT="tex2html_wrap_inline71817" SRC="img2477.gif"  > values.
The <tt>visit</tt> method of the <tt>EarliestTimeVisitor</tt> 
class implements directly Equation&nbsp;<A HREF="page581.html#eqngraphsetime"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
It uses an <tt>getIncidentEdges</tt> enumeration to determine
all the predecessors of a given node
and computes  <IMG WIDTH=186 HEIGHT=25 ALIGN=MIDDLE ALT="tex2html_wrap_inline71875" SRC="img2487.gif"  >.
<P>
In order to compute the latest event times,
it is necessary to define also a <tt>LatestTimeVisitor</tt>.
This visitor must visit the vertices of the event-node graph
in <em>reverse topological order</em>.
Its implementation follows directly from Equation&nbsp;<A HREF="page581.html#eqngraphsltime"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>
and Program&nbsp;<A HREF="page582.html#progAlgorithmsi"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
<P>
Program&nbsp;<A HREF="page582.html#progAlgorithmsh"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> defines the method
called <tt>criticalPathAnalysis</tt> that does what its name implies.
This method takes as its argument a <tt>Digraph</tt>
that represents an event-node graph.
This implementation assumes that the edge weights are instances of the
<tt>Int</tt> class defined in Program&nbsp;<A HREF="page117.html#progInta"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
<P>
<P><A NAME="54972">&#160;</A><A NAME="progAlgorithmsh">&#160;</A> <IMG WIDTH=575 HEIGHT=638 ALIGN=BOTTOM ALT="program54969" SRC="img2488.gif"  ><BR>
<STRONG>Program:</STRONG> Critical path analysis--finding the critical paths.<BR>
<P>
<P>
The method first uses the <tt>EarliestTimeVisitor</tt> in a
topological order traversal to compute the earliest event times
which are recored in the <tt>earliestTime</tt> array (lines&nbsp;7-10).
Next, the latest event times are computed and recorded in
the <tt>latestTime</tt> array.
Notice that this is done using a <tt>LatestTimeVisitor</tt>
in a <em>postorder</em> depth-first traversal (lines&nbsp;12-15).
This is because a postorder depth-first traversal
is equivalent to a topological order traversal in reverse!
<P>
Once the earliest and latest event times have been found,
we can compute the slack time for each edge.
In the implementation shown,
an edge-weighted graph is constructed that is isomorphic with the
the original event-node graph,
but in which the edge weights are the slack times
as given by Equation&nbsp;<A HREF="page581.html#eqngraphsslack"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> (lines&nbsp;17-30).
By constructing such a graph we can make use of Dijkstra's algorithm
find the shortest path from start to finish
since the shortest path must be the critical path (line&nbsp;31).
<P>
The <tt>DijkstrasAlgorithm</tt> method given in Section&nbsp;<A HREF="page565.html#secgraphsdijkstra"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>
returns its result in the form of a shortest-path graph.
The shortest-path graph for the activity-node graph of Figure&nbsp;<A HREF="page581.html#figcritical2"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>
is shown in Figure&nbsp;<A HREF="page582.html#figcritical3"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
By following the path in this graph from vertex&nbsp;9 back to vertex&nbsp;0,
we find that the critical path is  <IMG WIDTH=104 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline71877" SRC="img2489.gif"  >.
<P>
<P><A NAME="55328">&#160;</A><A NAME="figcritical3">&#160;</A> <IMG WIDTH=575 HEIGHT=148 ALIGN=BOTTOM ALT="figure54986" SRC="img2490.gif"  ><BR>
<STRONG>Figure:</STRONG> The critical path graph corresponding to Figure&nbsp;<A HREF="page581.html#figcritical2"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.<BR>
<P><HR><A NAME="tex2html9075" HREF="page583.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html9073" HREF="page581.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html9069" HREF="page581.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html9077" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html9078" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <P><ADDRESS>
<img src="..\icons\bruno.gif" alt="Bruno" align=right>
<a href="..\copyright.html">Copyright &#169; 1998</a> by <a href="..\signature.html">Bruno R. Preiss, P.Eng.</a>  All rights reserved.

</ADDRESS>
</BODY>
</HTML>
