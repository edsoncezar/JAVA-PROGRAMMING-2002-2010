<HTML>
<HEAD>
<TITLE>Implementation</TITLE>
</HEAD>
<BODY bgcolor="#FFFFFF">
 <img src="..\icons\cover75.gif" alt="Cover" align=right>
<b>Data Structures and Algorithms 
with Object-Oriented Design Patterns in Java</b><br>
<A NAME="tex2html5942" HREF="page328.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html5940" HREF="page323.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html5936" HREF="page326.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html5944" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html5945" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <BR><HR>
<H3><A NAME="SECTION0011524000000000000000">Implementation</A></H3>
<P>
Program&nbsp;<A HREF="page327.html#progAVLTreec"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> gives the code for the <tt>doLLRotation</tt>
method of the <tt>AVLTree</tt> class.
This code implements the LL rotation shown in Figure&nbsp;<A HREF="page325.html#figavl1"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
The purpose of the <tt>doLLRotation</tt> method 
is to perform an LL rotation at the root of a given AVL tree instance.
<P>
<P><A NAME="20313">&#160;</A><A NAME="progAVLTreec">&#160;</A> <IMG WIDTH=575 HEIGHT=466 ALIGN=BOTTOM ALT="program20157" SRC="img1301.gif"  ><BR>
<STRONG>Program:</STRONG> <tt>AVLTree</tt> class <tt>doLLRotation</tt> method.<BR>
<P>
<P>
The rotation is simply a sequence of variable manipulations
followed by two height adjustments.
Notice the rotation is done in such a way so that the
the given <tt>AVLTree</tt> instance remains the root of the tree.
This is done so that if the tree has a parent,
it is not necessary to modify the contents of the parent.
<P>
The <tt>AVLTree</tt> class also requires an <tt>doRRRotation</tt>
method to implement an RR rotation.
The implementation of that method
follows directly from Program&nbsp;<A HREF="page327.html#progAVLTreec"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
Clearly, the running time for the single rotations is <I>O</I>(1).
<P>
Program&nbsp;<A HREF="page327.html#progAVLTreed"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> gives the implementation for the
<tt>doLRRotation</tt> method of the <tt>AVLTree</tt> class.
This double rotation is trivially implemented as a sequence of
two single rotations.
As above, the method for the complementary rotation
is easily derived from the given code.
The running time for each of the double rotation methods is also <I>O</I>(1).
<P>
<P><A NAME="20315">&#160;</A><A NAME="progAVLTreed">&#160;</A> <IMG WIDTH=575 HEIGHT=275 ALIGN=BOTTOM ALT="program20173" SRC="img1302.gif"  ><BR>
<STRONG>Program:</STRONG> <tt>AVLTree</tt> class <tt>doLRRotation</tt> method.<BR>
<P>
<P>
When an imbalance is detected, it is necessary to correct the imbalance
by doing the appropriate rotation.
The code given in Program&nbsp;<A HREF="page327.html#progAVLTreee"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A> takes care of this.
The <tt>balance</tt> method tests for an imbalance by calling
the <tt>getBalanceFactor</tt> method.
The balance test itself takes constant time.
If the node is balanced, only a constant-time height adjustment is needed.
<P>
<P><A NAME="20317">&#160;</A><A NAME="progAVLTreee">&#160;</A> <IMG WIDTH=575 HEIGHT=485 ALIGN=BOTTOM ALT="program20185" SRC="img1303.gif"  ><BR>
<STRONG>Program:</STRONG> <tt>AVLTree</tt> class <tt>balance</tt> method.<BR>
<P>
<P>
Otherwise, the <tt>balance</tt> method of the <tt>AVLTree</tt> class
determines which of the four cases has occurred,
and invokes the appropriate rotation to correct the imbalance.
To determine which case has occurred,
the <tt>balance</tt> method calls the <tt>getBalanceFactor</tt>
method at most twice.
Therefore, the time for selecting the case is constant.
In all only one rotation is done to correct the imbalance.
Therefore, the running time of this method is <I>O</I>(1).
<P>
The <tt>insert</tt> method for AVL trees is inherited from
the <tt>BinarySearchTree</tt> class (see Program&nbsp;<A HREF="page316.html#progBinarySearchTreed"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>).
The <tt>insert</tt> method calls <tt>attachKey</tt> to do the actual insertion.
The <tt>attachKey</tt> method is overridden in the <tt>AVLTree</tt> class
as shown in Program&nbsp;<A HREF="page327.html#progAVLTreef"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
<P>
<P><A NAME="20319">&#160;</A><A NAME="progAVLTreef">&#160;</A> <IMG WIDTH=575 HEIGHT=313 ALIGN=BOTTOM ALT="program20206" SRC="img1304.gif"  ><BR>
<STRONG>Program:</STRONG> <tt>AVLTree</tt> class <tt>attachKey</tt> method.<BR>
<P>
<P>
The very last thing that the <tt>insert</tt>
method does is to call the <tt>balance</tt> method.
which has also been overridden as shown in Program&nbsp;<A HREF="page327.html#progAVLTreee"><IMG  ALIGN=BOTTOM ALT="gif" SRC="..\icons\cross_ref_motif.gif"></A>.
As a result the <tt>insert</tt> method
adjusts the heights of the nodes along the insertion path
and does a rotation when an imbalance is detected.
Since the height of an AVL tree is guaranteed to be  <IMG WIDTH=55 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline58840" SRC="img400.gif"  >,
the time for insertion is simply  <IMG WIDTH=55 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline58840" SRC="img400.gif"  >.
<P>
<HR><A NAME="tex2html5942" HREF="page328.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="..\icons\next_motif.gif"></A> <A NAME="tex2html5940" HREF="page323.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="..\icons\up_motif.gif"></A> <A NAME="tex2html5936" HREF="page326.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="..\icons\previous_motif.gif"></A> <A NAME="tex2html5944" HREF="page9.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="..\icons\contents_motif.gif"></A> <A NAME="tex2html5945" HREF="page618.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="..\icons\index_motif.gif"></A> <P><ADDRESS>
<img src="..\icons\bruno.gif" alt="Bruno" align=right>
<a href="..\copyright.html">Copyright &#169; 1998</a> by <a href="..\signature.html">Bruno R. Preiss, P.Eng.</a>  All rights reserved.

</ADDRESS>
</BODY>
</HTML>
