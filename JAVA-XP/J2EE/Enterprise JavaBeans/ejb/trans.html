<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<title>JTS and Transactions by Gopalan Suresh Raj</title>
</head>

<body bgcolor="#FFFFFF">

<p align="center"><a
        href="http://www.execpc.com/~gopalan/index.html"><img
        src="..\..\resources\wc.gif"
        border="0" width="200" height="45"></a></p>

<p align="center"><font color="#000080" size="5" face="Arial"><strong>Transactions,
2PC and JTS</strong></font><font face="Verdana"><br>
</font><a href="http://www.execpc.com/~gopalan/personal/cv.html"><font
color="#000080" size="4" face="Verdana">Gopalan Suresh Raj</font></a></p>

<p><font size="4" face="Arial"><b>What are Transactions?</b></font></p>

<p><font size="2" face="Verdana">The most important concept that
you have to be aware of when dealing with enterprise applications
is the concept of a <i>transaction</i>. To a user, a transaction
is a single change event that either happens or doesn't happen.
To system implementers, a transaction is a programming style that
allows them to code modules that can participate in distributed
computations. To illustrate the concept, let us assume that you
want to transfer money from a savings account into a checking
account. In this scenario, it is critical that both the accounts
are changed from a successful transaction and neither is affected
from an unsuccessful one. You just cannot afford to have your
money vaporize if crediting your checking account fails for any
reason after the debit on your savings account! Although this may
sound like a fairly straightforward request, it is hard to make
this work in a distributed system without deploying some form of
transaction control - computers can fail and messages can be
easily lost. </font></p>

<p><font size="2" face="Verdana">Transactions provide a way to
bundle a set of operations into an atomic execution unit. </font></p>

<p><font size="2" face="Verdana">This atomic
&quot;all-or-nothing&quot; property is not new: it appears
throughout life. For example, a minister conducting a marriage
ceremony first asks the bride and groom, &quot;Do you take this
person to be your spouse?&quot; Only if they both respond &quot;I
do&quot; does the minister pronounce them married and <i>commit</i>
the transaction. In short, within any transaction, several
independent entities must agree before the deal is done. If any
party disagrees, the deal is off and the independent entities are
reverted back to their original state by invoking a <i>rollover</i>
operation.</font></p>

<p><font size="2" face="Verdana">Transactions are essential for
distributed applications. Further, transactions provide modular
execution, which complements a component technology&#146;s
modular programming.</font></p>

<p><font face="Arial"><strong>The ACID properties</strong></font></p>

<p><font size="2" face="Verdana">All transactions subscribe to
the following &quot;ACID&quot; properties:</font></p>

<p><font size="2" face="Verdana"><strong><i>Atomicity:</i></strong><strong>
</strong>A transaction either commits or rollbacks. If a
transaction commits, all of its effects remain. If it rollbacks,
then all of its effects are undone. For example, in renaming an
object, both the new name is created and the old name is deleted
(commit), or nothing changes (rollback).</font></p>

<p><font size="2" face="Verdana"><strong><i>Consistency:</i></strong><strong>
</strong>A transaction always leads to a correct transformation
of the system state by preserving the state invariance. For
example, a transaction adding an element to a doubly linked list,
all four forward and backward pointers are updated. </font></p>

<p><font size="2" face="Verdana"><strong><i>Isolation:</i></strong>
Concurrent transactions are isolated from the updates of other
incomplete transactions. This property is also often called <i>serializability</i>.
For example, a second transaction traversing a doubly linked list
already undergoing modification by a first transaction will see
only completed changes, and be isolated from any non-committed
changes of the first transaction.</font></p>

<p><font size="2" face="Verdana"><strong><i>Durability: </i></strong>If
a transaction commits, its effects will be permanent after the
transaction commits. In fact, the effects remain even in the face
of system failures. It is up to the application to decide what
consistency is and to bracket its computation to delimit these
consistent transformations. It is the job of the transactional
resource managers to provide consistent, isolated and durable
transformations of the objects they manage. If the transactions
are distributed among multiple computers, the <i>two-phase commit
protocol</i> is used to make these transactions atomic and
durable.</font></p>

<p>&nbsp;</p>

<p><font size="4" face="Arial"><strong>The Java Transaction
Service </strong></font></p>

<p><font size="2" face="Verdana">The Java Transaction Service
(JTS) plays the role of a <i>transaction coordinator</i> for all
the constituent components of the EJB architecture. In JTS
terminology, the director is called the <i>transaction manager</i>.
The participants in the transaction that implement
transaction-protected resources such as relational databases are
called <i>resource managers</i>. When an application begins a
transaction, it creates a transaction object that represents the
transaction. The application then invokes the resource managers
to perform the work of the transaction. As the transaction
progresses, the transaction manager keeps track of each of the
resource managers enlisted in the transaction. </font></p>

<p><font size="2" face="Verdana">The application's first call to
each resource manager identifies the current transaction. For
example, if the application is using a relational database, it
calls the JDBC interface, which associates the transaction object
with the JDBC connection. Thereafter, all calls made over that
connection are performed on behalf of the database transaction
until it ends.</font></p>

<p><font size="2" face="Verdana">Typically, the application
completes the transaction by invoking a </font><font size="1"
face="Verdana">xa_commit()</font><font size="2" face="Verdana">
method and the transaction is said to commit. If the application
is unable to complete for any reason, it performs a rollover by
calling the </font><font size="1" face="Verdana">xa_rollback()</font><font
size="2" face="Verdana"> method which undoes the transaction's
actions. If the application fails, the JTS aborts the
transaction. When the application successfully completes the
transaction's work, it calls the JTS to commit the transaction.
The JTS then goes through a two-phase commit protocol to get all
of the enlisted resource managers to commit. </font></p>

<p><font face="Arial"><b>Two-phase commits</b></font></p>

<p><font size="2" face="Verdana">The two-phase commit protocol
ensures that all the resource managers either commit a
transaction or abort it. In the first phase, the JTS asks each
resource manager if it is prepared to commit. If all the
participants affirm, then in the second phase the JTS broadcasts
a commit message to all of them. If any part of the transaction
fails - for instance, if a resource manager fails to respond to
the prepare request, or if a resource manager responds
negatively, then the JTS notifies all of the resource managers
that the transaction is aborted. This is the essence of the
two-phase commit protocol.</font></p>

<p><a href="..\ejb.html"><font
size="2" face="Verdana">click here to go to</font><font size="4"
face="Verdana"> </font><br>
<font size="4" face="Verdana">My EJB HomePage...</font></a></p>

<p>&nbsp;</p>

<table border="1" cellpadding="2" width="95%">
    <tr>
        <td valign="top" width="100%" bgcolor="#004080"><font
        color="#FFCC00" size="4" face="Verdana">About the Author...</font></td>
    </tr>
    <tr>
        <td valign="top" width="100%" bgcolor="#FFF2F2"><a
        href="http://www.execpc.com/~gopalan/personal/cv.html"><font
        color="#000080" size="2" face="Tahoma"><strong>Gopalan
        Suresh Raj</strong></font></a><font size="2"
        face="Tahoma"><strong> </strong>is a Software Architect,
        Developer and an active Author. He is contributing author
        to a couple of books &quot;<strong>Enterprise Java
        Computing-Applications and Architecture</strong>&quot;
        and &quot;<strong>The Awesome Power of JavaBeans</strong>&quot;.
        His expertise spans enterprise component architectures
        and distributed object computing. Visit him at his </font><a
        href="http://www.execpc.com/~gopalan"><font size="2"
        face="Tahoma"><strong>Web Cornucopia</strong><sup><strong>©</strong></sup></font></a><font
        size="2" face="Tahoma"> site (<strong>http://www.execpc.com/~gopalan</strong>)
        or mail him at </font><a href="mailto:gopalan@execpc.com"><font
        size="2" face="Tahoma"><strong>gopalan@execpc.com</strong></font></a><font
        size="2" face="Tahoma">.</font></td>
    </tr>
</table>

<hr>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td align="center"><p align="center"><a
        href="http://www.execpc.com/~gopalan/index.html"><font
        color="#000000"><img
        src="..\..\resources\home(2).gif"
        alt="Go to the Component Engineering Cornucopia page"
        width="65" height="44" start="fileopen"></font></a></p>
        </td>
        <td align="center" colspan="2"><p align="center"><font
        color="#000080" size="4" face="Arial Narrow"><strong>This
        site was developed and is maintained by </strong></font><a
        href="http://www.execpc.com/~gopalan/personal/cv.html"
        style="COLOR: rgb(0,0,128)"><font color="#000080"
        size="4" face="Arial Narrow"><strong>Gopalan Suresh Raj</strong></font></a></p>
        <p align="center"><font color="#000080" size="4"
        face="Arial Narrow"><strong>This page has been visited </strong></font><font
        color="#000080"><img
        src="..\..\..\..\counter.execpc.com\cgi-bin\nph-count\width=5&link=~gopalan_misc_compare3.html"></font><font
        color="#000080" size="4" face="Arial Narrow"><strong>
        times since September 21,1998.</strong></font></p>
        </td>
    </tr>
</table>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td align="center"><p align="center"><font
        color="#800000" size="3">Last Updated : Dec 19, '98</font></p>
        </td>
        <td colspan="2"><p align="center"><a
        href="mailto:gopalan@execpc.com"><font color="#800000"
        size="4" face="Arial Narrow">If you have any questions,
        comments, or problems regarding this site, please write
        to me I would love to hear from you</font></a><font
        color="#800000" size="4" face="Arial Narrow">.</font></p>
        </td>
    </tr>
</table>

<hr>
<div align="center"><center>

<table border="0" cellspacing="1" width="693" height="54">
    <tr>
        <td width="689" height="27"><p align="center"><font
        color="#000000" size="1" face="Courier New">Copyright (c)
        1997-98, </font><a
        href="http://www.execpc.com/~gopalan/personal/cv.html"
        style="COLOR: rgb(0,0,128)"><font color="#000000"
        size="1" face="Courier New">Gopalan Suresh Raj</font></a><font
        color="#000000" size="1" face="Courier New"> - All rights
        reserved. </font><a
        href="http://www.execpc.com/~gopalan/misc/cpright.html"
        style="COLOR: rgb(0,0,128)"><font color="#000000"
        size="1" face="Courier New">Terms of use</font></a><font
        color="#000000" size="1" face="Courier New">.</font></p>
        </td>
    </tr>
    <tr>
        <td width="689" height="27"><p align="center"><font
        color="#000000" size="1" face="Courier New">All products
        and companies mentioned at this site are trademarks of
        their respective owners.</font></p>
        </td>
    </tr>
</table>
</center></div><!-- start of NedStat code -->

<p align="center"><a
href="http://usa.nedstat.net/cgi-bin/viewstat?name=java_tutorial"><img
src="..\..\..\..\usa.nedstat.net\cgi-bin\nedstat.gif\name=java_tutorial"
align="right" border="0" hspace="0"></a> <!-- end of NedStat code --> </p>
<script language="JavaScript">
<!--
  document.write("<img src=\"http://usa.nedstat.net/cgi-bin/referstat.gif?name=java_tutorial&refer="+escape(top.document.referrer)+"\" width=1 height=1 alt=\"\">");
// -->
</script>

<!-- eXTReMe digital Web Tracking Code Starts Here -->
<a target="_top" href="http://w.extreme-dm.com/?login=javatrac">
<img name=im src="..\..\..\..\w1.extreme-dm.com\i.gif" height=38
border=0 width=41 alt=""></a><script language="javascript"><!--
an=navigator.appName;d=document;function
pr(){d.write("<img src=\"http://w0.extreme-dm.com",
"/0.gif?tag=javatrac&j=y&srw="+srw+"&srb="+srb+"&",
"rs="+r+"&l="+escape(d.referrer)+"\" height=1 ",
"width=1>");}srb="na";srw="na";//-->
</script><script language="javascript1.2"><!--
s=screen;srw=s.width;an!="Netscape"?
srb=s.colorDepth:srb=s.pixelDepth;//-->
</script><script language="javascript"><!--
r=41;d.images?r=d.im.width:z=0;pr();//-->
</script><noscript><img height=1 width=1 alt=""
src="..\..\..\..\w0.extreme-dm.com\0.gif\tag=javatrac&j=n"></noscript>
<!-- eXTReMe digital Web Tracking Code Ends Here  -->


</body>
</html>
