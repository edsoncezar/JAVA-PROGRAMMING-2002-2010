<?xml version="1.0" encoding="UTF-8" ?>         
<!DOCTYPE struts-config PUBLIC
       "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
       "http://jakarta.apache.org/struts/dtds/struts-config_1_1.dtd">          
         
<struts-config>

<!--
<data-sources>
 <data-source>
  <set-property property="autoCommit" value="true"/>
  <set-property property="description" value="Resin Data Source"/>
  <set-property property="driverClass" value="com.caucho.jdbc.mysql.Driver"/>
  <set-property property="maxCount" value="10"/>
  <set-property property="minCount" value="2"/>
  <set-property property="user" value="admin"/>  
  <set-property property="password" value="admin"/>
  <set-property property="url" value="jdbc:mysql-caucho://localhost:3306/storefront"/>  
 </data-source>
</data-sources>
-->

<form-beans> 
  <form-bean name="loginForm" type="com.oreilly.struts.storefront.security.LoginForm"/>        
  <form-bean 
      name="itemDetailForm"
      dynamic="true"
      type="org.apache.struts.action.DynaActionForm">
        <form-property name="view" type="com.oreilly.struts.catalog.view.ItemView"/>        
  </form-bean>
</form-beans>

 <global-exceptions>
  <exception 
    key="global.error.invalidlogin"
    path="/security/signin.jsp"
    scope="request"
    type="com.oreilly.struts.framework.exceptions.InvalidLoginException"/>  
 </global-exceptions>

<global-forwards>
 <forward name="Login" path="/security/signin.jsp" redirect="true"/>
 <forward name="SystemFailure" path="/common/systemerror.jsp"/>
 <forward name="SessionTimeOut" path="/common/sessiontimeout.jsp" redirect="true"/>
 
 <forward name="welcome" path="viewsignin"/>
</global-forwards>

<action-mappings>
 <!-- Security Actions Begin -->
 <action
   path="/viewsignin"
   parameter="/security/signin.jsp"
   type="org.apache.struts.actions.ForwardAction"   
   scope="request"   
   name="loginForm"
   validate="false"
   input="/index.jsp">   
 </action> 
 
 <action
   path="/signin"
   type="com.oreilly.struts.storefront.security.LoginAction"
   scope="request"
   name="loginForm"
   validate="true"
   input="/security/signin.jsp">
   <forward name="Success" path="/index.jsp" redirect="true"/>
   <forward name="Failure" path="/security/signin.jsp" redirect="true"/>
 </action> 
 
 <action
   path="/signoff"
   type="com.oreilly.struts.storefront.security.LogoutAction"
   scope="request"   
   validate="false"
   input="/security/signin.jsp">
   <forward name="Success" path="/index.jsp" redirect="true"/>   
 </action>

 <action
   path="/home"
   parameter="/index.jsp"
   type="org.apache.struts.actions.ForwardAction"   
   scope="request"      
   validate="false">   
 </action>  
 <!-- Security Actions End -->
 
  <!-- Shopping Cart Actions Begin -->
 <action
   path="/viewcart"
   parameter="/order/shoppingcart.jsp"
   type="org.apache.struts.actions.ForwardAction"   
   scope="request"      
   validate="false">   
 </action>
 
 <action path="/cart"
   type="com.oreilly.struts.storefront.order.ShoppingCartActions"   
   scope="request"
   input="/order/shoppingcart.jsp"
   validate="false"
   parameter="method">
   <forward name="Success" path="/order/shoppingcart.jsp" redirect="true"/>
 </action> 
 <!-- Shopping Cart Actions End -->
 
 <!-- Catalog Actions Begin -->
 <action
    path="/viewitemdetail"
    name="itemDetailForm"
    input="/index.jsp"
    type="com.oreilly.struts.storefront.catalog.GetItemDetailAction"   
    scope="request"      
    validate="false">   
    <forward name="Success" path="/catalog/itemdetail.jsp"/>
 </action> 
 <!-- Catalog Actions End -->
 
 <!-- Order Actions Begin -->
 <action
     path="/begincheckout"     
     input="/order/shoppingcart.jsp"
     type="com.oreilly.struts.storefront.order.CheckoutAction"   
     scope="request"
     validate="false">
     <forward name="Success" path="/order/processing_checkout.jsp"/>
 </action>
 
<action
     path="/processcheckout"     
     input="/order/shoppingcart.jsp"
     type="com.oreilly.struts.storefront.order.CheckoutComplete"   
     scope="request"
     validate="false">
     <forward name="Success" path="/order/checkout.jsp"/>
     <forward name="StillProcessing" path="/order/processing_checkout.jsp"/>     
 </action> 
 
<action
     path="/getorderhistory"     
     input="/order/orderhistory.jsp"
     type="com.oreilly.struts.storefront.order.GetOrderHistoryAction"   
     scope="request"
     validate="false">
     <forward name="Success" path="/order/orderhistory.jsp"/>
 </action>  
 <!-- Order Actions End -->
</action-mappings>
  
<controller 
  contentType="text/html;charset=UTF-8"
  debug="3"
  locale="true"
  nocache="true"
  processorClass="com.oreilly.struts.framework.CustomRequestProcessor"/>
  
<message-resources 
	parameter="StorefrontMessageResources" 
	null="false"/>
<message-resources 
	key="IMAGE_RESOURCE_KEY" 
	parameter="StorefrontImageResources" 
	null="false"/>
 
</struts-config>