<HTML>
<HEAD>


<TITLE>Developing Java Enterprise Applications:MiniJMS: A Java Messaging Service Provider</TITLE>





<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="26-02.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="26-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
</P>
<TABLE WIDTH="100%">
<TD CAPTION COLSPAN="2" ALIGN="LEFT"><B>Table 26.3</B> MiniJMS Client Classes
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TH WIDTH="35%" ALIGN="LEFT">JMS INTERFACE
<TH ALIGN="LEFT">MINIJMS CLASS
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>Destination</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniDestination</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>ConnectionFactory</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniConnectionFactory</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>Connection</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniConnection</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>Session</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniSession</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MessageConsumer</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniConsumer</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MessageProducer</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniProducer</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>Message</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniMessage</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>ConnectionMetaData</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniJMSConnectionMetaData</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>Queue</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniDestination</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>QueueConnectionFactory</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniQueueConnectionFactory</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>QueueConnection</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniQueueConnection</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>QueueSession</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniQueueSession</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>QueueSender</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniProducer</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>QueueReceiver</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniConsumer</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>TemporaryQueue</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniTempDestination</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>Topic</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniDestination</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>TopicConnectionFactory</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniTopicConnectionFactory</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>TopicConnection</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniTopicConnection</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>TopicSession</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniTopicSession</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>TopicPublisher</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniProducer</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>TopicSubscriber</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniConsumer</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>TemporaryTopic</SMALL>
<TD VALIGN="TOP" ALIGN="LEFT"><SMALL>MiniTempDestination</SMALL>
<TR>
<TD COLSPAN="2"><HR>
<TR>
</TABLE>
<P>Both destinations and messages are entity-type objects that represent data but don&#146;t perform any real operations. These two objects are discussed before the remaining client libraries to provide a foundation for the discussion.
</P>
<H4 ALIGN="LEFT"><A NAME="Heading5"></A><FONT COLOR="#000077">MiniDestination</FONT></H4>
<P>MiniDestination objects are used to represent destinations in the MiniJMS system. A MiniDestination, as defined by the following code, can be a queue or a topic. The object keeps a flag indicating which type it should be treated as. Aside from storing a name and this isQueue flag, the destination&#146;s only other method is the getReference method, defined in Referenceable, used to allow the destination to be bound into a JNDI context. (Support for JNDI is discussed in more detail at the end of this section on the client library.)
</P>
<PRE>
package minijms;

//Import statements removed to save space.

public class MiniDestination
 implements Destination, Topic, Queue, Serializable, Referenceable
{
    protected String name;
    protected boolean isQ;

    public MiniDestination(String name, boolean isQueue)
    {
        this.name = name;
        isQ = isQueue;
    }

    public int hashCode()
    {
        return name.hashCode();
    }

    public boolean equals(Object o)
    {
        boolean retVal = false;

        if(o instanceof MiniDestination)
        {
            if((name!=null)&amp&amp name.equals(o.toString()))
            {
                if(((MiniDestination)o).isQueue()
                    ==isQueue()) retVal = true;
            }
        }

        return retVal;
    }

    public String toString()
    {
        return name;
    }

    public boolean isQueue()
    {
        return isQ;
    }

    public java.lang.String getTopicName()
     throws JMSException
    {
        if(!isQ)
            return name;
        else
            throw new JMSException();
    }

    public java.lang.String getQueueName()
     throws JMSException
    {
        if(isQ)
            return name;
        else
            throw new JMSException();
    }

    public Reference getReference()
                       throws NamingException
    {
        Reference retVal;

        retVal = new Reference(MiniDestination.class.getName()
                        ,new StringRefAddr(&#147;name&#148;,name)
                        ,MiniDestinationFactory.class.getName()
                        ,null);

        retVal.add(new StringRefAddr(&#147;isQueue&#148;
                    ,(isQ?&#147;true&#148;:&#147;false&#148;)));

        return retVal;
    }
}
</PRE>
<P>MiniDestination also implements Serializable so that it can be passed around in RMI messages or saved to disk.
</P>
<P>The MiniJMSServer uses destinations as keys in hash tables and searches for them in vectors. To make this searching correct, both the hash code and equals methods are defined to ensure that two destinations are equal if they have the same name and isQueue flag.</P>
<H4 ALIGN="LEFT"><A NAME="Heading6"></A><FONT COLOR="#000077">MiniMessage</FONT></H4>
<P>Messages in the MiniJMS system are all represented by a MiniMessage object or an instance of a subclass of MiniMessage. This class has a lot of code, the majority of which is accessor methods for the header fields. The code for these methods follows. One addition made to the regular header fields is that messages keep track of their session. This connection is used to implement the acknowledge message. MiniMessages uses the property JMS_MSG_NUM to test equality with other messages. MiniMessage implements Message and it implements Serializable, so it can be passed as part of an RMI message.
</P><P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="26-02.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="26-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>





</BODY>
</HTML>

