<HTML>
<HEAD>


<TITLE>Developing Java Enterprise Applications:A Four-Tier Online Store</TITLE>





<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="25-10.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="25-12.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>The main code for this method is highlighted to separate it from the simple output of HTML. Like the error message page, this one contains a link back to the referer if one is provided.
</P>
<PRE>
    protected void outputCart(Hashtable cart
                                 ,PrintWriter out
                                ,String requestURL
                                ,String referer)
    {
        ShoppingCartItem item;
        Enumeration items;
        float total=0;
        
<B>        items = cart.elements();</B>
        
        out.println(&#147;&ltHTML&gt&#148;);
        out.println(&#147;&ltHEAD&gt&#148;);
        out.println(&#147;&ltTITLE&gt&#148;);
        out.println(&#147;Shopping Cart&#148;);
        out.println(&#147;&lt/TITLE&gt&#148;);
        out.println(&#147;&lt/HEAD&gt&#148;);
        out.println(&#147;&ltBODY TEXT=\&#148;#000000\&#147; BGCOLOR=\&#148;#FFFFFF\&#147;&#148;);
        out.println(&#147; LINK=\&#148;#FF0000\&#147; VLINK=\&#148;#800080\&#147;&gt&#148;);
        out.println(&#147;&ltCENTER&gt&#148;);
        out.println(&#147;&ltTABLE WIDTH=500 BORDER=0&gt&#148;);
        out.println(&#147;&ltTR&gt&#148;);
        out.println(&#147;&ltTD&gt&#148;);
        
        out.println(&#147;&ltCENTER&gt&ltH1&gtShopping Cart&lt/H1&gt&lt/CENTER&gt&#148;);
        out.println(&#147;Your shopping cart contains the following items:&ltBR&gt&#148;);
        out.println(&#147;&ltTABLE&gt&#148;);
        out.println(&#147;&ltTR&gt&#148;);
        out.println(&#147;&ltTH&gtDescription&lt/TH&gt&#148;);
        out.println(&#147;&ltTH&gtQuantity&lt/TH&gt&#148;);
        out.println(&#147;&ltTH&gtPrice&lt/TH&gt&#148;);
        out.println(&#147;&ltTH&gtTotal&lt/TH&gt&#148;);
        out.println(&#147;&ltTH&gt&lt/TH&gt&#148;);
        out.println(&#147;&lt/TR&gt&#148;);
        
<B>        while((items!=null)&amp&amp(items.hasMoreElements()))
        {
            item = (ShoppingCartItem) items.nextElement();
        
            outputItem(item,out,requestURL,referer);
        
            total += item.getTotal();
        }</B>
        
        out.println("&ltTR&gt");
        out.println("&ltTD&gt&lt/TD&gt");
        out.println("&ltTD&gt&lt/TD&gt");
        out.println("&ltTD&gt&ltB&gtTotal&lt/B&gt&lt/TD&gt");
        out.print("&ltTD&gt&ltB&gt");
<B>        out.print(formatter.format(total));</B>
        out.println("&lt/B&gt&lt/TD&gt");
        out.println("&ltTD&gt&lt/TD&gt");
        out.println("&lt/TR&gt");

        out.println("&lt/TABLE&gt");
        
        out.println("&ltBR&gt&ltP ALIGN=Right&gt");
        out.print("&ltFORM ACTION=\"");
        out.print(requestURL);
        out.println("\" METHOD=\"GET\"&gt");
        
        out.println("&ltINPUT TYPE=\"SUBMIT\" NAME=\"action\" VALUE=\"Purchase\"&gt");
        
        out.println("&lt/FORM&gt");
        out.println("&lt/P&gt");
        
        if((referer!=null)&amp&amp(referer.length()&gt0))
        {
            out.print("&ltCENTER&gt&ltH4&gt&ltA HREF=\"");
            out.print(referer);
            out.print("?referer=");
            out.print(referer);
            out.println("\"&gtBack&lt/A&gt&lt/H4&gt&lt/CENTER&gt");
        }
        
        out.println("&lt/TD&gt");
        out.println("&lt/TR&gt");
        out.println("&lt/TABLE&gt");
        out.println("&lt/CENTER&gt");
        out.println("&lt/BODY&gt");
        out.println("&lt/HTML&gt");
        out.close();
    }
</PRE>
<P>The outputItem method outputs a form containing a single HTML table row. This row includes the description, price, and quantity for a ShoppingCartItem as well as the total price for all of the items of this type ordered. Hidden fields are used when necessary to pass data back to the servlet. The value of the Submit button is used to tell the servlet which action is being requested between delete and adjust.
</P>
<PRE>
    protected void outputItem(ShoppingCartItem item
                                 ,PrintWriter out
                                ,String act
                                ,String referer)
    {
        out.print(&#147;&ltFORM ACTION=\&#148;&#147;);
        out.print(act);
        out.println(&#147;\&#148; METHOD=\&#147;GET\&#148;&gt&#147;);
        out.println(&#147;&ltTR&gt&#148;);
        out.print(&#147;&ltTD&gt&#148;);
        out.print(item.desc);
        out.println(&#147;&lt/TD&gt&#148;);
        out.print(&#147;&ltTD&gt&ltINPUT TYPE=\&#148;TEXT\&#147; &#148;
                    +&#147;NAME=\&#148;quantity\&#147; VALUE=\&#148;&#147;);
        out.print(item.quantity);
        out.println(&#147;\&#148; SIZE=3&gt&lt/TD&gt&#147;);
        out.print(&#147;&ltTD&gt&#148;);
        out.print(formatter.format(item.price));
        out.println(&#147;&lt/TD&gt&#148;);
        out.print(&#147;&ltTD&gt&#148;);
        out.print(formatter.format(item.getTotal()));
        out.println(&#147;&lt/TD&gt&#148;);
        
        //Output the change form buttons and hidden fields
        out.println(&#147;&ltTD&gt&#148;);
        
        out.print(&#147;&ltINPUT TYPE=\&#148;HIDDEN\&#147; NAME=\&#148;item\&#147; VALUE=\&#148;&#147;);
        out.print(item.desc);
        out.println(&#147;\&#147;&gt&#148;);
        out.print(&#147;&ltINPUT TYPE=\&#148;HIDDEN\&#147; NAME=\&#148;price\&#147; VALUE=\&#148;&#147;);
        out.print(item.price);
        out.println(&#147;\&#147;&gt&#148;);
        out.print(&#147;&ltINPUT TYPE=\&#148;HIDDEN\&#147; &#148;
                         +&#147;NAME=\&#148;referer\&#147; VALUE=\&#148;&#147;);
        out.print(referer);
        out.println(&#147;\&#147;&gt&#148;);
        
        out.println(&#147;&ltINPUT TYPE=\&#148;SUBMIT\&#147; &#148;
                          +&#147;NAME=\&#148;action\&#147; VALUE=\&#148;Adjust\&#147;&gt&#148;);
        out.println(&#147;&ltINPUT TYPE=\&#148;SUBMIT\&#147; &#148;
                          +&#147;NAME=\&#148;action\&#147; VALUE=\&#148;Delete\&#147;&gt&#148;);
        
        out.println(&#147;&lt/TD&gt&#148;);
        
        out.println(&#147;&lt/TR&gt&#148;);
        
        out.println(&#147;&lt/FORM&gt&#148;);
    }
</PRE>
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="25-10.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="25-12.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>





</BODY>
</HTML>

