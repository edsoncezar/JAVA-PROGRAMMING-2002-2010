<HTML>
<HEAD>


<TITLE>Developing Java Enterprise Applications:A Four-Tier Online Store</TITLE>





<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="25-05.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="25-07.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>When the user selects a category, the link takes her to the directory associated with the category and to the index.jhtml file that the directory contains. This index.jhtml file is the home page for a category and is also a JHTML page.
</P>
<P>Like the store&#146;s home page, the category pages dynamically display a list. In this case, the list contains the items in the category. To create the list, the category page looks at the available files. An example of one of these pages is pictured in Figure 25.9.</P>
<P>Although the implementation for these pages refers to different classes, the code is nearly identical to the example in Chapter 11, &#147;A JavaServer Page Online Store.&#148; Rather than reproduce that code here, we direct you to the example in that chapter for details on the category page code.</P>
<P>The items for the store each has its own HTML pages. These pages should include buttons to add the item to the shopper&#146;s cart and view the current contents of the cart, such as the one pictured in Figure 25.10.</P>
<P>The HTML for this page follows. It contains two forms, which appear in boldface type; these forms target the ShoppingCartServlet discussed in the next section. This servlet manages the client&#146;s shopping cart. The forms use hidden fields to pass information about the product to the servlet, the quantity being ordered, the expected price, and the action that the servlet should take. In the case of the view action, no item information is required.</P>
<P><A NAME="Fig9"></A><A HREF="images\25-09.jpg"><IMG SRC="images\25-09t.jpg"></A>
<BR><A HREF="images\25-09.jpg"><FONT COLOR="#000077"><B>Figure 25.9</B></FONT></A>&nbsp;&nbsp;A category page.</P>
<P><A NAME="Fig10"></A><A HREF="images\25-10.jpg"><IMG SRC="images\25-10t.jpg"></A>
<BR><A HREF="images\25-10.jpg"><FONT COLOR="#000077"><B>Figure 25.10</B></FONT></A>&nbsp;&nbsp;A product page.</P>
<PRE>
&ltHTML&gt
 &ltHEAD&gt
   &ltTITLE&gtProgramming With JFC&lt/TITLE&gt
&lt/HEAD&gt
&ltBODY TEXT=&#147;#000000&#148; BGCOLOR=&#147;#FFFFFF&#148;
 LINK=&#147;#FF0000&#148; VLINK=&#147;#800080&#148;&gt
&ampnbsp;
&ltCENTER&gt&ltTABLE BORDER=0 WIDTH=&#147;500&#148; &gt
&ltTR&gt
&ltTD&gt
&ltCENTER&gt&ltIMG SRC=&#147;./jfc.gif&#148; NOSAVE HEIGHT=140 WIDTH=112&gt&ampnbsp;&lt/CENTER&gt

&ltCENTER&gt
&ltH1&gt
Programming With JFC&ltBR&gt

&ltHR SIZE=1 NOSHADE WIDTH=&#147;100%&#148;&gt
&lt/H1&gt&lt/CENTER&gt

&ltCENTER&gt
&ltH3&gt
Scott R. Weiner and Stephen Asbury&lt/H3&gt&lt/CENTER&gt
A complete, how-to guide to using a powerful new pure-Java library of user-interface elements.

 &ltBR&gt&ltBR&gt
&ltCENTER&gt
&ltTABLE WIDTH=&#147;50%&#148;&gt
&ltTR&gt
&ltTD&gt
&ltH2&gt
<B>&ltFORM ACTION=&#147;/servlet/ShoppingCartServlet&#148;&gt
&ltINPUT TYPE=&#147;HIDDEN&#148; NAME=&#147;item&#148; 
    VALUE=&#147;Programming With JFC&#148;&gt
&ltINPUT TYPE=&#147;HIDDEN&#148; NAME=&#147;quantity&#148; VALUE=&#147;1&#148;&gt
&ltINPUT TYPE=&#147;HIDDEN&#148; NAME=&#147;price&#148; VALUE=&#147;49.99&#148;&gt
&ltINPUT TYPE=&#147;HIDDEN&#148; NAME=&#147;action&#148; VALUE=&#147;add&#148;&gt
&ltINPUT TYPE=&#147;SUBMIT&#148; VALUE=&#147;Add to Cart&#148;&gt
&lt/FORM&gt</B>
&lt/H2&gt
&lt/TD&gt
&ltTD&gt
&ltH2&gt
<B>&ltFORM ACTION="/servlet/ShoppingCartServlet"&gt
&ltINPUT TYPE="HIDDEN" NAME="action" VALUE="view"&gt
&ltINPUT TYPE="SUBMIT" VALUE="View Cart"&gt
&lt/FORM&gt</B>
&lt/H2&gt
&lt/TD&gt
&lt/TR&gt
&lt/TABLE&gt
&lt/CENTER&gt
&lt/TD&gt
&lt/TR&gt
&lt/TABLE&gt&lt/CENTER&gt
&ampnbsp;
&lt/BODY&gt
&lt/HTML&gt
</PRE>
<P>All of the item pages in this example use the same format as this one, changing only their description of the item and the hidden information passed to the servlet.
</P>
<H3><A NAME="Heading8"></A><FONT COLOR="#000077">Servlets</FONT></H3>
<P>This example relies directly on four servlets. The AdRotatorServlet is used to display ads. The HTMLSearchServlet is used to make the store searchable. The ShoppingCartServlet is used to manage the shopping cart, and the InventoryServlet can be used to check inventory.
</P>
<H4 ALIGN="LEFT"><A NAME="Heading9"></A><FONT COLOR="#000077">AdRotator</FONT></H4>
<P>The AdRotatorServlet used in this example is an improved version of the one from Chapter 11, &#147;A JavaServer Page Online Store.&#148; This version uses a configuration file to define the ad images and the links associated with them. When the servlet is called, it outputs an image link in HTML that displays the image and references the configured link. The example configuration file is:
</P>
<TABLE WIDTH="100%"><TD CAPTION ALIGN="LEFT" COLSPAN="2"><B>Table 25.4</B> AdRotatorServlet Initialization Parameters
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TH ALIGN="LEFT" WIDTH="25%" VALIGN="TOP">PARAMETER
<TH ALIGN="LEFT" VALIGN="TOP">DESCRIPTION
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD ALIGN="LEFT" VALIGN="TOP"><SMALL>Imagedir </SMALL>
<TD ALIGN="LEFT" VALIGN="TOP">The absolute path on the server containing the images and ads.txt file.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD ALIGN="LEFT" VALIGN="TOP"><SMALL>Imageroot</SMALL>
<TD ALIGN="LEFT" VALIGN="TOP">The URL relative to the root directory on the Web server in which the images are contained.
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD ALIGN="LEFT" VALIGN="TOP"><SMALL>logserver </SMALL>
<TD ALIGN="LEFT" VALIGN="TOP">The IP address to which the server logs debug messages.
<TR>
<TD COLSPAN="2"><HR>
</TABLE>
<PRE>
&lt;http://www.pri.com/html/courses/path_javascript.html javascript.gif&gt;
&lt;http://www.pri.com/html/online_courses/ profile.gif&gt;
</PRE>
<P>This file should be named ads.txt and placed in a directory along with the images specified. When the servlet is initialized, it retrieves its ads directory from the configuration parameter and reads the ads.txt file looking for link-image pairs. These pairs are stored in a vector as AdFileEntry objects that associate the link and image. The servlet also keeps track of a current index; each time the service method is called, the servlet displays the current ad and increments the index.
</P>
<P>This servlet requires three initialization parameters, described in Table 25.4.</P><P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="25-05.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="25-07.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>





</BODY>
</HTML>

