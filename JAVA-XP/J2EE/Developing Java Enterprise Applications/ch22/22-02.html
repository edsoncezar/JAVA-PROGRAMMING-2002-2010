<HTML>
<HEAD>


<TITLE>Developing Java Enterprise Applications:Transactions, JTA, and JTS</TITLE>





<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="22-01.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="..\ch23\23-01.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>Distributed transactions are a very complex topic. Many issues arise when trying to ensure that the operations executed inside a transaction are protected sufficiently for all of the resources affected. For example, in the simple case of two databases being linked, the transaction needs to be sure that during a commit, both databases commit successfully or both are rolled back, or the commit will simply fail. The atomic nature of transactions demands that network traffic, server failure, or some other problem doesn&#146;t unlink the two databases in a way that allows changes to one resource inside the distributed transaction to occur without the changes to the other resource. Figure 22.5 displays a simple example of a distributed transaction in which two clients are updating two databases in the same transaction scope.
</P>
<P><A NAME="Fig4"></A><A HREF="images\22-04.jpg"><IMG SRC="images\22-04t.jpg"></A>
<BR><A HREF="images\22-04.jpg"><FONT COLOR="#000077"><B>Figure 22.4</B></FONT></A>&nbsp;&nbsp;Deadlocked transactions.</P>
<P>As a result of the resources and network traffic required to implement distributed transactions, they should be used only when absolutely necessary. In the previous example, with two databases being updated in one transaction, it may be possible to implement the database updates in an EJB that uses standard transactions to ensure that multiple databases are committed as one. In this case, the bean&#146;s container uses a simple form of distributed transactions that can exist inside a single application. As discussed in Chapter 23, &#147;Using Transactions with Enterprise JavaBeans,&#148; the bean doesn&#146;t have to worry about the grouping of transactions because it is managed by the bean&#146;s container. Of course, EJB programmers can get under the covers and manage their transactions manually.
</P>
<P><A NAME="Fig5"></A><A HREF="images\22-05.jpg"><IMG SRC="images\22-05t.jpg"></A>
<BR><A HREF="images\22-05.jpg"><FONT COLOR="#000077"><B>Figure 22.5</B></FONT></A>&nbsp;&nbsp;Distributed transactions.</P>
<H3><A NAME="Heading2"></A><FONT COLOR="#000077">Transactions in Java</FONT></H3>
<P>Chapter 3, &#147;Basic JDBC Programming,&#148; discussed how Java programs take advantage of transactions in a database. Java Message Server implementations can also support transactions. Enterprise bean programmers will have access to transactions using an object called the UserTransaction. This object is part of the javax.transaction package defined by the Java Transaction API (JTA). JTA is a specification of UserTransaction and an object called the XAResource associated with them. (UserTransaction is discussed in more detail in Chapter 23.) JTA is an interface for programmers creating resources that should rely on the distributed transaction architecture defined with XAResources representing transactional contexts.
</P>
<P>In other words, JTA is for programmers writing things like JDBC drivers that need to link their transactions with other resources such as enterprise beans, JMS messages, or other JDBC connections. This XAResource object, along with the rest of JTA, is a Java mapping of the industry&#150;standard X/Open XA interface that defines how transactions are identified and propagated.</P>
<P>Underneath JTA is another lower&#150;level interface called the Java Transaction Service, or JTS. JTS is an interface defined for programmers implementing applications such as transaction monitors that take the JTA interface out of a single program and onto a network. Figure 22.6 diagrams this relationship between the various entities in an application and the interface associated with or accessed by each.</P>
<P>The details of both JTA and JTS are beyond the scope of this book. They are also hidden from Java programmers by the higher&#150;level interfaces such as JMS, JDBC, and EJB. As a result, Java programmers can easily rely on transactions with only a minimal amount of code.</P>
<P>One way that Java programmers leverage transactions is in conjunction with exceptions. When a programmer is going to perform a set of grouped operations, he begins a transaction at the top of the try&#150;catch block. At the bottom of the block, the transaction can be committed because no exception occurred. Inside the catch block, the transaction is rolled back. The pseudocode that follows shows how this interaction is commonly implemented:</P>
<P><A NAME="Fig6"></A><A HREF="images\22-06.jpg"><IMG SRC="images\22-06t.jpg"></A>
<BR><A HREF="images\22-06.jpg"><FONT COLOR="#000077"><B>Figure 22.6</B></FONT></A>&nbsp;&nbsp;Java transaction APIs.</P>
<PRE>
try
 {
    trans.begin();
    . . Do work . .
    trans.commit();
}
catch(Exception exp)
{
    trans.rollback();
}
</PRE>
<P>Regardless of the code used to interact with transactions, the enterprise Java interfaces are beginning to integrate transactions as a core part of their definitions. For example, an enterprise bean will be able to propagate a transaction to several JDBC connections, other beans, and even a JMS session. Future resources may also build on the JTA interface to seamlessly include them in your enterprise applications.
</P>
<H3><A NAME="Heading3"></A><FONT COLOR="#000077">Summary</FONT></H3>
<P>Transactions take reliable programming to the next level. By grouping operations together, transactions can be used to ensure that a group of requests succeeds or fails as a single unit. Although common in databases, transactions are working their way into other operations. The next chapter shows how Enterprise JavaBeans can be associated with transactions and how these transactions can be managed programmatically. For these beans, the resources they access can be protected inside a single transactional context.
</P><P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="22-01.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="..\ch23\23-01.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>





</BODY>
</HTML>

