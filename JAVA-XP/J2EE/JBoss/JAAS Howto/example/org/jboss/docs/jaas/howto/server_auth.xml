<!DOCTYPE policy PUBLIC
      "-//JBoss//DTD JBOSS Security Config 3.0//EN"
      "http://www.jboss.org/j2ee/dtd/security_config.dtd">

<!-- The JBoss server side JAAS login config file for the examples -->

<policy>

    <!-- Used by clients within the application server VM such as
    mbeans and servlets that access EJBs.
    -->
    <application-policy name = "client-login">
       <authentication>
          <login-module code = "org.jboss.security.ClientLoginModule"
             flag = "required">
          </login-module>
       </authentication>
    </application-policy>

   <application-policy name="example1">
      <authentication>
         <!-- A properties file LoginModule that supports CallerPrincipal mapping
         LoginModule options:
         -->
         <login-module code="org.jboss.security.auth.spi.UsersRolesLoginModule"
            flag="required">
            <module-option name="unauthenticatedIdentity">anonymous</module-option>
         </login-module>
      </authentication>
   </application-policy>

   <application-policy name="example2">
      <authentication>
         <!-- A JDBC based LoginModule
         LoginModule options:
         dsJndiName: The name of the DataSource of the database containing the Principals, Roles tables
         principalsQuery: The prepared statement query equivalent to:
            "select Password from Principals where PrincipalID=?"
         rolesQuery: The prepared statement query equivalent to:
            "select Role, RoleGroup from Roles where PrincipalID=?"
         unauthenticatedIdentity: the principal assigned to callers without any authentication info
         -->
         <login-module code="org.jboss.security.auth.spi.DatabaseServerLoginModule"
            flag="required">
            <module-option name="dsJndiName">java:/DefaultDS</module-option>
            <module-option name="principalsQuery">select Password from Principals where PrincipalID=?</module-option>
            <module-option name="rolesQuery">select Role, RoleGroup from Roles where PrincipalID=?</module-option>
         </login-module>
      </authentication>
   </application-policy>

    <!-- The security domain for the HSQLDB -->
    <application-policy name = "HsqlDbRealm">
       <authentication>
          <login-module code = "org.jboss.resource.security.ConfiguredIdentityLoginModule"
             flag = "required">
             <module-option name = "principal">sa</module-option>
             <module-option name = "userName">sa</module-option>
             <module-option name = "password"></module-option>
             <module-option name = "managedConnectionFactoryName">jboss.jca:service=LocalTxCM,name=DefaultDS</module-option>
          </login-module>
       </authentication>
    </application-policy>
</policy>

