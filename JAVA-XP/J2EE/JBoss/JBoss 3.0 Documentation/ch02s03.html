<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Configuration files</title><link rel="stylesheet" href="styles.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets Vimages/callouts/"><link rel="home" href="index.html" title="JBoss 3.0 Documentation"><link rel="up" href="ch02.html" title="Chapter 2. Configuration"><link rel="previous" href="ch02s02.html" title="Directory structure"><link rel="next" href="ch03.html" title="Chapter 3. Using Databases and other Enterprise Resources"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table border="0" cellpadding="0" cellspacing="0" height="65"><tr height="65"><td rowspan="2"><img src="images\jboss.gif" border="0"></td><td rowspan="2" background="images\gbar.gif" width="100%" align="right" valign="top"><a href="index.html"><img src="images\doc.gif" border="0"></a><a href="ch02.html"><img src="images\toc.gif" border="0"></a><a href="ch02s02.html"><img src="images\prev.gif" border="0"></a><a href="ch03.html"><img src="images\next.gif" border="0"></a></td></tr><tr></tr></table><div class="section"><a name="configuration-files"></a><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="configuration-files"></a>Configuration files</h2></div></div><p>
	    The default JBoss configuration set is located in the
	    <tt>conf/default</tt> directory.
	</p><p>
	    JBoss allows the administrator to maintain more than one
	    configuration set. All one has to do is to copy all the files from
	    the default configuration into a new subdirectory of
	    <tt>conf</tt>.
	</p><p>
	    For example, you can create a new configuration
	    <span class="emphasis"><i>"myjboss"</i></span> by creating under the
	    <tt>conf</tt> directory a subdirectory called
	    <tt>myjboss</tt> and copying all the files from
	    subdirectory <tt>conf/default</tt> into
	    <tt>conf/myjboss</tt>. After possibly altering certain
	    settings in the newly created files, you can run JBoss with the new
	    configuration by invoking the platform-dependent scripts and just
	    passing the configuration name as a parameter, like this:
	</p><p><b>run.bat myjboss</b></p><p>
	    There are several configuration files for JBoss. A description of
	    each is given below:
	</p><div class="itemizedlist"><ul><li><p><a name="d0e715"></a><tt>jboss.properties</tt></p><p>
		    This is a file in the standard Java Properties format that
		    is loaded into the System properties on startup of the JBoss
		    server. System properties that are not required to be
		    available prior to the invocation of the JBoss server main
		    method can be specified here.
		</p></li><li><p><a name="d0e721"></a><a name="jboss.conf-file"></a>
		    <tt>jboss.conf</tt>
		</p><p>
		    The configuration file <tt>jboss.conf</tt>
		    contains typically only those core service MBeans that are
		    necessary to achieve the initial bootstrap of JBoss, like
		    the class path extension inclusion mechanism shown in
		    <a href="ch02s03.html#jboss.conf-excerpt" title="Figure 2.2. Excerpt from jboss.conf">Figure 2.2</a>, logging,
		    configuration service, service control, etc.
		</p><div class="figure"><p><a name="jboss.conf-excerpt"></a><b>Figure 2.2. Excerpt from <tt>jboss.conf</tt></b></p><pre class="programlisting">
			
&lt;MLET CODE="org.jboss.util.ClassPathExtension" ARCHIVE="jboss.jar" CODEBASE="../../lib/ext/"&gt;
 &lt;ARG TYPE="java.lang.String" VALUE="../../log/"&gt;
&lt;/MLET&gt;
			
		    </pre></div><p>
		    This file is loaded by an instance of the
		    <tt>javax.management.loading.MLet</tt> class and
		    it is written following the standard MLet syntax for JMX
		    MBeans (refer to the

		    <a href="http://java.sun.com/products/JavaManagement" target="_top">
			JMX specification
		    </a>

		    for more details). Any standard JMX MBean can be placed in
		    the <tt>jboss.conf</tt> file as long as it does
		    not depend on JBoss service MBeans like naming. MBeans that
		    depend on JBoss service MBeans need to be configured in the
		    <tt>jboss.jcml</tt> file so that startup
		    dependencies can be managed.
		</p><p>Usually, you would never have to change this file.</p></li><li><p><a name="d0e757"></a><a name="jboss.jcml-file"></a>
		    <tt>jboss.jcml</tt>
		</p><p>
		    This file lists all the JMX service MBeans that need to be
		    included in the running instance of JBoss. Notice that,
		    contrary to the MLet syntax, this file contains well-formed
		    XML.
		</p><p>
		    The need for deviation from MLet syntax is justified by the
		    fact that MLet doesn't allow named parameters, only
		    TYPE-VALUE pairs. Having only TYPE-VALUE pairs easily leads
		    to problems due to MBean parameter mismatches.
		</p><p>
		    The syntax of <tt>jboss.jcml</tt> allows the use
		    of named parameters in MBean instantiation directives and it
		    is a lot easier to use. For example,
		    <a href="ch02s03.html#jboss.jcml-example-entry" title="Figure 2.3. &#xA;			    Excerpt from jboss.jcml&#xA;			">Figure 2.3</a> shows an MBean
		    element used to create and include MailService in JBoss.
		</p><p>

		    <div class="figure"><p><a name="jboss.jcml-example-entry"></a><b>Figure 2.3. 
			    Excerpt from <tt>jboss.jcml</tt>
			</b></p><pre class="programlisting">
			    
&lt;mbean code="org.jboss.mail.MailService" name="DefaultDomain:service=Mail"&gt;
&lt;attribute name="JNDIName"&gt;Mail&lt;/attribute&gt;
&lt;attribute name="ConfigurationFile"&gt;mail.properties&lt;/attribute&gt;
&lt;attribute name="User"&gt;user_id&lt;/attribute&gt;
&lt;attribute name="Password"&gt;password&lt;/attribute&gt;
&lt;/mbean&gt;
			    
			</pre></div>

                </p><p>

		    In a nutshell:

		    <div class="itemizedlist"><ul><li><p><a name="d0e788"></a>
				The <tt>code</tt> attribute of the
				MBean element specifies which class to load and
				instantiate.
			    </p></li><li><p><a name="d0e794"></a>
				The <tt>name</tt> attribute of the
				MBean element specifies the unique name of the
				MBean under the specified JMX domain.
			    </p></li><li><p><a name="d0e800"></a>
				The attribute child elements of the MBean
				element specify the corresponding attributes of
				the instantiated MBean. The values of the
				attributes can be any Java primitives or String
				objects.
			    </p></li></ul></div>

                </p><p>

		    The <tt>jboss.jcml</tt> file is loaded by the

		    <tt>
			org.jboss.configuration.ConfigurationService
		    </tt>

		    MBean. This service acts much like the standard JMX MLet
		    class in that it loads and configures MBeans. The
		    dependencies among MBeans are managed by the
		    <tt>org.jboss.util.ServiceControl</tt> MBean. The
		    ServiceControl MBean listens for
		    <tt>REGISTRATION_NOTIFICATION</tt> and
		    <tt>UNREGISTRATION_NOTIFICATION</tt> JMX events to
		    determine which MBeans are available. The order of
		    registration determines the order of initialization and
		    startup. The ServiceControl expects MBeans requiring
		    dependency management to conform to the
		    <tt>org.jboss.util.Service</tt> interface. This
		    interface allows for the orderly initialization, startup,
		    stop and destroying of MBeans. The sequence is based on the
		    order in which MBeans are specified in the
		    <tt>jboss.jcml</tt> file. See
		    <a href="ch13s26.html" title="How to Integrate Custom Services via MBeans">the section called &#8220;How to Integrate Custom Services via MBeans&#8221;</a> for the details on how to
		    create an MBean that has dependencies on other MBeans.

		</p></li><li><p><a name="d0e829"></a><a name="jboss.dependencies-file"></a>
		    <tt>jboss.dependencies</tt>
		</p><p>
		    For reasons of simplicity and ease of configuration, the
		    DependencyManager of JBoss was deprecated in the 2.1
		    release, so this file is no longer used.
		</p><p>
		    Now all the MBeans listed in <tt>jboss.jcml</tt>
		    have <span class="emphasis"><i>vertical</i></span> dependency on each other.
		    For example, a JNDI provider is required for DataSource
		    wrappers because a DataSource wrapper needs to store a
		    reference to itself in JNDI; therefore, a JNDI provider
		    MBean has to be listed before the DataSource wrapper. See
		    <a href="ch13s26.html" title="How to Integrate Custom Services via MBeans">the section called &#8220;How to Integrate Custom Services via MBeans&#8221;</a> for the details of the
		    dependency mechanism.
		</p></li><li><p><a name="d0e847"></a><a name="jboss-auto-file"></a>
		    <tt>jboss-auto.jcml</tt>
		</p><p>
		    JBoss has the very powerful feature of being able to record
		    a runtime snapshot of all of its running MBeans, including
		    their attributes, and later reproduce that snapshot in
		    another JBoss instance.
		</p><p>
		    When such a snapshot is taken, it is recorded in XML format
		    in the <tt>jboss-auto.jcml</tt> file.
		</p><p>Consider the following scenario:</p><p>
		    The administrator takes a running JBoss instance, adds a few
		    MBeans, modifies attributes of other MBeans, saves the
		    configuration and finally gracefully shuts down JBoss.
		</p><p>
		    The next time that JBoss is started, all the dynamically
		    added Mbeans from the previous run are recreated and their
		    attributes set. JBoss also resets any other modified
		    attributes, regardless whether an MBean was added
		    dynamically (at runtime) or statically (through
		    <tt>jboss.jcml</tt>).
		</p><p>
		    You also have the option not taking runtime snapshots; to
		    do so, simply delete the
		    <tt>jboss-auto.jcml</tt> file before starting
		    JBoss, in which case JBoss will not record any of the
		    MBeans changes at runtime.
		</p><p>

		    <span class="emphasis"><i>
			Dependency between <tt>jboss.jcml</tt> and
			<tt>jboss-auto.jcml</tt>
		    </i></span>

		</p><p>

		    If while using the runtime snapshot feature there is a need
		    to remove an MBean listed in
		    <tt>jboss.jcml</tt>, you also have to remove it
		    from <tt>jboss-auto.jcml</tt>, if it appears
		    there, to achieve the desired effect. Do not remove the
		    entire <tt>jboss-auto.jcml</tt> file unless you
		    want to stop taking runtime snapshots; to remove
		    <span class="emphasis"><i>all</i></span> the MBeans, create a functionally
		    empty <tt>jboss-auto.jcml</tt> file, like this:

		    <pre class="programlisting">
			
&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;server&gt;
&lt;/server&gt;
			
		    </pre>

		</p></li><li><p><a name="d0e905"></a><a name="mail.properties-file"></a>
		    <tt>mail.properties</tt>
		</p><p>
		    Following the EJB specification, JBoss provides access to a
		    mail resource through the standard JavaMail APIs. This file
		    specifies properties of the mail provider, such as where to
		    find the SMTP and POP servers, as well as other mail-related
		    configuration settings.
		</p><p>
		    Note that you are allowed to specify multiple sets of
		    configurations by creating multiple
		    <tt>mail.properties</tt> files. All you have to
		    do is to specify additional MailService MBeans with
		    different <tt>ConfigurationFile</tt> attributes in
		    the <tt>jboss.jcml</tt> file. See
		    <a href="ch13s98.html" title="Using JavaMail in JBoss">the section called &#8220;Using JavaMail in JBoss&#8221;</a> for additional details.
		</p></li><li><p><a name="d0e926"></a><a name="jndi.properties-file"></a>
		    <tt>jnp.properties</tt> and
		    <tt>jndi.properties</tt>
		</p><p>
		    These two files are JNDI related. The first one contains
		    properties of JNP, the JNDI provider implementation in
		    JBoss, while the second specifies properties for JNDI
		    clients.
		</p><p>
		    JNDI clients can read properties listed in a
		    <tt>jndi.properties</tt> file as long as it
		    appears somewhere in their class path. This improves the
		    portability of the client program because it is not written
		    to operate in a particular configuration. Note that you have
		    to change the
		    <tt>java.naming.provider.url=localhost</tt>
		    property-value pair if you are using clients that reside on
		    a machine other than the JBoss server host itself.
		</p></li><li><p><a name="d0e945"></a><a name="standardjaws.xml-file"></a>
		    <tt>standardjaws.xml</tt>
		</p><p>
		    Represents a default configuration file for the JBoss CMP
		    engine. It contains the JNDI name of a default DataSource,
		    per database JDBC Object-SQL mappings, default CMP entity
		    beans settings, etc. See <a href="ch06.html" title="Chapter 6. Customizing JAWS">Chapter 6</a> for
		    additional details.
		</p></li><li><p><a name="d0e955"></a><tt>auth.conf</tt></p><p>
		    This file is a JAAS login module configuration file,
		    supported by the default
		    <tt>javax.security.auth.login.Configuration</tt>
		    implementation. It contains sample server side
		    authentication configurations that are applicable when using
		    JAAS based security. See <a href="ch09.html" title="Chapter 9. JBossSX Security Extension Framework">Chapter 9</a> for
		    additional details on the JBoss security
		    framework.
		</p></li><li><p><a name="d0e966"></a><tt>server.policy</tt></p><p>
		    The default Java2 security policy for the JBoss server.
		    Currently, this is set to an all-open configuration, but
		    it is unused because the JBoss server does not run with a
		    security manager by default. See
		    <a href="ch09.html" title="Chapter 9. JBossSX Security Extension Framework">Chapter 9</a> for a description of the JBoss
		    security framework.
		</p></li><li><p><a name="d0e974"></a><tt>standardjboss.xml</tt></p><p>
		    This file provides the default container configuration. The
		    use of this file is an advanced topic covered by
		    <a href="ch07.html" title="Chapter 7. Advanced container configuration : use of jboss.xml">Chapter 7</a>.
                </p></li></ul></div></div><table border="0" cellpadding="0" cellspacing="0" height="65"><tr height="65"><td rowspan="2"><img src="images\gbar.gif" width="432" height="79"></td><td rowspan="2" background="images\gbar.gif" width="100%" align="right" valign="top"><a href="index.html"><img src="images\doc.gif" border="0"></a><a href="ch02.html"><img src="images\toc.gif" border="0"></a><a href="ch02s02.html"><img src="images\prev.gif" border="0"></a><a href="ch03.html"><img src="images\next.gif" border="0"></a></td></tr><tr></tr></table></body></html>