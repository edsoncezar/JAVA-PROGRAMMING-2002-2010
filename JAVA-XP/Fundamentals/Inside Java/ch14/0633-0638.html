<HTML>
<HEAD>


<TITLE>Inside Java:The New, Improved AWT: Menus, Events, and More New Features:EarthWeb Inc.-</TITLE>






<P><CENTER>
<a href="0627-0632.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0639-0644.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-633"><P>Page 633</P></A>



<P>
<a href="images\ch14fg09.jpg"><img src="images\tn_ch14fg09.jpg"></a><BR>
Figure 14.9 <I>HelloPrint application display.</I>
</P>


<P>method, so the component's paint() method will be called with the graphics context as
the argument. This causes the component to be rendered to the printer page.
</P>

<P><B>An Example of Printing a Component: The <BR>HelloPrint2 Application</B>
</P>

<P>Listing 14.4 (program HelloPrint2.java on the accompanying CD-ROM) is an <BR>
example of how you can print a GUI component. Printing a GUI component is similar
to HelloPrint, except that a component extended from Canvas displays &quot;Hello
World!&quot; within the application's frame. When the Hello button is clicked, the same
paint() method that draws the component on the screen sends the component to a printer.
</P>

<P>Listing 14.4
</P>
<PRE>
Line==================Java Source=================
001   //////////
002   // HelloPrint2.java  Demonstrates how to print a
003   // component from a Java application.
004   //
005   // Author: James L. Weaver  JDK 1.1 beta1
006   //////////
007   package chapter14.code.helloprint2;
008
009   import java.awt.*;
010   import java.awt.event.*;
011
012   public class HelloPrint2 extends Frame
013                       implements ActionListener {
014
015       Button printBtn;
016       HelloCanvas hc;
</PRE>
<PRE>
                                                           <I>continues</I>
</PRE>
<A NAME="PAGENUM-634"><P>Page 634</P></A>




<P>Listing 14.4, Continued
</P>
<PRE>
017
018       public HelloPrint2() {
019           super(&quot;Hello World&quot;);
020
021           addWindowListener(new Wadapt());
022           setSize(300, 200);
023           setLayout(new BorderLayout());
024
025           Panel p = new Panel();
026           add(&quot;North&quot;, p);
027
028           printBtn = new Button(&quot;Hello&quot;);
029           printBtn.addActionListener(this);
030           p.add(printBtn);
031
032           hc = new HelloCanvas();
033           add(&quot;Center&quot;, hc);
034
035           setVisible(true);
036           printBtn.requestFocus();
037       }
038
039       private void printHello() {
040           Graphics pg;
041
042           // Display a print dialog box, and get a reference
043           // to a PrintJob object.
044           PrintJob pj = getToolkit().getPrintJob(this, &quot;HelloPrint2&quot;,
&Acirc;null);
045
046           if (pj != null) {
047               // Ask the PrintJob instance for a graphics context in
048               // which to draw.
049               pg = pj.getGraphics();
050               if (pg != null) {
051
052                   hc.print(pg);
</PRE>

<A NAME="PAGENUM-635"><P>Page 635</P></A>



<PRE>
053
054                   // Flush the page to the printer
055                   pg.dispose();
056               }
057               // End the print job and do housekeeping
058               pj.end();
059           }
060       }
061
062       public void actionPerformed(ActionEvent evt) {
063           printHello();
064       }
065
066       public static void main(String args[]) {
067           HelloPrint2 printFrame = new HelloPrint2();
068           return;
069       }
070   }
071
072   class HelloCanvas extends Canvas {
073       protected String hello;
074
075       public HelloCanvas() {
076           hello = new String(&quot;Hello World!&quot;);
077       }
078
079       public void paint(Graphics pg) {
080           int w, h;
081           if (pg instanceof PrintGraphics) {
082               w = ((PrintGraphics)pg).getPrintJob()
&Acirc;.getPageDimension().width;
083               h = ((PrintGraphics)pg).getPrintJob()
&Acirc;.getPageDimension().height;
084           }
085           else {
086               w = this.getSize().width;
087               h = this.getSize().height;
088           }
089           pg.setFont(new Font(&quot;Helvetica&quot;, Font.BOLD, 48));
</PRE>
<PRE>
                                                                <I>continues</I>
</PRE>


<A NAME="PAGENUM-636"><P>Page 636</P></A>

<P>Listing 14.4, Continued
</P>
<PRE>
090
091           int sw = pg.getFontMetrics().stringWidth(hello);
092           int sh = pg.getFontMetrics().getHeight();
093           pg.drawString(hello, (w _ sw) / 2, (h + sh) / 2);
094       }
095   }
096
097   class Wadapt extends WindowAdapter
098   {
099       public void windowClosing(WindowEvent evt) {
100           Frame frm = (Frame)evt.getSource();
101           frm.setVisible(false);
102           frm.dispose();
103           System.exit(0);
104       }
105   }
</PRE>

<P>In the HelloPrint2 constructor (lines 18_37), the HelloCanvas component is placed in
the &quot;Center&quot; area of a BorderLayout, and the Hello button is placed in the &quot;North.&quot;
</P>

<P>The printHello() method in lines 39_60 gets the PrintJob and Graphics instances like in
the original HelloPrint application. Line 52, however, is different. It calls the
print() method of the HelloCanvas object, which calls the
paint() method of the same object. Because the Graphics object passed is a printer page, the component will be drawn on that page.
</P>

<P>Lines 79_94 contain the paint() method of the component being displayed and
printed. Line 81 determines whether this component should be drawn to the printer or the
screen. It does this by checking whether the Graphics instance passed into the
paint() method implements the PrintGraphics interface. This is the case if
paint() was called from line 52, because the
getGraphics() method in line 49 returns a Graphics object that implements
the PrintGraphics interface.
</P>

<P>Lines 82 and 83 get the width and height (in pixels) of the printer page by using
the getPrintJob() method of the PrintGraphics object to get the PrintJob object, and then
calling the appropriate methods of the PrintJob object.
</P>
<P>Lines 86 and 87 get the width and height of the HelloCanvas component.
</P>

<P>Lines 89_93 do the same calculations and drawing as the original HelloPrint. The
&quot;Hello World!&quot; string is centered both horizontally and vertically regardless of whether it
is being displayed on the screen or printer.
</P>

<A NAME="PAGENUM-637"><P>Page 637</P></A>






<P>Line 55 causes the page to be printed and line 58 ends the print job, just like the
printHello() method of the original HelloPrint application.
</P>

<P>An entire containment hierarchy of components can be printed by calling the
printAll() method of the top-level component, passing the graphics context of the printer page.
</P>

<P>Figure 14.10 shows the HelloPrint2 application's display.
</P>

<P>This section explained how to output information and GUI components to a
printer, primarily by using the PrintJob class. For more information on this class, refer to
the following Web page:
</P>
<PRE>

http://java.sun.com/products/JDK/1.1/docs/api/java.awt.PrintJob.html
</PRE>

<P>
<a href="images\ch14fg10.jpg"><img src="images\tn_ch14fg10.jpg"></a><BR>
Figure 14.10 <I>HelloPrint2 application display.</I>
</P>






<P>The next section discusses how to use another new feature of the JDK 1.1&#151;the
clipboard.
</P>






<H4><A NAME="ch14_ 21">
Using the Clipboard from a Java Program
</A></H4>

<P>Users have come to expect the capability to cut, copy, and paste information within
and across applications. Because Java uses the GUI components of the host
windowing system, cut, copy, and paste are already available to a limited degree. New to JDK
1.1, however, is the capability to manipulate the clipboard from within your program.
</P>
<P><B>Overview of Clipboard Programming</B>
</P>

<P>The new Java classes, interfaces, and exceptions involved in the clipboard scenario are:
</P>

<UL>
<LI>          Clipboard class: Class representing a clipboard, which is either the native
system clipboard or one created by your program.
</UL>

<A NAME="PAGENUM-638"><P>Page 638</P></A>



<UL>
<LI>          StringSelection class: Convenience class representing String data to be placed
on the clipboard. Other convenience classes are created to handle transferring
other data types.
<LI>          DataFlavor class: Class representing a format in which data is transferred. Data,
for example, represented by the StringSelection class is transferred as a String or
as characters in an InputStream.
<LI>          Transferable interface: Objects placed on the clipboard or retrieved from
the clipboard must implement the Transferable interface.
<LI>          ClipboardOwner interface: Contains one method that is called when
the ClipboardOwner object no longer owns the data on the clipboard.
<LI>          UnsupportedFlavorException exception: Implemented when a Transferable
object doesn't support the transfer of its data in the requested format, or &quot;data flavor.&quot;
</UL>

<P>These Java classes, interfaces, and exceptions are located in the
new java.awt.datatransfer package. Figure 14.11 shows a common scenario for
manipulating the clipboard. Figure 14.12 depicts the ClipboardDemo application described in
the following section.
</P>

<P><B>The ClipboardDemo Application</B>
</P>

<P>Listing 14.5 (program ClipboardDemo.java on the accompanying CD-ROM) is an
example of how you can manipulate the clipboard programmatically. Traditional cut, copy,
and paste functionality is available in the two text fields by using the menu items in the
Edit menu. Figure 14.12 shows the ClipboardDemo application's display.
</P>

<P>
<a href="images\ch14fg11.jpg"><img src="images\tn_ch14fg11.jpg"></a><BR>
Figure 14.11 Common clipboard scenario.<BR>
</P>


<P><CENTER>
<a href="0627-0632.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0639-0644.html">Next</A>
</CENTER></P>







</BODY>
</HTML>

