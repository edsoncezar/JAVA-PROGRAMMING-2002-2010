<HTML>
<HEAD>


<TITLE>Inside Java:JDBC:EarthWeb Inc.-</TITLE>






<P><CENTER>
<a href="0777-0780.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0784-0786.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-781"><P>Page 781</P></A>



<H4><A NAME="ch17_ 13">
The java.sql.Driver Interface
</A></H4>

<P>As with all Java interfaces and classes, the Driver interface extends the Object
class. Each driver should provide a class that implements the Driver interface. When a
Driver class is loaded, it should create an instance of itself and register with the Driver
Manager. The following section discusses some commonly used methods of the
Driver interface.
</P>

<P><B>The acceptsURL() Method
</P></B>

<P>This method returns true if the driver is capable of opening a connection to an
URL (passed as a parameter). The method accepts the URL of the connecting database.
</P>

<P><B>The connect() Method
</P></B>

<P>This method attempts to make a database connection to a URL object (passed as
a parameter). An additional parameter, a Properties object, can be used to pass a list
of name-value pairs as connection arguments. Usually, the username and password
are passed in the Properties parameter.
</P>

<P>The driver returns null if it realizes that it cannot connect to the given URL. If <BR>
the connection is successful, the driver returns a Connection object that represents <BR>
a connection to the URL. Finally, the driver raises a SQLException if it has <BR>
trouble connecting to the database.
</P>

<P><B>The getPropertyInfo() Method
</P></B>

<P>With this method, a user interface tool can obtain a list of properties that are
needed from the user to connect to a database. Depending on what the user has supplied so
far, more than one call to this method might be necessary.
</P>

<P>This method accepts the URL of the connecting database, as well as a Properties
object as a parameter that indicates the proposed information to be sent while opening
a connection.
</P>

<P>The method returns an array (possibly an empty one) of DriverPropertyInfo objects
that describes the potential properties to be supplied by the user. The method also can
throw a SQLException if it has trouble connecting to the database.
</P>

<P><B>The jdbcCompliant() Method
</P></B>

<P>This method ascertains whether the driver is a JDBC COMPLIANT(TM) driver. A
driver returns a true value only if it passes the JDBC Compliance tests. To be
JDBC COMPLIANT(TM), a driver must provide full support for the JDBC API and SQL
92 Entry Level.
</P>

<A NAME="PAGENUM-782"><P>Page 782</P></A>



<H4><A NAME="ch17_ 14">
The java.sql.Connection Interface
</A></H4>

<P>The public interface Connection extends the Object class. A Connection represents
a data access and manipulation session with a particular database. Within this
session, SQL statements can be executed, returning result sets. The following sections
describe some widely used methods.
</P>

<P><B>The close() Method
</P></B>

<P>Certain situations may warrant an immediate release of the Connection's
database resource and JDBC resources instead of waiting for them to be automatically
released. The close() method provides these functions. Errors occurring during the execution of
this method throw a SQLException.
</P>

<P><B>The commit() Method
</P></B>

<P>By default, changes are automatically committed after each statement is executed. In
case the auto-commit feature has been disabled, explicitly call
commit() to save the changes to the database to ensure that they won't be lost. This method also releases any
database locks currently held by the Connection; it throws a SQLException in case of an error.
</P>

<P><B>The rollback() Method
</P></B>

<P>This method discards all the changes made since the last
commit() or rollback() call. It also releases any database locks held by the Connection.
</P>

<P><B>The createStatement() Method
</P></B>

<P>This method returns a new Statement object that can be used to execute SQL
statements without parameters. This method throws a SQLException in case of an error.
</P>

<P><B>The prepareStatement() Method
</P></B>

<P>This method returns a new PreparedStatement object containing the
precompiled statement passed as a parameter. This object can be used to repeatedly execute
the precompiled statement. This method accepts a SQL statement. This method throws <BR>
a SQLException in case of an error.
</P>

<P><B>The prepareCall() Method
</P></B>

<P>This method returns a new CallableStatement object containing the precompiled
SQL statement, the prepareCall() method accepts as a parameter a String object containing a
SQL statement. This method throws a SQLException in case of an error.
</P>

<P><B>The setAutoCommit() Method
</P></B>


<A NAME="PAGENUM-783"><P>Page 783</P></A>


<P>This method, accepts a Boolean parameter and enables an application to specify
whether its SQL statements should be automatically committed or grouped into transactions
that are terminated by a commit()or rollback() call. The auto-commit mode is the default for
new connections.
</P>

<H4><A NAME="ch17_ 15">
The java.sql.Statement Interface
</A></H4>

<P>The Statement interface extends the Object class. Classes that implement the
Statement interface execute SQL statements that are static by nature and obtain results
following their execution. Results are in the form of ResultSet objects; however, there can be
only one ResultSet object open for each Statement object at any time. This means that
if multiple ResultSets are required by the application, each must be generated by a
corresponding Statement object.
</P>

<P>The following sections discuss the most widely used methods of this interface.
</P>

<P><B>The close() Method
</P></B>

<P>This method can be used when it is necessary to release a Statement's database
resource and other JDBC resources immediately, instead of waiting for the Statement to
be automatically closed. The close() method throws a SQL Exception if an error occurs.
</P>

<P><B>The execute() Method
</P></B>

<P>This method executes a SQL statement&#151;passed
to it as a parameter&#151;that can return multiple results. The return value, either a Boolean true or false, indicates the form of
the first result. If the return value is true, the next result is a ResultSet. A return value of
false indicates either that no more results exist or that the next result is an update count.
You then can use the getResultSet(),
getMoreResults(), or getUpdateCount() methods to retrieve
any subsequent results. A SQL Exception is thrown in case of an error.
</P>

<P><B>The executeQuery() Method
</P></B>

<P>This method executes a SQL statement (passed as a parameter) that returns a
single ResultSet object. A SQL Exception is thrown in case of an error.
</P>

<P><B>The executeUpdate() Method
</P></B>

<P>This method executes SQL UPDATE, DELETE, or INSERT statements. A SQL
statement is passed as a parameter, and a row count is returned for these statements.
Such SQL statements as SQL DDL statements,
which do not return anything, also can be
executed. These statements return a value of 0. In case of an error, a SQL Exception is thrown.
</P>








<P><CENTER>
<a href="0777-0780.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0784-0786.html">Next</A>
</CENTER></P>







</BODY>
</HTML>

