<HTML>
<HEAD>


<TITLE>Inside Java:JDBC:EarthWeb Inc.-</TITLE>






<P><CENTER>
<a href="0781-0783.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0787-0789.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-784"><P>Page 784</P></A>



<P><B>The getResultSet() Method
</P></B>

<P>This method returns the result of the current statement, in the form of a ResultSet
object. This method should be called only once for each result. A SQL Exception is thrown
in case of an error.
</P>

<P><B>The getMoreResults() Method
</P></B>

<P>This method moves to the next result of a Statement object. A value of true is returned
if the next result of the Statement is a ResultSet. If the next result is an update count, or
if no more results exist, a value of false is returned.
</P>

<H4><A NAME="ch17_ 16">
The java.sql.PreparedStatement Interface
</A></H4>

<P>The interface PreparedStatement extends the Statement interface. Because SQL
statements require compilation by the DBMS, it is a good idea to precompile, and store in
a PreparedStatement object any statements that are going to be used more than once.
The object can be used many times to execute the statement efficiently. The
following sections describe some of the most widely used methods of this interface.
</P>

<P><B>The clearParameters() Method
</P></B>

<P>In general, parameter values persist during repeated executions of the SQL stored in
a Statement object. Setting a parameter's value clears its previous value automatically.
To immediately release the resources used by current parameter values, however, use
the clearParameters() method. This method throws a SQL Exception in case of an error.
</P>

<P><B>The setXXX() Methods
</P></B>

<P>The setXXX() methods that are used for setting the IN parameter values must
specify types compatible with the defined SQL type of the input parameter. The
setInt() method, for example, should be used if the SQL type of the IN parameter is Integer.
XXX stands for the various data types that are supported.
</P>

<H4><A NAME="ch17_ 17">
The java.sql.CallableStatement Interface
</A></H4>

<P>The public interface CallableStatement extends the PreparedStatement interface.
This interface provides the functions that execute SQL-stored procedures.
</P>

<P>A CallableStatement can return one or multiple ResultSets. JDBC provides a SQL
escape for stored procedures; this enables a uniform call to all relational DBMSs. The
escape syntax contains two forms, one of which includes a result parameter. The result
parameter must be registered as an OUT parameter when it is used. The other parameters
can be used for input, output, or both.
</P>



<A NAME="PAGENUM-785"><P>Page 785</P></A>


<P>Parameters are referred to by number in a sequential manner, beginning with 1.
</P>

<P>The set methods inherited from PreparedStatement are used to set the IN
parameter values. All OUT parameter types must be registered before the execution of the
stored procedure. The following sections describe the most commonly used methods of
the CallableStatement interface.
</P>

<P><B>The getXXX() Methods
</P></B>

<P>The getXXX() methods are used to obtain the values of the OUT parameters after
execution of the stored procedure.
</P>

<P><B>The registerOutParameter() Method
</P></B>

<P>This method must be called before executing a stored procedure call to register
the java.sql.Type of each OUT parameter. The parameterIndex parameter indicates
the number of the parameter. A value of 1, for example, indicates the first parameter is
being referenced, while a value of 2 indicates the second parameter. The sqlType parameter is
a SQL-type code defined by java.sql.Types. This method throws a SQL Exception in
case of an error.
</P>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
NOTE
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
When reading the value of an OUT parameter, you must use the
getXXX() method whose Java type XXX corresponds to the parameter's registered SQL type.
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>
<P><B>The registerOutParameter() Method
</P></B>

<P>This version of the registerOutParameter method is used for registering Numeric
or Decimal OUT parameters. The first two parameters are the same as in the
previous version of the method. A third parameter (an int) represents the number of digits to
the right of the decimal point. Its value should be greater than or equal to zero. This
method throws a SQL Exception in case of an error.
</P>

<P><B>The wasNull() Method
</P></B>

<P>An OUT parameter can have the value of SQL NULL. The
wasNull() method returns true if the last value read was SQL NULL. This method throws a SQL Exception in case of
an error.
</P>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
NOTE
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
You must first call getXXX() on a parameter to read its value and then call
wasNull() to determine if the value was SQL NULL.
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>
<A NAME="PAGENUM-786"><P>Page 786</P></A>



<H4><A NAME="ch17_ 18">
The java.sql.ResultSet Interface
</A></H4>

<P>The public interface ResultSet extends the Object class. The table of data that is
generated by the execution of a Statement can be accessed through a ResultSet object.
</P>

<P>The ResultSet object maintains a cursor that points to its current row of data.
Initially, the cursor points to a location before the first row. Then, the table rows can be
retrieved in sequence by using the &quot;next&quot; method.
</P>

<P>The getXXX() methods retrieve the values in the columns of a particular row. Within a
row, the values of the columns, which are numbered sequentially beginning from 1, can
be randomly accessed&#151;either by column index numbers, or column names. The JDBC
driver attempts to convert the data to the specified Java type; the driver then returns a
suitable Java value for the getXXX() methods.
</P>

<P>When a Statement object is re-executed or used to retrieve the next result from a
sequence of results, the current ResultSet is automatically closed. This also happens
when the Statement that generated the ResultSet is closed.
</P>

<P>The following sections describe the ResultSet interface's most widely used methods.
</P>

<P><B>The getMetaData() Method
</P></B>

<P>The ResultSetMetaData object, returned by the
getMetaData() method, provides the number, types, and properties of a ResultSet's columns. The
getMetaData() method throws a SQL Exception in case an error occurs.
</P>

<P><B>The close() Method
</P></B>

<P>This method is used when the application wants to release a ResultSet's
database resource and JDBC resources immediately instead of waiting for the ResultSet to
close by itself. This method throws a SQL Exception to indicate an error condition.
</P>

<P><B>The next() Method
</P></B>

<P>A ResultSet is initially positioned before its first row. To access the rows of
the ResultSet, successive calls must be made to the
next() method. The first call to next(), for example, makes the first row of the ResultSet the current row. This method throws a
SQL Exception in case of an error.
</P>

<P>The next() method returns true if the new, current row is a valid row. The method
returns false if no more rows exist. This functionality is achieved by using a cursor.
</P>

<P><B>Working with a Cursor
</P></B>

<P><CENTER>
<a href="0781-0783.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0787-0789.html">Next</A>
</CENTER></P>







</BODY>
</HTML>

