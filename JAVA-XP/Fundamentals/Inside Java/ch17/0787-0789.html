<HTML>
<HEAD>


<TITLE>Inside Java:JDBC:EarthWeb Inc.-</TITLE>






<P><CENTER>
<a href="0784-0786.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0790-0793.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-787"><P>Page 787</P></A>



<P>The idea of a cursor should be familiar to most programmers who have worked with
a database. A cursor can be thought of as a pointer or iterator pointing to or indexing
into a set of tuples. A tuple is a record in a database table that has values for the fields in
the table. In the JDBC API, a cursor is an iterator indexing into a ResultSet.
</P>

<P>Cursors are very useful when dealing with multitupled ResultSets because cursors
can extract information from each row in the ResultSet. When a ResultSet is first created,
the cursor points to the first row of data, which is referred to as the current row. The
next() method of the ResultSet interface then iterates through the ResultSet and advances
the position of the cursor to the next row of data.
</P>

<P>The current version of JDBC provides only rudimentary support for cursors. To
obtain the name of the cursor, use the
ResultSet.getCursorName() method, which returns the name
as a String object. The row of a ResultSet object currently identified by a cursor can
be updated or deleted by a positioned update or delete that uses the name of the cursor.
</P>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
TIP
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
Not all commercially available DBMSs support positioned updates and deletes.
Instead, the programmer must use the DatabaseMetaData.supportsPositioned
Update() and
DatabaseMetaData.supportsPositionedDelete() methods to confirm that the underlying
DBMS does, in fact, support them. The Oracle DBMS, for example, supports
positioned updates and deletes.
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>
<P>Developers who have worked with ODBC-style cursors should be aware that JDBC
does not support scrollable cursors or enable the placement of bookmarks. The &quot;Querying
the Database&quot; section of the example scenario discussed later in this chapter
illustrates proper cursor use.
</P>

<H4><A NAME="ch17_ 19">
The java.sql.ResultSetMetaData Interface
</A></H4>

<P>The public interface ResultSetMetaData extends the Object class.
</P>

<H4><A NAME="ch17_ 20">
The java.sql.DatabaseMetaData Interface
</A></H4>

<P>The public interface DatabaseMetaData extends the Object class.
</P>

<H4><A NAME="ch17_ 21">
The java.sql.DriverManager Class
</A></H4>


<P>The DriverManager class extends the Object class. This class controls the
interface between the application and a set of JDBC drivers. The DriverManager class
also 
</P>

<A NAME="PAGENUM-788"><P>Page 788</P></A>


<P>provides a set of services for managing the drivers.
</P>

<P>During its initialization, the DriverManager class tries to load the driver classes that
are referenced in the &quot;jdbc.drivers&quot; system property. If this property exists, it should have
a colon-separated list of driver names. The DriverManager class attempts to load
each named Driver class. By modifying this property, a user can choose the JDBC drivers
to be used by his application. A program also can load JDBC drivers at run-time. A
Driver class, for example, can be explicitly loaded by using the standard
Class.forName() method. To load the imaginary.sql.iMsqldriver class, use the following line of code:
</P>

<PRE>
Class.forName(&quot;imaginary.sql.iMsqlDriver&quot;);
</PRE>

<P>The following sections describe the methods of the DriverManager class.
</P>

<P><B>The getConnection() Method
</P></B>

<P>The getConnection() method attempts to establish a connection to the specified
database URL. If the method is successful, it returns a Connection object, which represents
the connection to the database URL. If an error occurs, a SQL Exception is thrown.
</P>

<P>The method has three different forms:
</P>

<UL>
<LI>          Connection getConnection(String
DatabaseURL): This causes the DriverManager class to try
to select an appropriate JDBC driver from the drivers that are registered.
<LI>          Connection getConnection(String DatabaseURL, Properties
Props): This form accepts a Properties type parameter, which specifies a list of string name-value pairs. Usually, a
user and password property should be included.
<LI>          Connection getConnection(String DatabaseURL, String UserName, String
UserPassword): With this form, the username and password are explicitly passed as parameters instead
of being included in a Properties object.
</UL>

<P><B>The registerDriver() Method
</P></B>

<P>To register itself with the DriverManager, a newly loaded Driver class should call
this method. In the case of an error, a SQL Exception is thrown.
</P>


<P><B>The getDriver() Method
</P></B>

<P>This method causes the DriverManager object to attempt to load a driver that
understands a particular database URL. If such a driver is present and is registered,
the method returns a Driver object. This Driver object represents a JDBC driver that
can connect to the database URL. This method throws a SQL Exception if an error occurs.
</P>

<A NAME="PAGENUM-789"><P>Page 789</P></A>



<P><B>The getDrivers() Method
</P></B>

<P>To obtain a list of JDBC drivers that the current caller can access, use the
getDrivers() method. This method returns an Enumeration object containing all the currently
loaded JDBC drivers that are accessible to the caller.
</P>

<P><B>The deregisterDriver() Method
</P></B>

<P>The DriverManager class also can deregister drivers from the list of registered
drivers. This method drops the driver from the DriverManager's list. Applets, however,
can deregister only drivers from their own class loader. In the event of an error, this
method throws a SQL Exception.
</P>

<H4><A NAME="ch17_ 22">
The java.sql.DriverPropertyInfo Class
</A></H4>

<P>The DriverPropertyInfo class, which extends the Object class, is primarily of interest
to advanced programmers who require or want to explore various connection
properties. This class enables an interaction with a driver and provides properties for connections.
</P>

<P>The constructor of this class accepts the name of the property (as a String) and
the current value of the property (as a String). The current value of the property may be
null. The following list describes the variables for the DriverPropertyInfo class:
</P>

<UL>
<LI>          choices: This array contains the possible values for a property, if the value can
be selected from a set of values.
<LI>          description: This variable provides a brief description of the property; it can have
a null value.
<LI>          name: This variable supplies the name of the property.
<LI>          required: If this variable is set to true, a value must be supplied for the
property during Driver.connect(). Otherwise, the property is optional.
<LI>          value: This variable indicates the current value of the property. This value
depends on a combination of the information supplied to
getPropertyInfo(), the Java environment, and driver-supplied default values. If no value is known, it can be null.
</UL>


<H4><A NAME="ch17_ 23">
The java.sql.Date Class
</A></H4>

<P>This class is essentially an extension of the java.util.Date class. Functions have
been added to enable JDBC to identify this class as a SQL DATE value. The class
contains formatting and parsing operations to support the JDBC escape syntax for date values.
</P>

<P>The documentation provided by JavaSoft recommends against the use of the
full
</P>


<P><CENTER>
<a href="0784-0786.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0790-0793.html">Next</A>
</CENTER></P>







</BODY>
</HTML>

