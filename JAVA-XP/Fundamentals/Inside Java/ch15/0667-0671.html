<HTML>
<HEAD>


<TITLE>Inside Java:Java Beans: Java's Component Architecture:EarthWeb Inc.-</TITLE>






<P><CENTER>
<a href="0663-0666.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0672-0677.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-667"><P>Page 667</P></A>

<P>The fabricated mouse event then is posted to the system event queue. A reference
to this queue can be obtained by calling the static
getEventQueue() method of the new EventQueue class.
</P>

<PRE>
147           EventQueue.getEventQueue().postEvent(new MouseEvent(this,
148                              MouseEvent.MOUSE_CLICKED, 0,0,0,0,1));
</PRE>

<P>The event is delivered to any registered listeners by using the built-in
processEvent() and processMouseEvent() methods of the Panel class from which the Bean is derived.
</P>

<P>Lines 65_72 are the accessor methods for the &quot;date&quot; property:
</P>
<PRE>
065       public synchronized Date getDate() {
066           return calendar.getTime();
067       }
068
069       public synchronized void setDate(Date date) {
070           calendar.setTime(date);
071           displayCalendar();
072       }
</PRE>

<P>The getDate() accessor method returns the value of the Calendar
getTime() method. This getTime() method returns a Date object that represents the date/time information held
by the Calendar instance; in this case, the information is the currently selected date.
</P>

<P>The setDate() accessor method calls the
setTime() method of the Calendar object. This
setTime() method takes a Date argument and causes the Calendar object to represent
the given date and time. The setDate() accessor method then calls the
displayCalendar() method, which, as described above, updates the face of the Calendar1 Bean with the proper
&quot;day of the month&quot; buttons. This means that an application using the Calendar1 Bean
simply can call the setDate() accessor method, and not only will the internal state of the
Bean change, but Calendar1 also will turn to the given month. The same behavior happens in
a builder tool as well: When the developer changes the date property in the
property sheet, the Bean automatically displays the entered month. One stipulation
exists, however: The builder tool must know how to present the Date type in the property
sheet for editing. In the &quot;Developing Property Editors&quot; section of this chapter, a Date
property editor is built for use with the Calendar1 and Calendar2 (shown later) Beans.
</P>



<P>Now it's time to examine listing 15.4 that, as mentioned earlier, uses a simple Bean
called Listener1.
</P>

<P>Listing 15.4
</P>
<PRE>
Line==================Java Source=================
01   //////////
</PRE>

<A NAME="PAGENUM-668"><P>Page 668</P></A>


<PRE>
02   // Listener1.java  Listens for mouse clicks
03   // on the Calendar1 Bean.
04   //
05   // Author: James L. Weaver  JDK 1.1 beta1
06   //////////
07   package chapter15.code.calendar1;
08
09   import java.awt.*;
10   import java.awt.event.*;
11   import java.text.*;
12   import java.util.*;
13   import java.io.Serializable;
14
15   public class Listener1 extends TextField
16                          implements Serializable, MouseListener
17   {
18       public Listener1() {
19           super(&quot;?????????&quot;, 15);
20           setEditable(false);
21       }
22
23       // Required by MouseListener interface
24       public void mousePressed(MouseEvent evt) {}
25       public void mouseReleased(MouseEvent evt) {}
26       public void mouseEntered(MouseEvent evt) {}
27       public void mouseExited(MouseEvent evt) {}
28
29       public synchronized void mouseClicked(MouseEvent evt) {
30           // Get a reference to the Calendar1 Bean
31           Calendar1 src = (Calendar1)evt.getComponent();
32
33           // Set the &quot;date&quot; property of the Calendar1 Bean
34           // and display it in the text field
35           Date date = src.getDate();
36           SimpleDateFormat df = new SimpleDateFormat(&quot;MM/dd/yyyy&quot;);
37           setText(df.format(date));
38       }
39   }
</PRE>

<A NAME="PAGENUM-669"><P>Page 669</P></A>

<P>The Listener1 Bean depicted in listing 15.4 listens for mouse events from the
Calendar1 Bean and then displays the selected date as a text string. For this reason, the
Listener1 Bean extends the TextField class, although any subclass capable of displaying text
could have been chosen.
</P>

<P>Because Java doesn't support multiple class inheritance, the Listener1 class can't
extend the MouseAdapter convenience class (which, as you recall, implements an
empty method for each method in the MouseListener interface). For this reason, these
methods are explicitly defined in lines 24_29.
</P>

<P>In the mouseClicked() method (lines 29_38), a reference to the Calendar1 Bean is
retrieved from the event, and the getDate() accessor method then is called to get the selected
date. To display the date, another new class related to internationalization,
named SimpleDateFormat, is used. This class enables you to display date and time
information in a flexible manner.
</P>

<P>It is now necessary to create the frame in which to run the Calendar1 and
Listener1 Beans.
</P>

<P>Listing 15.5
</P>
<PRE>
Line==================Java Source=================
01   //////////
02   // CalendarFrame1.java  Frame in which to run the Calendar1
03   // Java Bean.
04   //
05   // Author: James L. Weaver  JDK 1.1 beta1
06   //////////
07   package chapter15.code.calendar1;
08
09   import java.awt.*;
10   import java.awt.event.*;
11   import java.util.*;
12
13   public class CalendarFrame1 extends Frame {
14
15       Calendar1 cal;
16       Listener1 listener;
17
18       public CalendarFrame1() {
19           super(&quot;Calendar1 Java Bean Demo&quot;);
20
</PRE>
<PRE>
                                                       <I>continues</I>
</PRE>


<A NAME="PAGENUM-670"><P>Page 670</P></A>


<P>
Listing 15.5, Continued
</P>

<PRE>

21           setLayout(new BorderLayout());
22           addWindowListener(new Wadapt());
23           setSize(300, 300);
24
25           cal = new Calendar1();
26           add(&quot;Center&quot;, cal);
27
28           Panel p = new Panel();
29           add(&quot;North&quot;, p);
30           listener = new Listener1();
31           p.add(listener);
32
33           // Wire the Beans together by adding the Listener1 Bean
34           // as a mouse event listener to the Calendar1 Bean
35           cal.addMouseListener(listener);
36           setVisible(true);
37
38           // Set the &quot;date&quot; property of the Scope Bean to today
39           cal.setDate(new Date());
40       }
41
42       public static void main(String args[]) {
43           CalendarFrame1 calFrame = new CalendarFrame1();
44           return;
45       }
46   }
47
48   class Wadapt extends WindowAdapter
49   {
50       public void windowClosing(WindowEvent evt) {
51           evt.getWindow().setVisible(false);
52           evt.getWindow().dispose();
53           System.exit(0);
54       }
55   }
</PRE>

<P>The CalendarFrame1 application depicted in listing 15.5 creates a Calendar1 Bean and
a Listener1 Bean and then places them in the application window.
</P>

<A NAME="PAGENUM-671"><P>Page 671</P></A>

<P>Line 35 registers the Listener1 Bean as a mouse event listener of the Calendar1
Bean. This enables the MOUSE_CLICKED event type to be delivered, which in this case
means that a new date is selected in the Calendar1 Bean.
</P>

<P>Line 39 sets the date property of the Calendar1 Bean to today's date, which causes
the current month to be displayed on the Bean.
</P>

<P>Figures 15.3 and 15.4 show the outcome of the code we have created. Figure
15.3 illustrates the Calendar1 and Listener1 Beans running in an application.
</P>

		

<P>Figure 15.4 shows the Calendar1 Bean and PropertySheet in the BDK BeanBox.
</P>




<P>This Calendar1 Bean is one example of how native Java events can be emitted from
a Bean. The Calendar2 Bean in the next section offers an example of creating your
own event classes, types, and listeners.
</P>


<P><B>Creating Your Own Events and Listeners
</B></P>


<P>
<a href="images\ch15fg03.jpg"><img src="images\tn_ch15fg03.jpg"></a><BR>
Figure 15.3 <I>The Calendar1 and Listener1 Beans running in an application.</I>
</P>



<P>For some Beans, it is better to create a specialized event class than to use a native
Java event class. In the Calendar1 example, the MouseEvent is used to communicate that
the selected date changed. It might be more natural to create a specialized DateEvent
class that contains a &quot;date changed&quot; event type. This event could be fired each time
the selected date changes, and a method of the event object could be called by the
listener to determine the newly selected date.
</P>

<P><B>
The Calendar2 Bean
</B></P>

<P>Listing 15.6 depicts a Java Bean named Calendar2 that emits a specialized event
class named DateEvent to its listeners whenever the selected date changes. Listing 15.7 is
the DateEvent class; listing 15.8 is the DateEventListener interface that listeners of
the DateEvent class must implement. Listing 15.9 is a Bean named Listener2 that
implements the DateEventListener interface. Listing 15.10 is the CalendarFrame2 application
that creates, displays, and wires up the Beans to each other by registering the Listener2
Bean
</P>


<P><CENTER>
<a href="0663-0666.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0672-0677.html">Next</A>
</CENTER></P>







</BODY>
</HTML>

