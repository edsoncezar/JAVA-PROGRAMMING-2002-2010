<HTML>
<HEAD>


<TITLE>Inside Java:Java Beans: Java's Component Architecture:EarthWeb Inc.-</TITLE>






<P><CENTER>
<a href="0700-0704.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0710-0714.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-705"><P>Page 705</P></A>


<P>
_1, as shown in table 15.1). You can extend your BeanInfo class from
SimpleBeanInfo and only override the methods for which you want to supply explicit information. 
The next section contains an example of associating icons with a Bean by using
the SimpleBeanInfo class.
</P>



<P><B>
Associating Icons with a Bean
</B></P>

<P>Listing 15.15 depicts a Calendar2BeanInfo class
that extends the SimpleBeanInfo convenience class described previously. The icons associated with the Bean are the only
explicit information provided. Therefore, only the
getIcon() method is overridden.
</P>

<P>Listing 15.15
</P>
<PRE>
Line==================Java Source=================
01   //////////
02   // Calendar2BeanInfo.java  Demonstrates an overridden
03   // SimpleBeanInfo class. The only thing overridden is
04   // the getIcon() method so that a builder tool will
05   // display the icon for this bean.
06   //
07   // Author: James L. Weaver  JDK 1.1 beta1
08   //////////
09   package chapter15.code.scope2;
10
11   import java.awt.*;
12   import java.beans.*;
13
14   public class Calendar2BeanInfo extends SimpleBeanInfo {
15
16       public Image getIcon(int iconKind) {
17           if (iconKind == BeanInfo.ICON_COLOR_16x16) {
18               java.awt.Image img = loadImage(&quot;CalendarIcon16.gif&quot;);
19               return img;
20           }
21           else if (iconKind == BeanInfo.ICON_COLOR_32x32) {
22               java.awt.Image img = loadImage(&quot;CalendarIcon32.gif&quot;);
23               return img;
24           }
25           else {
26               return null;
</PRE>

<A NAME="PAGENUM-706"><P>Page 706</P></A>

<PRE>
27           }
28       }
29   }
</PRE>

<P>The Introspector calls the getIcon() method four times, once with each BeanInfo
constant mentioned in the getIcon() method of table 15.1. Lines 18 and 23 return
the corresponding images for ICON_COLOR_16x16 and ICON_COLOR_32x32, but ICON_MONO_16x16
and ICON_MONO_32x32 return null. You only have to supply icons for a Bean if you want
to control how the builder tool represents your Bean in a toolbox. If you supply just
one icon, it is recommended that it be an ICON_COLOR_16x16.
</P>

<P>The Introspector also calls every other method in the BeanInfo interface, to which
the Calendar2BeanInfo class responds, &quot;Go get implicitly defined information using
design patterns.&quot;
</P>

<P>As you have seen, the introspection process uses a Bean and an optional
BeanInfo object as input. The output of the introspection process consists of another
BeanInfo object that fully describes the properties, events, methods, icons, and overall
information about the Bean. The next section shows how to use this created BeanInfo object
to extract information about the Bean.
</P>

<P>
<B>
The xmnbean Utility
</B>
</P>

<P>
Listing 15.16 (xmnbean.java) depicts an example of how you can accomplish the
following actions:
</P>

<UL>
<LI>          Initiate the introspection process
<LI>          Use the output of the introspection process to display information about the Bean
</UL>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
NOTE
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
This utility uses the same java.beans classes and methods that a builder tool uses
to examine a Bean.
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>
<P>Listing 15.16
</P>
<PRE>
Line==================Java Source=================
01   //////////
02   // xmnbean.java  Utility to examine
03   // (do introspection on) a Java Bean
04   //
05   // Author: James L. Weaver  JDK 1.1 beta1
06   //////////
</PRE>


<A NAME="PAGENUM-707"><P>Page 707</P></A>


<PRE>
07   package chapter15.code.xmnbean;
08
09   import java.io.*;
10   import java.beans.*;
11
12   public class xmnbean
13   {
14       static String classStr;
15       protected BeanDescriptor bd;
16       protected PropertyDescriptor pd[];
17       protected EventSetDescriptor ed[];
18       protected MethodDescriptor md[];
19       FileWriter fw;
20       PrintWriter pw;
21
22       public xmnbean() throws Exception {
23           fw = new FileWriter(&quot;beaninfo.txt&quot;);
24           pw = new PrintWriter(fw);
25
26           // Load the Bean's class and create a Class object
27           // to represent it.
28           Class bean = Class.forName(classStr);
29
30           // Introspect the Bean and store results in
31           // a BeanInfo object.
32           BeanInfo bi = Introspector.getBeanInfo(bean);
33
34           // Get general Bean information from BeanDescriptor.
35           bd = bi.getBeanDescriptor();
36           pw.println(&quot;Bean name: &quot; + bd.getName());
37           pw.println(&quot;Bean class: &quot; + bd.getBeanClass());
38           pw.println(&quot;&quot;);
39
40           // List all bean properties.
41           pw.println(&quot;==== Properties: ====&quot;);
42           pd = bi.getPropertyDescriptors();
43           for (int i=0; i&lt;pd.length; i++) {
44               pw.println(&quot;Name: &quot; + pd[i].getName());
45               pw.println(&quot;    Type:   &quot; + pd[i].getPropertyType());
</PRE>
<PRE>
                                                       <I>continues</I>
</PRE>

<A NAME="PAGENUM-708"><P>Page 708</P></A>

<P>
Listing 15.16, Continued
</P>
<PRE>
46               pw.println(&quot;    Getter: &quot; + pd[i].getReadMethod());
47               pw.println(&quot;    Setter: &quot; + pd[i].getWriteMethod());
48           }
49           pw.println(&quot;&quot;);
50
51           // List all bean events.
52           pw.println(&quot;==== Events: ====&quot;);
53           ed = bi.getEventSetDescriptors();
54           for (int i=0; i&lt;ed.length; i++) {
55               pw.println(&quot;Event Name: &quot; + ed[i].getName());
56               pw.println(&quot;    Add Listener Method: &quot; +
57                           ed[i].getAddListenerMethod());
58               pw.println(&quot;    Remove Listener Method: &quot; +
59                           ed[i].getRemoveListenerMethod());
60               md = ed[i].getListenerMethodDescriptors();
61               for (int j=0; j&lt;md.length; j++) {
62                   pw.println(&quot;    Event Type: &quot; + md[j].getName());
63               }
64           }
65           pw.println(&quot;&quot;);
66
67           // List all bean methods.
68           pw.println(&quot;==== Methods: ====&quot;);
69           md = bi.getMethodDescriptors();
70           for (int i=0; i&lt;md.length; i++) {
71               pw.println(md[i].getName());
72           }
73           pw.println(&quot;&quot;);
74
75           pw.close();
76       }
77
78       public static void main(String args[]) throws Exception {
79           classStr = args[0];
80           xmnbean x = new xmnbean();
81       }
82   }
</PRE>

<A NAME="PAGENUM-709"><P>Page 709</P></A>

<P>This application takes the fully qualified name of the Bean to be examined as the
command line argument, such as &quot;chapter15.code.calendar2.Calendar2.&quot;
</P>

<P>The main() method in lines 78_81 puts this argument into a static variable and creates
an instance of this application's class.
</P>

<P>Lines 15_18 contain some java.beans classes from figure 15.9. These are returned
from BeanInfo methods, as shown in table 15.1. Notice that all these classes are derived
from the FeatureDescriptor class, which provides some methods common to these classes.
</P>

<P>Lines 19 and 20 contain two java.io classes new to JDK 1.1 that support
internationalization by writing 16-bit Unicode characters.
</P>

<P>Lines 23 and 24 indicate that the output from this program will be stored in
the beaninfo.txt file. Feel free to modify this application to accept a command line
argument that specifies an output file, as well as any other modifications you want to make.
</P>

<P>The static Class.forName() method in line 28 loads the Bean and returns a Class object
that represents the Bean.
</P>

<P>Line 32 is the most powerful line in the program. This line calls the static
getBeanInfo() method of the Introspector class, which performs the entire introspection process.
All builder tools and applications should use this method to perform introspection
because it provides a single consistent mechanism. This method returns a BeanInfo object
that fully describes the properties, events, methods, icons, and overall information about
the Bean. The rest of this application interrogates this BeanInfo object to retrieve
and display this information.
</P>

<P>Line 35 begins the interrogation by calling the BeanInfo object's
getBeanDescriptor() method, which appeared in table 15.1. This returns a BeanDescriptor instance that is queried
for the Bean name in line 36 and the Bean class in line 37.
</P>

<P>Line 42 calls the BeanInfo object's
getPropertyDescriptors() method, which returns a PropertyDescriptor array. Lines 44_48 print the name, property type, and
accessor methods for each property in the array.
</P>

<P>Line 53 calls the BeanInfo object's
getEventSetDescriptors() method, which returns an EventSetDescriptor array. Lines 55_59 print the name and registry methods. Line 60
calls the current EventSetDescriptor object's
getListenerMethodDescriptors() method, and line 62 prints the listener method names (event types) for each event in the array.
</P>

<P>Finally, line 69 calls the BeanInfo object's
getMethodDescriptors() method, which returns a MethodDescriptor array. Line 71 prints the name of each method in the array.
</P>

<P>
Try running the utility with some of this chapter's example Beans as the argument.
You may be surprised at how many properties, events, and methods the xmnbean
utility
</P>


<P><CENTER>
<a href="0700-0704.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0710-0714.html">Next</A>
</CENTER></P>







</BODY>
</HTML>

