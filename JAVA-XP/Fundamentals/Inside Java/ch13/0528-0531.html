<HTML>
<HEAD>


<TITLE>Inside Java:The New, Improved AWT: GUI Compo- nents, Containers, and Layout Manag- ers:EarthWeb Inc.-</TITLE>






<P><CENTER>
<a href="0523-0527.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0532-0535.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-528"><P>Page 528</P></A>


<P>
<B>On the
CD</B><BR>

<P>Listing 13.2, which is the program ScrollbarSlider.java on the CD-ROM
accompanying this book, depicts an applet that serves as an example of how you can use a Scrollbar
as a &quot;slider&quot; for user input. Figure 13.5 displays this applet's user interface. As you
interact with the scrollbar by sliding the bubble, clicking the arrows, or clicking between
the bubble and an arrow, the value of the scrollbar changes. The new value is then
reflected in the text field.
</P>

<P>Listing 13.2
</P>
<PRE>
Line==================Java Source=================
01   //////////
02   // ScrollbarSlider.java  Example of using a Scrollbar
03   // as a &quot;slider&quot; for the user to set a value
04   //
05   // Author: James L. Weaver  JDK 1.1 beta1
06   //////////
07   import java.awt.*;
08   import java.applet.*;
09   import java.awt.event.*;
10
11   public class ScrollbarSlider extends Applet
12                              implements AdjustmentListener{
13
14       // Declare a Scrollbar and a TextField
15       Scrollbar slider;
16       TextField value;
17
18       public void init() {
19
20           // Set the layout to BorderLayout
21           setLayout(new BorderLayout());
22
23           // Create a Horizontal Scrollbar with an initial
24           // value of 100, a visible amount of 1, a minimum
25           // value of 0, and a maximum value of 200.
26           slider = new Scrollbar(Scrollbar.HORIZONTAL,
27                                  100, 1, 0, 200);
28
</PRE>



<A NAME="PAGENUM-529"><P>Page 529</P></A>


<PRE>
29           // Set the Unit Increment value to 1, and the
30           // Block Increment value to 25
31           slider.setUnitIncrement(1);
32           slider.setBlockIncrement(25);
33
34           // Place the slider at the bottom of the
35           // applet
36           add(&quot;South&quot;, slider);
37
38           // Create a TextField that initially contains &quot;100&quot;
39           value = new TextField(&quot;100&quot;, 5);
40
41           // Create a Panel to put inside the center
42           // region of the applet, so that the
43           // value TextField may be added to it.
44           Panel p = new Panel();
45           add(&quot;Center&quot;, p);
46           p.add(value);
47
48           // Add an event &quot;listener&quot; for when an adjustment
49           // event happens to this Scrollbar. The
50           // adjustmentValueChanged method of the listener will
51           // be called.
52           slider.addAdjustmentListener(this);
53
54       }
55
56       // This method is called when the Scrollbar is adjusted
57       public void adjustmentValueChanged(AdjustmentEvent e) {
58            if (e.getAdjustable() == slider) {
59                // Put the value from the event into the TextField
60                value.setText(new Integer(e.getValue()).toString());
61            }
62       }
63   }
</PRE>

<P>Here is the associated HTML:
</P>

<A NAME="PAGENUM-530"><P>Page 530</P></A>


<PRE>
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt; Scrollbar Slider &lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;APPLET CODE=&quot;ScrollbarSlider.class&quot; WIDTH=300 HEIGHT=100&gt;&lt;/APPLET&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>

<P>Let's examine some of the more interesting points in this applet:
</P>

<P>Line 21 sets the layout manager of the applet to BorderLayout. Layout managers
are essentially classes that assist you in arranging AWT components on the screen.
The next section discusses layout managers in more detail.
</P>

<P>Lines 26 and 27 construct a horizontal scrollbar. This form of the ScrollBar
constructor takes five parameters: Orientation, Value, Visible Amount, Minimum, and Maximum.
</P>

<UL>
<LI>          Orientation: In this case, the final static variable Scrollbar.HORIZONTAL
is passed, which produces a horizontal scrollbar. The other possibility
is Scrollbar.VERTICAL.
<LI>          Value: The initial value is set to 100, which is halfway between the minimum
and maximum values for this scrollbar. Using this value places the bubble's
initial position at approximately the middle of the scrollbar.
<LI>          Visible Amount: Because this scrollbar represents only a value (and because it
is not being used in conjunction with a scrolling area), the size of the bubble
should be as small as possible. Therefore, a value of one is used for this parameter.
You can set this value at any number greater than zero if you want to
implement &quot;proportional&quot; scrollbars. The size of the bubble on a proportional
scrollbar represents the visible amount of the document being scrolled. The
horizontal scrollbar in figure 13.4, for example, has a bubble that is approximately 40
percent of the length of the scrollbar. This means that approximately 40 percent of
the document's width is currently visible in the scrolling area.
<LI>          Minimum: In this case, the lowest value that this scrollbar can represent is set
to zero.
<LI>        Maximum: In this case, the highest value that this scrollbar can represent is set
to 200.
</UL>

<P>Line 31 determines the increment by which the value will be increased when the
user clicks the left or right arrows on the scrollbar. From a usability standpoint, it is
important to choose a reasonable value for Unit Increment. In this case, the value is set to one.
</P>

<A NAME="PAGENUM-531"><P>Page 531</P></A>



<P>Line 32 determines the increment by which the value will be increased when the
user clicks between the bubble and one of the arrows on the scrollbar. As with the
Unit Increment, it is important to choose a reasonable value for Block Increment.
</P>

<P>Line 36 causes the scrollbar to appear at the bottom of the applet's display, stretched
to the full width of the applet.
</P>

<P>Lines 39_46 create a text field in which to display the scrollbar's value. These lines
also cause the text field to be centered above the scrollbar.
</P>

<P>Line 52 identifies an &quot;adjustment listener.&quot; This listener is called when the scrollbar
emits an adjustment event, such as when the user drags the bubble. As mentioned
previously, these concepts belong to the Delegation Event Model, which will be covered in
Chapter 14, &quot;The New, Improved AWT: Menus, Events, and More New Features.&quot;
</P>

<P>Lines 57_62 contain the body of the adjustment listener, which obtains the current
value of the scrollbar, converts it to a String, and adds it to the text box.
</P>

<P>
<a href="images\ch13fg05.jpg"><img src="images\tn_ch13fg05.jpg"></a><BR>
<B>Figure 13.5</B>
<I>ScrollbarSlider applet display.</I>
</P>

<P>Table 13.10 lists some commonly used methods in the Scrollbar class. For a complete
list, refer to the following Web page:
</P>
<PRE>

http://java.sun.com/products/JDK/1.1/docs/api/java.awt.Scrollbar.html
</PRE>

<P><B>Table 13.10
</P></B>
<P>Commonly Used Constructors and Methods in the
Scrollbar Class
</P>
<TABLE>

<TR><TD>
Constructor/Method
</TD><TD>
Description
</TD></TR><TR><TD>
Scrollbar(int)
</TD><TD>
Creates a Scrollbar with the specified orientation.
</TD></TR><TR><TD>
Scrollbar(int, int, int, int, int)
</TD><TD>
Creates a Scrollbar with the specified orientation,
initial value, amount visible, minimum value, and
maximum value.
</TD></TR><TR><TD>
int getValue()
</TD><TD>
Returns the current value represented by the
</TD></TR></TABLE>

<PRE>
<I>
                                                          continues
</I>
</PRE>


<P><CENTER>
<a href="0523-0527.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0532-0535.html">Next</A>
</CENTER></P>







</BODY>
</HTML>

