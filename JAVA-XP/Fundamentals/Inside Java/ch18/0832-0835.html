<HTML>
<HEAD>


<TITLE>Inside Java:Servlets and the Java Web Server:EarthWeb Inc.-</TITLE>






<P><CENTER>
<a href="0828-0831.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0836-0840.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-832"><P>Page 832</P></A>





<P><B>Table 18.13</B><BR>
HTML Creation Classes
</P>

<TABLE>

<TR><TD>
Class
</TD><TD>
Description
</TD></TR><TR><TD>
HtmlElement
</TD><TD>
Supports the basic HTML element interface definition.
</TD></TR><TR><TD>
HtmlText  
</TD><TD>
Supports text enclosed by tags.
</TD></TR><TR><TD>
HtmlContainer
</TD><TD>
Supports a list of HtmlElements enclosed by tags.
</TD></TR><TR><TD>
HtmlApplet
</TD><TD>
Supports the applet HTML tag with width and height 
specification.
</TD></TR><TR><TD>
HtmlChoice
</TD><TD>
Supports the select HTML tag.
</TD></TR><TR><TD>
HtmlDefinitionList
</TD><TD>
Supports the dl, dt, and dd HTML tags.
</TD></TR><TR><TD>
HtmlForm
</TD><TD>
Supports building HTML forms comprised of input fields,
check boxes, radio buttons, text areas, selections, and submit buttons.
</TD></TR><TR><TD>
HtmlFrameset
</TD><TD>
Supports frameset HTML tag.
</TD></TR><TR><TD>
HtmlImageMap
</TD><TD>
Supports client-side image map HTML tags.
</TD></TR><TR><TD>
HtmlList
</TD><TD>
Supports the ul and ol HTML list tags.
</TD></TR><TR><TD>
HtmlPage
</TD><TD>
Supports building a Web page comprised of a header and body areas.
</TD></TR><TR><TD>
HtmlTable
</TD><TD>
Supports building of tables from row elements.
</TD></TR><TR><TD>
HtmlRow
</TD><TD>
Supports the HTML to define a row of a table.
</TD></TR></TABLE>

<P>All the classes in this package implement the HtmlElement interface, which enables
you to specify text for the HTML tag and write the resulting HTML to an output stream.
By creating objects that represent the various HTML tags and calling methods to add
data and attributes to the tags, you can generate the most common HTML elements and
avoid some simple errors, such as ending tags in the wrong order. It may, however, be
simpler to hand-generate the HTML, particularly for simple, static pages. The examples in
the section &quot;Writing Servlets,&quot; which follows, make use of the classes from
the java.servlet.html package to generate dynamic response pages.
</P>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
NOTE
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
The methods in this package do not automatically add double-quotes to enclose
literal strings used as HTML attributes. You must add double quotes if your string
has embedded spaces or other special control characters.<BR>
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>
<A NAME="PAGENUM-833"><P>Page 833</P></A>

<P>The parameter layout of these methods is similar for all classes. The first parameter is
the information that is to be added to the HtmlElement. Overloaded methods are
often defined to handle the addition of Strings, HtmlElements, or Vectors.
</P>

<P>The second parameter is either the tag or attributes for a tag implied by the
method. HtmlContainer.addLink(), for example, implies an &quot;a&quot; tag, so the second parameter is
interpreted as attributes of the tag. When using tags, do not include the `&lt;`, `&gt;', or
`/' characters in the tag string; these characters are automatically supplied where
needed. Multiple tags are specified by using a comma-delimited string.
</P>

<P>These HTML support classes do not check the actual HTML to verify that the tags
and keys are legal and used correctly. They only ensure that the tags are terminated in
the correct order.
</P>

<H3><A NAME="ch18_ 10">
Writing Servlets
</A></H3>

<P>The Servlet API provides an environment that makes writing servlets very easy.
All servlets must implement the java.servlet.Servlet interface. The easiest way is
by subclassing either GenericServlet or HttpServlet; regular HTTP-processing
servlets subclass HttpServlet and server-side-include servlets subclass GenericServlet. When
an HTTP request is received, the server translates the URL into a reference to a
specific servlet class. If this is the first request for the servlet, the servlet class is
dynamically loaded, and its init() method is called to perform any necessary servlet-specific
initialization. In most cases, the servlet has already been loaded, in which case its
service() method is just called.
</P>

<P>Note that several different threads can concurrently execute the
service() method 
of the same servlet object. A single instance of the FileServlet object, for example,
serves all requests to load files. Consequently, servlets must be designed to operate
in multithreaded environments. The easiest way to ensure this is to store all
information about the request being processed in local variables rather than store it as
instance variables in the servlet object. For cases in which access to a single resource must
be controlled, you must use the standard Java synchronization techniques based on
the Synchronized keyword. In most cases, you can simply add the
Synchronized modifier to the declaration for
service(), or sendResponse() and effectively modify the servlet to serve only
one client at a time. Of course, limiting access to a single thread (that is, handling
client requests one at a time) may reduce performance.
</P>

<P>The following sections contain examples of a simple HelloWorld servlet and a
forms processing servlet.
</P>

<H4><A NAME="ch18_ 11">
HelloWorldServlet
</A></H4>

<A NAME="PAGENUM-834"><P>Page 834</P></A>





<P>This section shows how to build a simple
servlet that outputs &quot;Hello World&quot; and displays a table of the various HTTP information available from the request. To run
this example servlet on the Java Web Server, you must specify the following:
</P>

<UL>
<LI>          A rule that translates the URL (/helloworldservlet) to the name of the
servlet (helloworldservlet).
<LI>          The class name for the servlet code (HelloWorldServlet).
<LI>          The addition of the servlet to the list of servlets loaded at startup.
</UL>

<P>You can reconfigure the server by using the administration servlet or by editing
the configuration files as described in table 18.15. After compiling the servlet, copy the
.class file into the /servlet directory, which is the default location of servlet code.
</P>

<P><B>Table 18.15</B><BR>
Configuration Changes Needed to Run the &quot;Hello
World&quot; Servlet with the Java Web Server
</P>

<TABLE>

<TR><TD>
File
</TD><TD>
Change
</TD><TD>
Additions
</TD></TR><TR><TD>
rules.properties
</TD><TD>
add
</TD><TD>
/helloworldservlet=
helloworldservlet
</TD></TR><TR><TD>
servlet.properties
</TD><TD>
edit
</TD><TD>
servlets.startup= file cgi invoker
admin error helloworldservlet
</TD></TR><TR><TD>
</TD><TD>
add
</TD><TD>
helloworldservlet.code=HelloWorldServlet
</TD></TR></TABLE>

<P>The code in listing 18.1 (HelloWorldServlet.java on the CD-ROM accompanying
this book) subclasses HttpServlet, overrides the
service() method, and uses the HTML support classes to generate the response.
</P>

<P>Listing 18.1
</P>

<PRE>
Line==================Java Source=================
01  import java.io.*;
02  import java.servlet.*;
03  import java.servlet.html.*;
04  import java.servlet.http.*;
05
</PRE>

<A NAME="PAGENUM-835"><P>Page 835</P></A>



<PRE>
06  public class HelloWorldServlet extends HttpServlet {
07    public void HelloWorldServlet() {
08    }
09
10    public String getServletInfo() {
11      return &quot;This servlet displays a hello message.&quot;;
12    }
13
14    public void service (HttpServletRequest req, HttpServletResponse res)
15      throws ServletException, IOException {
16    ServletOutputStream out = res.getOutputStream();
17    res.setContentType(&quot;text/html&quot;);
18    HtmlPage page = new HtmlPage(&quot;Hello World&quot;);
19    page.add(&quot;Hello World&quot;, &quot;h1&quot;);
20
21    HtmlTable tbl = new HtmlTable(&quot;Border&quot;);
22    tbl.addHeader(&quot;Parameter&quot;);
23    tbl.addHeader(&quot;Value&quot;);
24    nextRow(tbl, &quot;Server name&quot;, req.getServerName());
25    nextRow(tbl, &quot;Server port&quot;, req.getServerPort());
26    nextRow(tbl, &quot;Client host&quot;, req.getRemoteHost());
27    nextRow(tbl, &quot;Client addr&quot;, req.getRemoteAddr());
28    nextRow(tbl, &quot;Protocol&quot;, req.getProtocol());
29    nextRow(tbl, &quot;Method&quot;, req.getMethod());
30    nextRow(tbl, &quot;Request URI&quot;, req.getRequestURI());
31    nextRow(tbl, &quot;Request path&quot;, req.getRequestPath());
32    nextRow(tbl, &quot;Servlet path&quot;, req.getServletPath());
33    nextRow(tbl, &quot;Path info&quot;, req.getPathInfo());
34    nextRow(tbl, &quot;Translated path&quot;, req.getPathTranslated());
35    nextRow(tbl, &quot;Query String&quot;, req.getQueryString());
36    nextRow(tbl, &quot;Authorization&quot;, req.getAuthType());
37    nextRow(tbl, &quot;Remote user&quot;, req.getRemoteUser());
38    nextRow(tbl, &quot;Content length&quot;, req.getContentLength());
39    nextRow(tbl, &quot;Content type&quot;, req.getContentType());
40    page.add(tbl);
41
42    tbl = new HtmlTable(&quot;Border&quot;);
43    tbl.addHeader(&quot;Header Field&quot;);
</PRE>
<PRE>
                                                          <I>continues</I>
</PRE>
<P><CENTER>
<a href="0828-0831.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0836-0840.html">Next</A>
</CENTER></P>







</BODY>
</HTML>

