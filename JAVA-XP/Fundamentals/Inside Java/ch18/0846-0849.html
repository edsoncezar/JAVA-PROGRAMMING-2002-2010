<HTML>
<HEAD>


<TITLE>Inside Java:Servlets and the Java Web Server:EarthWeb Inc.-</TITLE>






<P><CENTER>
<a href="0841-0845.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0850-0854.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-846"><P>Page 846</P></A>



<OL>
complete page to the output stream:

<PRE>
160        page.write(out);
</PRE>
</OL>

<P>The first write to the ServletOutputStream triggers a write of the HTTP response
header to the output stream. Even though the ServletOutputStream is buffered, you do not
need to call the flush() method; the server automatically calls the stream's
flush() method.
</P>

<P>Lines 162_171 catch exceptions and return errors to the requester. This completes
the PlanetsServlet. Figure 18.3 shows the output of the servlet. The following
section describes the Java Web Server in more detail.
</P>

<H3><A NAME="ch18_ 13">
Using the Java Web Server
</A></H3>

<P>Just as Sun needed to implement the HotJava browser to develop the Java language
and applet environment, a server environment is needed to develop, test, and
demonstrate the Servlet API. The new Java Web Server fulfills these needs and represents a
reference implementation of the Servlet API. The server is completely written with Java
technology <BR>

<P>
<a href="images\ch18fg03.jpg"><img src="images\tn_ch18fg03.jpg"></a><BR>
Figure 18.3 <i>PlanetsServlet output.</i>
</P>

<P>and operates on any Java-compliant server platform. The next section provides you
with a quick introduction to the Java Web Server.
</P>

<H4><A NAME="ch18_ 14">
Setting up the Java Web Server
</A></H4>

<P>As is the case with most servers, a variety of parameters need to be set for proper
server operation when using the Java Web Server. Fortunately, the default parameter
values can be used in most cases. You can reconfigure the server either by editing 
the configuration files or by using the administration servlet. In most cases, you use
the
</P>
<A NAME="PAGENUM-847"><P>Page 847</P></A>


<P>
servlet because it ensures correct formatting of the configuration file entries.
Because this servlet will likely change for the final release, the following section explains
the entries in the underlying configuration files. Each configuration file entry corresponds
to a command in the administration servlet.
</P>

<P>The configuration files, all kept in the /admin subdirectory, are in the Properties class
file format. Properties is a subclass of Hashtable that defines a mechanism to load and
store the contents of a hashtable to a file. Each line in the file corresponds to one
key/value entry in a Hashtable and is comprised of key string separated from a value string by
the equality (=) character. The server's TCP port, for example, is specified by the
following entry in the httpd.properties file:
</P>

<PRE>
server.port=8080
</PRE>

<P>Three configuration files are related to servlet operation that are of interest to
the administrator or servlet developer:
</P>

<UL>
<LI>          Path translation rules&#151;rules.properties file
<LI>          File alias table&#151;aliases.properties file
<LI>          Servlet control and init parameters&#151;servlet.properties file
</UL>

<P>These files are explained further in following sections.</P>


<P>In addition to configuration information directly related to servlets, the Java Web
Server supports virtual hosting, proxy operation, and an access control scheme. Virtual
hosting enables the administrator to establish multiple, logically disjointed HTML
document collections on one physical server. Unless you closely inspect the <BR>
IP address of the servers, you are probably unaware that different virtual hosts
are served by one physical server. Compare IP addresses because even the IP host names
of virtual hosts are distinct. Proxy services supports operation through a security
firewall and provides local caching for proxied files.
</P>

<P>Server access control is supported by a scheme of security realms, users and
groups, and access control lists. The related files are as follows:
</P>

<UL>
<LI>          Access control lists&#151;acl.properties file
<LI>          General security configuration&#151;security.properties file
<LI>          User and group identification files stored within the realm directory
</UL>

<A NAME="PAGENUM-848"><P>Page 848</P></A>





<P>The next section focuses on the configuration aspects related to servlets.
</P>

<P><B>Path Translation Rules</B>
</P>

<P>The rules.properties file defines the translation rules for converting an URL request
to the name of the servlet that handles the request. An example file is as follows:
</P>

<PRE>
/=file
/cgi-bin=cgi
/imagemap=imagemap
/servlet=invoker
/admin/adminservlet=admin
/loganalyzer=loganalyzer
</PRE>

<P>The string to the left of the equals sign (=) is matched against the requested URL;
the longest match, starting from the left of the requested URL, is used in the translation.
The string on the right of the = is the name of the servlet to handle the request. The string
&quot;/&quot; to the left on the first line specifies the default mapping as &quot;file,&quot; which provides
the usual HTTP file and directory service.
</P>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
TIP
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
If you want to replace one of the standard, built-in servlets, such as &quot;file,&quot; with
your own custom version, do not change the name of the servlet in the rules.properties
file&#151;instead change the class to be loaded for the servlet named &quot;file&quot; in
the servlet.properties file. Internally, the server code provides you with special
processing based on the name of the servlet. The name in the rules.properties file is treated as
a description of the service.
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>
<P><B>Alias Table</B>
</P>

<P>The Java Web Server provides you with an aliasing mechanism to translate the
requested path information into another string. For files, the FileServlet uses the rules
in the alias.properties file to map the shorthand pathname specified in an URL to a full
file pathname. Use aliases as a way to accomplish the following:
</P>

<UL>
<LI>          Eliminate typing long URLs
<LI>          Hide your internal directory structure
<LI>          Temporarily fix broken links when reorganizing directories and moving files
</UL>

<P>An example alias.properties file follows:
</P>

<PRE>
/=public_html
/cgi-bin=cgi-bin
</PRE>

<A NAME="PAGENUM-849"><P>Page 849</P></A>



<PRE>
/admin=admin/html
/doc=doc
/applet=servlets
/icons=icons
/~user=/home/$user/public_html
</PRE>

<P>The string to the left of the = is matched against the requested URL; the longest
match, starting from the left of the requested URL, is used in the translation. The string to
the right of the = is the file name of the file. The last line defines the familiar shorthand for
a user's directory, &quot;~user,&quot; which actually refers to &quot;/home/user/public_html.&quot;
</P>

<P><B>Servlet Control Parameters</B>
</P>

<P>The servlet.properties files contain all the information needed to load and initialize
any named servlet. You can specify three different parameters for each servlet: a
codebase, code class name, and initialization parameters. They take the form of the
following entries, respectively:
</P>

<UL>
<LI>         &lt;servletname&gt;.codebase=URL
<LI>         &lt;servletname&gt;.code=classname
<LI>         &lt;servletname&gt;.initArgs=name/value pairs
</UL>

<P>You need to specify the codebase if the class is not in the current CLASSPATH.
The name/value pairs from initArgs can be accessed by the servlet by calling
the getInitParameter() method to get the value of a specific parameter or
getInitParameters() to get a hashtable of all arguments.
</P>

<P>A special entry, servlets.startup, lists the servlets to be automatically loaded at server
start-up time. An example of a servlet.properties file is as follows:
</P>

<PRE>
servlets.startup= file cgi myservlet error
file.code=sun.server.http.FileServlet
cgi.code=sun.server.http.CgiServlet
error.code=sun.server.http.ErrorServlet
myservlet.code=specialsyservlet.class
myservlet.initArgs=param1=value1, param2=value2,\
param3=value3
</PRE>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
NOTE
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
You use the backslash (\) character to indicate a line continuation.</P>
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>
<P><CENTER>
<a href="0841-0845.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0850-0854.html">Next</A>
</CENTER></P>







</BODY>
</HTML>

