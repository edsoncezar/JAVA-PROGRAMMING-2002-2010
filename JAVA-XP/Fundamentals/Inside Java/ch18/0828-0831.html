<HTML>
<HEAD>


<TITLE>Inside Java:Servlets and the Java Web Server:EarthWeb Inc.-</TITLE>






<P><CENTER>
<a href="0823-0827.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0832-0835.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-828"><P>Page 828</P></A>



<P><B>Table 18.10, Continued</B><BR>
Methods of the HttpServletRequest Class
</P>

<TABLE>

<TR><TD>
Method
</TD><TD>
Description
</TD></TR><TR><TD>
</TD><TD>
fewer than <I>n</I> fields.
</TD></TR><TR><TD>
String getHeaderName(int)
</TD><TD>
Returns the name of the
<I>n</I>th header field or if fewer than <I>n</I> fields.
</TD></TR><TR><TD>
String getHeader(String)
</TD><TD>
Returns the value of a header field.
</TD></TR><TR><TD>
int getIntHeader(String, int)
</TD><TD>
Returns the value of an integer header field
after converting the string to an int. If the field is
not found, it returns the default value.
</TD></TR><TR><TD>
long getDateHeader(String, long)
</TD><TD>
Returns the value of a date header field
after converting the string to a date. If the field is
not found, it returns the default value.
</TD></TR></TABLE>

<P><B>HttpServletResponse Interface Class</B>
</P>

<P>The HttpServletResponse is a subclass of ServletResponse and provides you with
the mechanisms to create an HTTP response header. These mechanisms are used for
the following four purposes:
</P>

<UL>
<LI>          To set the response status
<LI>          To add arbitrary response header fields
<LI>          To create an error response
<LI>          To redirect the request to another URL
</UL>

<P>Creating normal, error, and redirect responses using the HttpServletResponse object
is described in the following sections.
</P>

<P><B>Setting the Response Status</B>
</P>

<P>The HTTP response header includes a status number indicating the success,
redirection, or failure of the request. The return status defaults to 200 or OK. If an error is returned
or OK is not the correct status, the servlet can specify both an error code and
some descriptive text. If only an error code is given, the code is translated into a
standard status text string. The most common response status numbers are the following:
</P>

<TABLE>

<TR><TD>
200
</TD><TD>
Success
</TD></TR></TABLE>

<A NAME="PAGENUM-829"><P>Page 829</P></A>

<TABLE>

<TR><TD>
204
</TD><TD>
No new information
</TD></TR><TR><TD>
300
</TD><TD>
Resource has moved to a new location
</TD></TR><TR><TD>
301
</TD><TD>
Redirect query to new URL
</TD></TR><TR><TD>
304
</TD><TD>
Document has not been modified
</TD></TR><TR><TD>
403
</TD><TD>
Access prohibited
</TD></TR><TR><TD>
404
</TD><TD>
Resource not found
</TD></TR></TABLE>

<P><B>Specifying Non-Standard Header Fields</B>
</P>

<P>Your servlet can add any field to the response header by using one of the
setHeader() methods, enabling you to add non-standard header fields not supported
by HttpServletResponse. Provide the name of the header field (without a colon) as the
first argument and the data as the second argument. Variants of setHeader are defined
for String, int, and Date parameters. Successive calls to set the same header field
overwrite the previous value and do not add multiple copies of the field. For example, calling:
</P>

<PRE>
setHeader(&quot;refresh&quot;, 30);
</PRE>

<P>would add a refresh response header field with a value of 30; this instructs the
browser to automatically reload the page in 30 seconds.
</P>

<P><B>Returning Error Responses</B>
</P>

<P>HttpServletResponse provides two methods to create and send standard error
responses. To return an error, your servlet calls
sendError() with a status code and an optional explanatory message. The page is titled and has a header that indicates
the status code and a standard text message based on the status code. The
optional explanatory message is inserted into the body of the returned page. For example, calling:
</P>

<PRE>
sendError(404, &quot;Couldn't find it!&quot;)
</PRE>

<P>would create a returned page that has a title and H1 header of
&quot;404 Not Found&quot; and &quot;Couldn't find
it!&quot; as the text.
</P>

<P><B>Returning Redirect Response</B>
</P>

<P>HttpServletResponse also provides a method to create and send a standard redirect
response. Calling sendRedirect() creates and sends a
&quot;302&quot; (Moved Temporarily) response. Pass
a string that indicates the new location of the page. The string should be a URL because
it is placed in the returned page as a link. However,
sendRedirect() does not check to see if the string is actually a correctly formatted URL. If you have a URL object already, convert
it
</P>
<A NAME="PAGENUM-830"><P>Page 830</P></A>


<P>
to a string by using toString() before calling
sendRedirect().
</P>

<P>Table 18.11 summarizes the methods associated with the HttpServletResponse class.
</P>

<P><B>Table 18.11</B><BR>
Methods of the HttpServletResponse Class
</P>

<TABLE>

<TR><TD>
Method
</TD><TD>
Description
</TD></TR><TR><TD>
void setStatus(int)
</TD><TD>
Sets the response status code.
</TD></TR><TR><TD>
void setStatus(int, String)
</TD><TD>
Sets the response status code and
explanatory text.
</TD></TR><TR><TD>
void setHeader(String, String)
</TD><TD>
Sets the named header field to the indicated value.
</TD></TR><TR><TD>
void setIntHeader(String, int)
</TD><TD>
Sets the named integer header field after
converting the value to a String.
</TD></TR><TR><TD>
void setDateHeader(String, long)
</TD><TD>
Sets the value of the named date field
after converting the long into an Internet-standard
date-time string.
</TD></TR><TR><TD>
void unsetHeader(String fieldname)
</TD><TD>
Removes the named header field from
the response.
</TD></TR><TR><TD>
void sendError(int)
</TD><TD>
Sends an error response using the specified
status code and standard explanatory message.
</TD></TR><TR><TD>
void sendError(int, String)
</TD><TD>
Sends an error response using the specified
status code and detailed explanatory message.
</TD></TR></TABLE>

<P><B>FormServlet Class</B></P>


<P>The FormServlet class is the only servlet class that is specified as part of the Servlet
API, hence it is available in all Web servers that support servlets. You can build
forms processing servlets by subclassing FormServlet and overriding the
sendResponse() method. The sendResponse() method handles form information and generates a response. When
the sendResponse() method is called, the FormServlet's
service() method has already accomplished the following:
</P>

<UL>
<LI>          Verified the HTTP method as GET or POST
<LI>          Retrieved the form information from either the URL for a GET request or from
the content of the request for a POST
</UL>

<A NAME="PAGENUM-831"><P>Page 831</P></A>


<UL>
<LI>          Stored the form information as a hashtable of name/value pairs
</UL>

<P>The FormServlet class extracts the form information from either the query string for
GET requests, or the content for POST requests, making the differences between GET
and POST invisible to your servlet. An example construction of your own form
processing servlet is provided in the &quot;Handling HTML Forms&quot; section of this chapter.
</P>

<P>Refer to table 18.12 for a summary of methods of the FormServlet class.
</P>

<P><B>Table 18.12</B><BR>
Methods of the FormServlet Class
</P>

<TABLE>

<TR><TD>
Method
</TD><TD>
Description
</TD></TR><TR><TD>
String getServletInfo()
</TD><TD>
Returns a String containing information about
your servlet.
</TD></TR><TR><TD>
void service(HttpServletRequest,
HttpServletResponse)      
</TD><TD>
Override if special request processing
is      required.
</TD></TR><TR><TD>
void sendResponse
(HttpServletResponse, Hashtable)
</TD><TD>
Override this method to supply code 
to process the form and generate a response.
</TD></TR></TABLE>

<P><B>HttpUtils Class</B>
</P>

<P>The HttpUtils class is a set of static utility routines that are useful in building servlets.
In the Alpha 2 release, the only method defined is
parseQueryString(String). This method builds a hashtable of name/value pairs based on parsing a query string. Your servlet can use
the name (as the key) in the Hashtable.get() method to retrieve the value string.
</P>

<H4><A NAME="ch18_ 9">
The java.servlet.html Package
</A></H4>

<P>The third package included with the Servlet API is java.servlet.html. This
package includes thirteen HTML support classes that provide operations for assembling
HTML elements, such as tables, image maps, and forms. From these elements, you can build
an HTML page as a hierarchical list of HTML commands and text elements, and then
write out the completed page to a ServletOutputStream. The classes of this package are
listed in table 18.13.
</P>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
NOTE
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
The HTML generation support provided in the Alpha 2 release is fairly limited.
This package is likely to change significantly for the final release.
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>
<P><CENTER>
<a href="0823-0827.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0832-0835.html">Next</A>
</CENTER></P>







</BODY>
</HTML>

