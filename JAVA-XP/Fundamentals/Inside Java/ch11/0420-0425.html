<HTML>
<HEAD>


<TITLE>Inside Java:Performing Java Input/Output:EarthWeb Inc.-</TITLE>







<P><CENTER>
<a href="0414-0419.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0426-0431.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-420"><P>Page 420</P></A>


<PRE>
InputStream is = new FileInputStream(&quot;testdata.txt&quot;);
if (is.markSupported())
{
      is.mark(3000); // readlimit to 3000 bytes

      // Do processing

      is.reset(); // reset to the mark point

      // Now reread from the marked point

} // end if
</PRE>

<P>After you are done reading the data, you should close the stream to release the
resources associated with reading the stream:
</P>

<PRE>
public void close() throws IOException;
</PRE>

<P>Here is a sample code fragment that illustrates the use of
close():
</P>

<PRE>
InputStream is = new FileInputStream(&quot;testfile.dat&quot;);
byte[] buff = new byte[2048];

try
{

      is.read(buff);
}
catch (IOException e)
{
      System.println(e)
}
finally
{
      is.close();

} // end try
</PRE>

<P>The finally clause will always be executed, whether an exception occurs or not, and
this will close the file.
</P>

<A NAME="PAGENUM-421"><P>Page 421</P></A>



<H4><A NAME="ch11_ 4">
The OutputStream Class
</A></H4>

<P>You have examined the basics of the InputStream class in the previous section. In
this section, you will examine the basics of performing operations on output streams.
</P>

<P>The OutputStream class is an abstract superclass for output streams, and it defines
the basic output methods for all output streams. Because it is an abstract class you
cannot instantiate it. There are several standard subclasses of the OutputStream that you
can use for performing output operations.
</P>

<P>The following is an overview of the methods in the OutputStream class.
</P>
<PRE>
public abstract class OutputStream
{

    // Public methods //
    // (--------------) //

    // This method writes a byte, b, to the output
    // stream. It will block until the byte is
    // actually written.
    public abstract void write(int b)
                    throws IOException;


    // This method writes an array of bytes, b,
    // to the output stream. It will block until
    // the byte is actually written.
    public void write(byte b[]) throws IOException;

    // This method writes a sub array of bytes, b,
    // to the output stream. It will block until
    // the byte is actually written. The sub array
    // is len bytes long and begins at off.
    public void write(byte b[], int off, int len)
                throws IOException;


    // This method flushes the output stream.
    // Flushing the stream will write any buffered
    // output bytes.
</PRE>

<A NAME="PAGENUM-422"><P>Page 422</P></A>


<PRE>
    public void flush() throws IOException;

    // This method closes the stream and releases
    // any resources associated with the stream.
    public void close() throws IOException;


} // end OutputStream
</PRE>

<P>Because the OutputStream is an abstract class, you cannot create direct instances
of InputStream. You can, however, take instances of subclasses of OutputStream.
Consider the following example that writes 100 integers into the output stream.
</P>

<PRE>
OutputStream os = new FileOutputStream(&quot;testfile.dat&quot;);

for(int x = 1; x &lt;= 100; x++)
{

      try
      {
         os.write(x);
      }
      catch (IOException e)
      {
         System.out.println(e);

      } // end try

} // end for
</PRE>

<P>The FileOutputStream class is a subclass of the OutputStream class. This class is
used for performing file output operations. The following line creates an instance of
the FileOutputStream and assigns it to the os object:
</P>
<PRE>
OutputStream os = new FileInputStream(&quot;testfile.dat&quot;);
</PRE>

<P>Within the for loop, a call to the write() method for the output stream writes the byte
value of the integer to the output stream. The
write() method can throw an IOException, so this must be caught or declared in the throws clause of the enclosing method.
</P>


<A NAME="PAGENUM-423"><P>Page 423</P></A>



<P>Listing 11.2 shows a complete program that uses the
read() and write() methods to copy a file.
</P>

<P>Listing 11.2
</P>
<PRE>
Line==================Java Source=================
01 /**
02  * CopyStreams: Illustrates using the input
03  * and output streams. Copies input stream
04  * to output stream.
05  *
06  * Author: Karanjit S. G. S. Siyan
07  *
08  */
09
10 import java.io.*;
11
12 class CopyStreams
13 {
14
15     public static void main(String[] args)
16     {
17
18        InputStream  is = null;
19        OutputStream os = null;
20
21        if (args.length == 2)
22        {
23             try
24             {
25                 is = new FileInputStream(args[0]);
26             }
27             catch (FileNotFoundException e)
28             {
29                 System.out.println(&quot;File &quot;+args[0]+&quot; not found&quot;);
30                 System.exit(0);
31             }
32             catch (IOException e)
33             {
</PRE>
<PRE>
                                                       continues
</PRE>


<A NAME="PAGENUM-424"><P>Page 424</P></A>



<P>Listing 11.2, Continued
</P>

<PRE>
34                 System.out.println(e);
35
36             }  // end try
37
38
39             try
40             {
41                 os = new FileOutputStream(args[1]);
42
43             }
44             catch (IOException e)
45             {
46                 System.out.println(e);
47
48             }  // end try
49
50        }
51        else
52        {
53            System.out.println(&quot;Usage:\n\t&quot;+
54                &quot;java CopyStreams inputfile outputfile&quot;);
55
56        }  // end if
57
58        try
59        {
60            copyStream(is, os);
61        }
62        catch (IOException e)
63        {
64             System.out.println(e);
65
66        }  // end try
67
68     }  // end main
69
70     // Copies is stream to os stream.
71     public static void copyStream(InputStream is,
</PRE>

<A NAME="PAGENUM-425"><P>Page 425</P></A>


<PRE>
72                                   OutputStream os)
73         throws IOException
74     {
75         int count;
76
77         for (count = 0;;count++)
78         {
79             int ch = is.read();
80
81             if (ch == _1)
82             {
83                 break;
84
85             }  // end if
86
87             os.write(ch);
88
89         }  // end for
90
91         System.out.println(&quot;Total bytes copied &quot;+count);
92
93     }  // end copyStream
94
95 } // end CopyStreams
</PRE>

<P>If you want to write the contents of a byte array to an output stream, you can use
the following read method:
</P>

<PRE>
public void write(byte b[])
      throws IOException;
</PRE>

<P>Consider the following code fragment that illustrates the use of this
write() method:
</P>
<PRE>
OutputStream os = new FileOutputStream(&quot;testfile.dat&quot;);
byte[] buff = new byte[2048];

// Code to fill the buff array

try
{
</PRE>


<P><CENTER>
<a href="0414-0419.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0426-0431.html">Next</A>
</CENTER></P>







</BODY>
</HTML>

