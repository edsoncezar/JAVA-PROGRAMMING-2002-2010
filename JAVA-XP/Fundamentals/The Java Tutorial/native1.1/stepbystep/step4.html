


















<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>Step 4: Write the Native Method Implementation</title>
</head>
<body BGCOLOR="#ffffff">










<table width="100%">
<tr>
<td align=left>
<a href="step3.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="step5.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/nativeHeader.gif" width=26 height=26 align=bottom border=0 alt="Java Native Interface | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Compiling and Running a Java Program with a Native Method</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    Step 4: Write the Native Method Implementation
</h2>
<p>
<blockquote>

Now, you can finally write the
implementation for the native method in a language other than Java.


<blockquote>
<hr>
<strong>Note:</strong> Back to that "real world," C and C++ programmers may already have existing implementations of native methods. For those "real" methods, you need only ensure that the native method signature matches the signature generated on the Java side.
<hr>
</blockquote>

<p> The function that you write must have the same function signature
as the one  generated by <code>javah</code> in the
<code>HelloWorld.h</code> file in <a href="step3.html">Step 3: Create
the .h File</a>.  Recall that the function signature generated for the
<code>HelloWorld</code> class's <code>displayHelloWorld</code>
native method looks like this:

<blockquote>
<pre>
JNIEXPORT void JNICALL Java_HelloWorld_displayHelloWorld(JNIEnv *, jobject);
</pre>
</blockquote>

Here's the C language implementation for the native method 
<code>Java_HelloWorld_displayHelloWorld</code>. This implementation is in the file
named <a
href="example-1dot1\helloworldimp.c"><code>HelloWorldImp.c</code></a>.

<blockquote>
<pre>
#include &lt;jni.h&gt;
#include &quot;HelloWorld.h&quot;
#include &lt;stdio.h&gt;

JNIEXPORT void JNICALL 
Java_HelloWorld_displayHelloWorld(JNIEnv *env, jobject obj) 
{
    printf(&quot;Hello world!\n&quot;);
    return;
}
</pre>
</blockquote>

The implementation for <code>Java_HelloWorld_displayHelloWorld</code>
is straightforward.  The function uses the <code>printf</code> function to
display the string "Hello World!" and then returns.

<p>
The <code>HelloWorldImp.c</code> file includes three header files:
<ol>

<li><code>jni.h</code> - This header file provides information that the native
language code requires to interact with the Java runtime system. <strong> When
writing native methods, you must always include this file in your
native language source files.</strong>

<li><code>HelloWorld.h</code> - The <code>.h</code> file that you generated in <a
href="step3.html">Step 3: Create the .h File</a>.

<li><code>stdio.h</code> - The code snippet above includes <code>stdio.h</code>  because
it uses the <code>printf</code> function.  The <code>printf</code> function is part of the <code>stdio.h</code> library.

</ol>

</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="step3.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="step5.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/nativeHeader.gif" width=26 height=26 align=top border=0 alt="Java Native Interface | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Compiling and Running a Java Program with a Native Method</em></strong></a>
</td>
</tr>
</table>
</body>
</html>
