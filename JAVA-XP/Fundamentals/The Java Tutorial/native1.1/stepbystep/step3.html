


















<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>Step 3: Create the .h File</title>
</head>
<body BGCOLOR="#ffffff">










<table width="100%">
<tr>
<td align=left>
<a href="step2.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="step4.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/nativeHeader.gif" width=26 height=26 align=bottom border=0 alt="Java Native Interface | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Compiling and Running a Java Program with a Native Method</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    Step 3: Create the .h File
</h2>
<p>
<blockquote>

In this step, you use the <code>javah</code> utility program to
generate a header file (a <code>.h</code> file) from the
<code>HelloWorld</code> class. The header file provides a C
function signature for the implementation of the native method
<code>displayHelloWorld</code> defined in that class.

<p> <a href=_runjavah.html>Run <code>javah</code></a> now on the
<code>HelloWorld</code> class that you created in the previous steps.
<p>
The name of the header file is the Java class name with a
<code>.h</code> appended to the end. For example, the command
shown above will generate a file named <a
href="http://docs.rinet.ru/Jtuta/native1.1/stepbystep/example-1dot1/HelloWorld.h"><code>HelloWorld.h</code></a>.

<p> By default, <code>javah</code> places the new <code>.h</code> file
in the same directory as the <code>.class</code> file. 
 Use the <code>-d</code> option to instruct 
<code>javah</code> to place the header files in a different directory.


<h4>The Function Definition</h4>
Look at the header file <code>HelloWorld.h</code>.
<blockquote>
<pre>
/* DO NOT EDIT THIS FILE - it is machine generated */
#include &lt;jni.h&gt;
/* Header for class HelloWorld */

#ifndef _Included_HelloWorld
/*
 * Class:     HelloWorld
 * Method:    displayHelloWorld
 * Signature: ()V
 */
JNIEXPORT void JNICALL Java_HelloWorld_displayHelloWorld
  (JNIEnv *, jobject);

</pre>
</blockquote>

The <code>Java_HelloWorld_displayHelloWorld</code> function provides the
implementation for the <code>HelloWorld</code> class's native method
<code>displayHelloWorld</code>, which you will write in <a
href="step4.html">Step 4: Write the Native Method Implementation</a>.
You use the same function signature when you write the implementation
for the native method.

<p> If <code>HelloWorld</code> contained any other native methods,
their function signatures would appear here as well.

<p> The name of the native language function that implements the
native method consists of the prefix <code>Java_</code>, the package
name, the class name, and the name of the native method. Between
each name component is an underscore "_" separator.  Graphically, this looks as follows:


<blockquote><IMG SRC="http://docs.rinet.ru/Jtuta/figures/native1.1/nativehello.gif" WIDTH="479" HEIGHT="177" ALIGN="BOTTOM" NATURALSIZEFLAG="3" ALT=""></blockquote>

<p>
The native method <code>displayHelloWorld</code> within the
<code>HelloWorld</code> class becomes
<code>Java_HelloWorld_displayHelloWorld</code>.  No package name appears in our example because <code>HelloWorld</code> is in the
default package, which has no name.

<p> Notice that the implementation of the native 
function, as it appears in the header file, accepts two parameters even though, in its definition on the
Java side, it accepts no parameters. The JNI requires every native method to have these two parameters. 

<p>
The first parameter for every
native method is a <code>JNIEnv</code> interface pointer. It is
through this pointer that your native code accesses parameters and
objects passed to it from the Java application.  The second parameter is 
<code>jobject</code>, which references the current object
itself.  In a sense, you can
think of the <code>jobject</code> parameter as the "this" variable in
 Java.  For a native instance method, such as the
<code>displayHelloWorld</code> method in our example, the <code>jobject</code> argument is
a reference to the current instance of the object.  For native class methods, this argument
would be a reference to the method's Java class.   Our example ignores both parameters. The next lesson,

<a target="_top" href="..\integrating\index.html">Integrating Java and Native Programs</a><a target="_top" href="..\integrating\index.html"><img src="http://docs.rinet.ru/Jtuta/images/jdk1_1.gif" width=20 height=20 border=0 alt="(in the Using the Java Native Interface (JNI) trail)"></a>
, describes how to access data using the JNI interface pointer
<code>env</code> parameter.  The next lesson also provides more information about <code>jobject</code>.  </blockquote>

</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="step2.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="step4.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/nativeHeader.gif" width=26 height=26 align=top border=0 alt="Java Native Interface | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Compiling and Running a Java Program with a Native Method</em></strong></a>
</td>
</tr>
</table>
</body>
</html>
