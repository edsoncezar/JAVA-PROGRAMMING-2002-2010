


















<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>Code Sample for Inserting a Row</title>
</head>
<body BGCOLOR="#ffffff">










<table width="100%">
<tr>
<td align=left>
<a href="inserting.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="deleting.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/security1_2Header.gif" width=26 height=26 align=bottom border=0 alt="JDBC Database Access | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>New Features in the JDBC 2.0 API</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    Code Sample for Inserting a Row
</h2>
<p>
<blockquote>

The following code sample is a complete program that should run if you have a JDBC 2.0 Compliant driver that implements scrollable result sets. At the time of this writing there are not yet any JDBC 2.0 Compliant drivers, so this code, though it compiles, has not been tested on a driver and DBMS.</P>
<P CLASS="Body">
<A NAME="pgfId=1017453">
 </A>
Here are some things you might notice about the code:</P>
<OL>
<LI CLASS="Numbered-Start1">
<A NAME="pgfId=1017605">
 </A>
The <CODE CLASS="Code">
ResultSet</CODE>
 object <CODE CLASS="Code-Variable1">
uprs</CODE>
 is updatable, scrollable, and sensitive to changes made by itself and others. Even though it is <CODE CLASS="Code">
TYPE_SCROLL_SENSITIVE</CODE>
, it is possible that the <CODE CLASS="Code-Italic">
getXXX</CODE>
 methods called after the insertions will not retrieve values for the newly-inserted rows. There are methods in the <CODE CLASS="Code">
DatabaseMetaData</CODE>
 interface that will tell you what is visible and what is detected in the different types of result sets for your driver and DBMS. These methods are discussed in detail in JDBC Database Access with Java, but they are beyond the scope of this tutorial. In this code sample we wanted to demonstrate cursor movement in the same <CODE CLASS="Code">
ResultSet</CODE>
 object, so after moving to the insert row and inserting two rows, the code moves the cursor back to the result set, going to the position before the first row. This puts the cursor in position to iterate through the entire result set using the method <CODE CLASS="Code">
next</CODE>
 in a while loop. To be absolutely sure that the <CODE CLASS="Code-Italic">
getXXX</CODE>
 methods include the inserted row values no matter what driver and DBMS is used, you can close the result set and create another one, reusing the same <CODE CLASS="Code">
Statement</CODE>
 object <CODE CLASS="Code-Variable1">
stmt</CODE>
 and again using the query <CODE CLASS="Code">
SELECT * FROM COFFEES</CODE>
.</LI>
<LI CLASS="Numbered1">
<A NAME="pgfId=1017616">
 </A>
After all the values for a row have been set with <CODE CLASS="Code-Italic">
updateXXX</CODE>
 methods, the code inserts the row into the result set and the database with the method <CODE CLASS="Code">
insertRow</CODE>
. Then, still staying on the insert row, it sets the values for another row. **reduce to code snip and place rest in APP?**</LI>
</OL>
<blockquote>
<PRE CLASS="Code"><A NAME="pgfId=1017519"> </A>
import java.sql.*;

public class InsertRows {
	public static void main(String args[]) {
		String url = &quot;jdbc:mySubprotocol:myDataSource&quot;;
		Connection con;
		Statement stmt;
	try {
		Class.forName(&quot;myDriver.ClassName&quot;);
	} catch(java.lang.ClassNotFoundException e) {
		System.err.print(&quot;ClassNotFoundException: &quot;); 
		System.err.println(e.getMessage());
	}
	try {
		con = DriverManager.getConnection(url, &quot;myLogin&quot;, &quot;myPassword&quot;);
		stmt = con.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,
					   ResultSet.CONCUR_UPDATABLE);				
		ResultSet uprs = stmt.executeQuery(&quot;SELECT * FROM COFFEES&quot;);
		uprs.moveToInsertRow();
		uprs.updateString(&quot;COF_NAME&quot;, &quot;Kona&quot;);
		uprs.updateInt(&quot;SUP_ID&quot;, 150);
		uprs.updateFloat(&quot;PRICE&quot;, 10.99f);
		uprs.updateInt(&quot;SALES&quot;, 0);
		uprs.updateInt(&quot;TOTAL&quot;, 0);
		uprs.insertRow();
		uprs.updateString(&quot;COF_NAME&quot;, &quot;Kona_Decaf&quot;);
		uprs.updateInt(&quot;SUP_ID&quot;, 150);
		uprs.updateFloat(&quot;PRICE&quot;, 11.99f);
		uprs.updateInt(&quot;SALES&quot;, 0);
		uprs.updateInt(&quot;TOTAL&quot;, 0);
		uprs.insertRow();
		uprs.beforeFirst();
		System.out.println(&quot;Table COFFEES after insertion:&quot;);
		while (uprs.next()) {
			String name = uprs.getString(&quot;COF_NAME&quot;);
			int id = uprs.getInt(&quot;SUP_ID&quot;);
			float price = uprs.getFloat(&quot;PRICE&quot;);
			int sales = uprs.getInt(&quot;SALES&quot;);
			int total = uprs.getInt(&quot;TOTAL&quot;);
			System.out.print(name + &quot;   &quot; + id + &quot;   &quot; + price);
			System.out.println(&quot;   &quot; + sales + &quot;   &quot; + total);
		}

		uprs.close();
		stmt.close();
		con.close();	

	} catch(SQLException ex) {
		System.err.println(&quot;SQLException: &quot; + ex.getMessage());
	}
}
</PRE>
</blockquote>

</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="inserting.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="deleting.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/security1_2Header.gif" width=26 height=26 align=top border=0 alt="JDBC Database Access | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>New Features in the JDBC 2.0 API</em></strong></a>
</td>
</tr>
</table>
</body>
</html>
