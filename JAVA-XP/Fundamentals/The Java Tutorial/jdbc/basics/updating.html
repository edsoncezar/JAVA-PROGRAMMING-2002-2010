


















<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>Updating Tables</title>
</head>
<body BGCOLOR="#ffffff">










<table width="100%">
<tr>
<td align=left>
<a href="retrieving.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="milestone.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/security1_2Header.gif" width=26 height=26 align=bottom border=0 alt="JDBC Database Access | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>JDBC Basics</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    Updating Tables
</h2>
<p>
<blockquote>

Suppose that after a successful first week, the proprietor of The Coffee Break wants to update the <CODE CLASS="Code">
SALES</CODE>
 column in the table <CODE CLASS="Code">
COFFEES</CODE>
 by entering the number of pounds sold for each type of coffee. The SQL statement to update one row might look like this:</P>
<blockquote>
<PRE>
String updateString = &quot;UPDATE COFFEES &quot; +
	&quot;SET SALES = 75 &quot; + 
	&quot;WHERE COF_NAME LIKE 'Colombian'&quot;;
</PRE>
</blockquote>
<P CLASS="Body">
<A NAME="pgfId=998696">
 </A>
Using the <CODE CLASS="Code">
Statement</CODE>
 object <CODE CLASS="Code-Variable1">
stmt</CODE>
, this JDBC code executes the SQL statement contained in <CODE CLASS="Code-Variable1">
updateString</CODE>
:</P>
<blockquote>
<PRE>
stmt.executeUpdate(<CODE CLASS="Code-Variable1">updateString</CODE>);
</PRE>
</blockquote>
<P CLASS="Body">
<A NAME="pgfId=1001341">
 </A>
The table <CODE CLASS="Code">
COFFEES</CODE>
 will now look like this:</P>
<blockquote>
<PRE>
COF_NAME		SUP_ID	PRICE   SALES	TOTAL
--------		------ 	-----	-----   -----
Colombian		101	7.99	75	0
French_Roast		49	8.99	0	0
Espresso		150	9.99	0	0
Colombian_Decaf		101	8.99	0	0
French_Roast_Decaf	49	9.99	0	0
</PRE>
</blockquote>
<P CLASS="Body">
<A NAME="pgfId=1001319">
 </A>
Note that we have not yet updated the column <CODE CLASS="Code">
TOTAL</CODE>
, so it still has the value <CODE CLASS="Code">
0</CODE>
.</P>
<P CLASS="Body">
<A NAME="pgfId=1003912">
 </A>
Now let's select the row we updated, retrieve the values in the columns <CODE CLASS="Code">
COF_NAME</CODE>
 and <CODE CLASS="Code">
SALES</CODE>
, and print out those values:</P>
<blockquote>
<PRE>
String query = &quot;SELECT COF_NAME, SALES FROM COFFEES &quot; +
	       &quot;WHERE COF_NAME LIKE 'Colombian'&quot;;
ResultSet rs = stmt.executeQuery(query);
while (rs.next()) {
		String s = rs.getString(&quot;COF_NAME&quot;);
		int n = rs.getInt(&quot;SALES&quot;);
		System.out.println(n + &quot; pounds of &quot; + s +
 						  &quot; sold this week.&quot;);
}
</PRE>
</blockquote>
<P CLASS="Body">
<A NAME="pgfId=1001407">
 </A>
This will print the following:</P>
<blockquote>
<PRE>
75 pounds of Colombian sold this week.
</PRE>
</blockquote>
<P CLASS="Body">
<A NAME="pgfId=1001423">
 </A>
Since the <CODE CLASS="Code">
WHERE</CODE>
 clause limited the selection to only one row, there was just one row in the <CODE CLASS="Code">
ResultSet</CODE>
 <CODE CLASS="Code-Variable1">
rs</CODE>
 and one line printed as output. Accordingly, it is possible to write the code without a <CODE CLASS="Code">
while</CODE>
 loop:</P>
<blockquote>
<PRE>
rs.next();
String s = rs.getString(1);
int n = rs.getInt(2);
System.out.println(n + &quot; pounds of &quot; + s + &quot; sold this week.&quot;);
</PRE>
</blockquote>
<P CLASS="Body">
<A NAME="pgfId=1001430">
 </A>
Even when there is only one row in a result set, you need to use the method <CODE CLASS="Code">
next</CODE>
 to access it. A <CODE CLASS="Code">
ResultSet</CODE>
 object is created with a cursor pointing above the first row. The first call to the <CODE CLASS="Code">
next</CODE>
 method positions the cursor on the first (and in this case, only) row of <CODE CLASS="Code-Variable1">
rs</CODE>
. In this code, <CODE CLASS="Code">
next</CODE>
 is called only once, so if there happened to be another row, it would never be accessed. </P>
<P CLASS="Body">
<A NAME="pgfId=1003921">
 </A>
Now let's update the <CODE CLASS="Code">
TOTAL</CODE>
 column by adding the weekly amount sold to the existing total, and then let's print out the number of pounds sold to date:</P>
<blockquote>
<PRE>
String updateString = &quot;UPDATE COFFEES &quot; +
		      &quot;SET TOTAL = TOTAL + 75 &quot; + 
		      &quot;WHERE COF_NAME LIKE 'Colombian'&quot;;
stmt.executeUpdate(updateString);
String query = &quot;SELECT COF_NAME, TOTAL FROM COFFEES &quot; +
				   &quot;WHERE COF_NAME LIKE 'Colombian'&quot;;
ResultSet rs = stmt.executeQuery(query);
while (rs.next()) {
		String s = rs.getString(1);
		int n = rs.getInt(2);
		System.out.println(n + &quot; pounds of &quot; + s + &quot; sold to date.&quot;);
}
</PRE>
</blockquote>
<P CLASS="Body">
<A NAME="pgfId=1008159">
 </A>
Note that in this example, we used the column index instead of the column name, supplying the index <CODE CLASS="Code">
1</CODE>
 to <CODE CLASS="Code">
getString</CODE>
 (the first column of the result set is <CODE CLASS="Code">
COF_NAME</CODE>
), and the index <CODE CLASS="Code">
2</CODE>
 to <CODE CLASS="Code">
getInt</CODE>
 (the second column of the result set is <CODE CLASS="Code">
TOTAL</CODE>
). It is important to distinguish between a column's index in the database table as opposed to its index in the result set table. For example, <CODE CLASS="Code">
TOTAL</CODE>
 is the fifth column in the table <CODE CLASS="Code">
COFFEES</CODE>
 but the second column in the result set generated by the query in the example above.</P>

</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="retrieving.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="milestone.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/security1_2Header.gif" width=26 height=26 align=top border=0 alt="JDBC Database Access | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>JDBC Basics</em></strong></a>
</td>
</tr>
</table>
</body>
</html>
