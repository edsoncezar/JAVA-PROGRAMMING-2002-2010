


















<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>SQL Statements for Creating a Stored Procedure</title>
</head>
<body BGCOLOR="#ffffff">










<table width="100%">
<tr>
<td align=left>
<a href="storedprocedures.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="complete.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/security1_2Header.gif" width=26 height=26 align=bottom border=0 alt="JDBC Database Access | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>JDBC Basics</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    SQL Statements for Creating a Stored Procedure
</h2>
<p>
<blockquote>

This section looks at a very simple stored procedure that has no parameters. Even though most stored procedures do something more complex than this example, it serves to illustrate some basic points about them. As previously stated, the syntax for defining a stored procedure is different for each DBMS. For example, some use <CODE CLASS="Code">
begin . . . end</CODE>
 or other keywords to indicate the beginning and ending of the procedure definition. In some DBMSs, the following SQL statement creates a stored procedure:</P>
<blockquote>
<PRE>
create procedure SHOW_SUPPLIERS
as
select SUPPLIERS.SUP_NAME, COFFEES.COF_NAME
from SUPPLIERS, COFFEES
where SUPPLIERS.SUP_ID = COFFEES.SUP_ID
order by SUP_NAME
</PRE>
</blockquote>
<P CLASS="Body">
<A NAME="pgfId=1001774">
 </A>
The following code puts the SQL statement into a string and assigns it to the variable <CODE CLASS="Code-Variable1">
createProcedure</CODE>
, which we will use later:</P>
<blockquote>
<PRE>
String createProcedure = &quot;create procedure SHOW_SUPPLIERS &quot; +
				&quot;as &quot; +
				&quot;select SUPPLIERS.SUP_NAME, COFFEES.COF_NAME &quot; +
				&quot;from SUPPLIERS, COFFEES &quot; +
				&quot;where SUPPLIERS.SUP_ID = COFFEES.SUP_ID &quot; +
				&quot;order by SUP_NAME&quot;;
</PRE>
</blockquote>
<P CLASS="Body">
<A NAME="pgfId=1005758">
 </A>
The following code fragment uses the <CODE CLASS="Code">
Connection</CODE>
 object <CODE CLASS="Code-Variable1">
con</CODE>
 to create a <CODE CLASS="Code">
Statement</CODE>
 object, which is used to send the SQL statement creating the stored procedure to the database:</P>
<blockquote>
<PRE>
Statement stmt = con.createStatement();
stmt.executeUpdate(createProcedure);
</PRE>
</blockquote>
<P CLASS="Body">
<A NAME="pgfId=1005756">
 </A>
The procedure <CODE CLASS="Code">
SHOW_SUPPLIERS</CODE>
 will be compiled and stored in the database as a database object that can be called, similar to the way you would call a method. </P>
<DIV>
<h4 CLASS="C-Head">
<A NAME="pgfId=1001702">
 </A>
Calling a Stored Procedure from JDBC</h4>
<blockquote>
<P CLASS="Body">
<A NAME="pgfId=1005412">
 </A>
JDBC allows you to call a database stored procedure from an application written in the Java programming language. The first step is to create a <CODE CLASS="Code">
CallableStatement</CODE>
 object. As with <CODE CLASS="Code">
Statement</CODE>
 and <CODE CLASS="Code">
PreparedStatement</CODE>
 objects, this is done with an open <CODE CLASS="Code">
Connection</CODE>
 object. A <CODE CLASS="Code">
CallableStatement</CODE>
 object contains a call to a stored procedure; it does not contain the stored procedure itself. The first line of code below creates a call to the stored procedure <CODE CLASS="Code">
SHOW_SUPPLIERS</CODE>
 using the connection <CODE CLASS="Code-Variable1">
con</CODE>
. The part that is enclosed in curly braces is the escape syntax for stored procedures. When the driver encounters <CODE CLASS="Code">
&quot;{call SHOW_SUPPLIERS}&quot;</CODE>
, it will translate this escape syntax into the native SQL used by the database to call the stored procedure named <CODE CLASS="Code">
SHOW_SUPPLIERS</CODE>
. </P>
<blockquote>
<PRE CLASS="Code"><A NAME="pgfId=1001817"> </A>
CallableStatement cs = con.prepareCall(&quot;{call SHOW_SUPPLIERS}&quot;);
ResultSet rs = cs.executeQuery();
</PRE>
</blockquote>
<P CLASS="Body">
<A NAME="pgfId=1011565">
 </A>
The <CODE CLASS="Code">
ResultSet</CODE>
 <CODE CLASS="Code-Variable1">
rs</CODE>
 will be similar to the following:</P>
<blockquote>
<PRE>
SUP_NAME			COF_NAME
----------------		-----------------------
Acme, Inc.			Colombian
Acme, Inc.			Colombian_Decaf
Superior Coffee			French_Roast
Superior Coffee			French_Roast_Decaf
The High Ground			Espresso
</PRE>
</blockquote>
<P CLASS="Body">
<A NAME="pgfId=1003273">
 </A>
Note that the method used to execute <CODE CLASS="Code-Variable1">
cs</CODE>
 is <CODE CLASS="Code">
executeQuery</CODE>
 because <CODE CLASS="Code-Variable1">
cs</CODE>
 calls a stored procedure that contains one query and thus produces one result set. If the procedure had contained one update or one DDL statement, the method <CODE CLASS="Code">
executeUpdate</CODE>
 would have been the one to use. It is sometimes the case, however, that a stored procedure contains more than one SQL statement, in which case it will produce more than one result set, more than one update count, or some combination of result sets and update counts. In this case, where there are multiple results, the method <CODE CLASS="Code">
execute</CODE>
 should be used to execute the <CODE CLASS="Code">
CallableStatement</CODE>
. </P>
<P CLASS="Body">
<A NAME="pgfId=1005963">
 </A>
The class <CODE CLASS="Code">
CallableStatement</CODE>
 is a subclass of <CODE CLASS="Code">
PreparedStatement</CODE>
, so a <CODE CLASS="Code">
CallableStatement</CODE>
 object can take input parameters just as a <CODE CLASS="Code">
PreparedStatement</CODE>
 object can. In addition, a <CODE CLASS="Code">
CallableStatement</CODE>
 object can take output parameters or parameters that are for both input and output. INOUT parameters and the method <CODE CLASS="Code">
execute</CODE>
 are used rarely. For complete information, refer to JDBC Database Access with Java.</P>
</blockquote>

</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="storedprocedures.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="complete.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/security1_2Header.gif" width=26 height=26 align=top border=0 alt="JDBC Database Access | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>JDBC Basics</em></strong></a>
</td>
</tr>
</table>
</body>
</html>
