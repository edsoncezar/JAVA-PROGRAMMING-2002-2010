




















<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>How to Use Threads</title>
</head>
<body BGCOLOR="#ffffff">










<table width="100%">
<tr>
<td align=left>
<a href="plaf.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="timer.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/uiHeader.gif" width=26 height=26 align=bottom border=0 alt="Creating a GUI with JFC/Swing | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Using Other Swing Features</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    How to Use Threads
</h2>
<p>
<blockquote>

[PENDING: introduce.
This page needs a bit more glue and perhaps a reorg.]
This page gives you some examples of using the
thread-related Swing API. 
For conceptual information, see
<a target="_top" href="..\overview\threads.html">Threads and Swing</a><a target="_top" href="..\overview\threads.html"><img src="http://docs.rinet.ru/Jtuta/images/uiIcon.gif" width=20 height=20 border=0 alt="(in the Creating a User Interface trail)"></a>.
For more examples, see the <A
HREF="..\..\together\index.html">BINGO example</A>,
especially the following classes:
<CODE><A HREF="http://docs.rinet.ru/Jtuta/together/bingo/example-swing/bingo/player/CardWindow.java">CardWindow</A></CODE>,
<CODE><A HREF="http://docs.rinet.ru/Jtuta/together/bingo/example-swing/bingo/player/ControlPane.java">ControlPane</A></CODE>,
<CODE><A HREF="http://docs.rinet.ru/Jtuta/together/bingo/example-swing/bingo/player/Player.java">Player</A></CODE>,
and <CODE><A HREF="http://docs.rinet.ru/Jtuta/together/bingo/example-swing/bingo/shared/OverallStatusPane.java">OverallStatusPane</A></CODE>.</P>

<H4><A NAME="invokeLater"></A>Using the <CODE>invokeLater</CODE> Method</H4>
<blockquote>

<P>You can call <CODE>invokeLater</CODE> from any thread to request the
event-dispatching thread to run certain code. You must put this code in
the <CODE>run</CODE> method of a <CODE>Runnable</CODE> object and specify
the <CODE>Runnable</CODE> object as the argument to <CODE>invokeLater</CODE>.
The <CODE>invokeLater</CODE> method returns immediately, without waiting
for the event-dispatching thread to execute the code. Here's an example
of using <CODE>invokeLater</CODE>:</P>

<BLOCKQUOTE>
  <PRE>
Runnable doWorkRunnable = new Runnable() {
    public void run() { doWork(); }
};
SwingUtilities.invokeLater(doWorkRunnable);</PRE>
</BLOCKQUOTE>

</blockquote>
<H4><A NAME="invokeAndWait"></A>Using the <CODE>invokeAndWait</CODE> Method</H4>
<blockquote>

<P>The <CODE>invokeAndWait</CODE> method is just like <CODE>invokeLater</CODE>,
except that <CODE>invokeAndWait</CODE> doesn't return until the event-dispatching
thread has executed the specified code. Whenever possible, you should use
<CODE>invokeLater</CODE> instead of <CODE>invokeAndWait</CODE>. If you
use <CODE>invokeAndWait</CODE>, make sure that the thread that calls <CODE>invokeAndWait</CODE>
does not hold any locks that other threads might need while the call is
occurring.</P>

<P>Here's an example of using <CODE>invokeAndWait</CODE>:</P>

<BLOCKQUOTE>
<PRE>void showHelloThereDialog() throws Exception {
    Runnable showModalDialog = new Runnable() {
        public void run() {
            JOptionPane.showMessageDialog(myMainFrame,
	                                  &quot;Hello There&quot;);
        }
    };
    SwingUtilities.invokeAndWait(showModalDialog);
}</PRE>
</BLOCKQUOTE>

<P>Similarly, a thread that needs access to GUI state, such as the contents
of a pair of text fields, might have the following code:</P>

<BLOCKQUOTE>
<PRE>void printTextField() throws Exception {
    final String[] myStrings = new String[2];

    Runnable getTextFieldText = new Runnable() {
        public void run() {
            myStrings[0] = textField0.getText();
            myStrings[1] = textField1.getText();
        }
    };
    SwingUtilities.invokeAndWait(getTextFieldText);

    System.out.println(myStrings[0] + &quot; &quot; + myStrings[1]);
}</PRE>
</BLOCKQUOTE>

</blockquote>
<A NAME="threadHelp">
<H4>How to Create Threads</H4>
</A>
<blockquote>

<P>If you can get away with it, avoid using threads. Threads can be difficult
to use, and they make programs harder to debug. In general, they just aren't
necessary for strictly GUI work, such as updating component properties.</P>

<P>However, sometimes threads <EM>are</EM> necessary. Here are some typical
situations where threads are used:</P>

<UL>
  <LI>To perform a time-consuming task without locking up the event-dispatching
  thread. Examples include making extensive calculations, doing something
  that results in many classes being loaded (initialization, for example),
  and blocking for network or disk I/O. <BR>
  <BR>
  
  <LI>To perform an operation repeatedly, usually with some predetermined
  period of time between operations.<BR>
  <BR>
  
  <LI>To wait for messages from clients.
</UL>

<P>You can use two classes to help you implement threads:</P>

<UL>
  <LI><A HREF="#SwingWorker"><STRONG><CODE>SwingWorker</CODE></STRONG></A>:
  Creates a background thread to execute time-consuming operations.<BR>
  <BR>
  
  <LI><A HREF="timer.html"><STRONG><CODE>Timer</CODE></STRONG></A>: Creates a
  thread that executes some code one or more times, with a user-specified
  delay between executions. For detailed information about timers,
  see <a href="timer.html">How to Use Timers</a>.
</UL>

</blockquote>
<H4><A NAME="SwingWorker"></A>Using the <CODE>SwingWorker</CODE> Class</H3>
<blockquote>

<blockquote>
<hr>
<strong>Note</strong>:
The tutorial's implementation of the
<a href="http://docs.rinet.ru/Jtuta/uiswing/misc/example-swing/SwingWorker.java"><code>SwingWorker</code></a>
class was updated in the January 1999 release of the tutorial; the class
has been enhanced to allow programs to safely interrupt the thread.
If you are using <code>SwingWorker</code> in any of
your programs, make sure you are using this version!
<hr>
</blockquote>

The <CODE>SwingWorker</CODE> class is implemented
in <CODE><A HREF="http://docs.rinet.ru/Jtuta/uiswing/misc/example-swing/SwingWorker.java">SwingWorker.java</A></CODE>,
which is <EM>not</EM> in the Swing release. <CODE>SwingWorker</CODE> does
all the dirty work of implementing a background thread. Although many programs
don't need background threads, background threads are sometimes useful for
performing time-consuming operations, which can improve the perceived performance
of a program.</P>

<P>To use the <CODE>SwingWorker</CODE> class, you first create a subclass
of it. In the subclass, you must implement the <CODE>construct</CODE> method
so that it contains the code to perform your lengthy operation. When you
instantiate your <CODE>SwingWorker</CODE> subclass, the <CODE>SwingWorker</CODE>
creates a thread that calls your <CODE>construct</CODE> method. When you
need the object returned by the <CODE>construct</CODE> method, you call
the <CODE>SwingWorker</CODE>'s <CODE>get</CODE> method. Here's an example
of using <CODE>SwingWorker</CODE>:</P>

<BLOCKQUOTE>
  <PRE><EM>...//in the main method:</EM>
    final SwingWorker worker = new SwingWorker() {
        public Object construct() {
            return new ExpensiveDialogComponent();
        }
    };

<EM>...//in an action event handler:</EM>
    JOptionPane.showMessageDialog
        (f, worker.get());</PRE>
</BLOCKQUOTE>

<P>When the program's <CODE>main</CODE> method creates the <CODE>SwingWorker</CODE>
object, the <CODE>SwingWorker</CODE> immediately starts a new thread that
instantiates <CODE>ExpensiveDialogComponent</CODE>. The <CODE>main</CODE>
method also constructs a GUI that consists of a window with a button.</P>

<p>
When the user clicks the button, the program
blocks, if necessary, until the <CODE>ExpensiveDialogComponent</CODE> has
been created. The program then shows a modal dialog containing the <CODE>ExpensiveDialogComponent</CODE>.
You can find the entire program in <CODE><A HREF="http://docs.rinet.ru/Jtuta/uiswing/misc/example-swing/PasswordDemo.java">PasswordDemo.java</A></CODE>.
Also, the example program provided in
<a href="..\components\progress.html">How to Monitor Progress</a> runs a long task
in a <code>SwingWorker</code> thread.
</P>

<blockquote>
<hr>
This section is based on an article in
<a href="http://java.sun.com/products/jfc/tsc/">The Swing Connection</a>.
For more information about Swing thread issues, see the article:
<a href="http://java.sun.com/products/jfc/tsc/swingdoc-archive/threads.html">Threads and Swing</a>
and
<a href="http://java.sun.com/products/jfc/tsc/archive/tech_topics_arch/swing_worker/swing_worker.html">Using a SwingWorker Thread</a>.
<hr>
</blockquote>

</blockquote>

</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="plaf.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="timer.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/uiHeader.gif" width=26 height=26 align=top border=0 alt="Creating a GUI with JFC/Swing | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Using Other Swing Features</em></strong></a>
</td>
</tr>
</table>
</body>
</html>
