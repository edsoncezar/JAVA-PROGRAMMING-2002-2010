




















<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>How to Write a List Selection Listener</title>
</head>
<body BGCOLOR="#ffffff">










<table width="100%">
<tr>
<td align=left>
<a href="keylistener.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="mouselistener.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/uiHeader.gif" width=26 height=26 align=bottom border=0 alt="Creating a GUI with JFC/Swing | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Writing Event Listeners</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    How to Write a List Selection Listener
</h2>
<p>
<blockquote>

List selection events 
occur when the selection in a 
<a target="_top" href="..\components\list.html">list</a><a target="_top" href="..\components\list.html"><img src="http://docs.rinet.ru/Jtuta/images/uiIcon.gif" width=20 height=20 border=0 alt="(in the Creating a User Interface trail)"></a> or
<a target="_top" href="..\components\table.html">table</a><a target="_top" href="..\components\table.html"><img src="http://docs.rinet.ru/Jtuta/images/uiIcon.gif" width=20 height=20 border=0 alt="(in the Creating a User Interface trail)"></a> is either changing or has just changed.
List selection events are fired from an object
that implements the
<a target="_top" href="http://java.sun.com/products/jfc/swingdoc-api/javax/swing/ListSelectionModel.html"><code>ListSelectionModel</code></a><a target="_top" href="http://java.sun.com/products/jfc/swingdoc-api/javax/swing/ListSelectionModel.html"><img src="http://docs.rinet.ru/Jtuta/images/apiIcon.gif" width=20 height=20 border=0 alt="(in the API reference documentation)"></a> interface.
To get a list or table's list selection model object,
use the <code>getSelectionModel</code> method.

<p>

To detect list selection events,
you register a listener
on the appropriate list selection model object.
The <code>JList</code> class also gives you the option of
registering a listener 
on the list itself,
rather than directly on the list selection model.

<h4>List Selection Event Methods</h4>
<blockquote>
The <code>ListSelectionListener</code> interface has just one method,
so it has no corresponding adapter class.
Here's the method: 
<dl>
<dt> <strong><code>void valueChanged(ListSelectionEvent)</code></strong>
<dd> Called when the selection in the listened-to component
     is changing, as well as just after the selection has changed.
</dl>
</blockquote>

<a name="eg">
<h4>Examples of Handling List Selection Events</h4>
</a>
<blockquote>
The
<a target="_top" href="..\components\list.html">How to Use Lists</a><a target="_top" href="..\components\list.html"><img src="http://docs.rinet.ru/Jtuta/images/uiIcon.gif" width=20 height=20 border=0 alt="(in the Creating a User Interface trail)"></a> section
provides an example of a listener that listens to events
on a single-selection list (not the list's selection model).
<p>
This section provides one example
that shows how to listen to list selection events
on a selection model.
The selection model is shared by a list and a table.
You can dynamically change the selection mode
to any of the three supported modes:

<ul>
<li> single selection mode
<li> single interval selection mode
<li> multiple interval selection mode
</ul>

<p>

Here's a picture of the example running:

<blockquote><IMG SRC="http://docs.rinet.ru/Jtuta/figures/uiswing/events/ListSelectionDemo.gif" WIDTH="463" HEIGHT="284" ALIGN="BOTTOM" NATURALSIZEFLAG="3" ALT=""></blockquote>
<p>
<blockquote>
<hr>
<strong>Try this:</strong>
<ol>
<li> Compile and run the application.
     The main source file is
     <a href="http://docs.rinet.ru/Jtuta/uiswing/events/example-swing/ListSelectionDemo.java">
     <code>ListSelectionDemo.java</code></a>.
     <br>
     See <a href="..\start\index.html">Getting Started with Swing</a> if you need help.

<li> Select and deselect items in the list and table.
     The mouse and keyboard commands required to select items
     depends on the look and feel.
     For Metal, click the left mouse button to begin a selection,
     use the shift key to extend a selection contiguously, and
     use the control key to extend a selection discontiguously.
     Dragging the mouse moves or extends the selection,
     depending on the list selection mode.
     
</ol>
<hr>
</blockquote>

Here's the code from <code>ListSelectionDemo.java</code> that
sets up the selection model and adds a listener to it:
<blockquote>
<pre>
<em>...//where the member variables are defined</em>
JList list;
JTable table;
    <em>...//in the init method:</em>
    listSelectionModel = list.getSelectionModel();
    listSelectionModel.addListSelectionListener(
                            new SharedListSelectionHandler());
    ...
    table.setSelectionModel(listSelectionModel);
</pre>
</blockquote>
And here's the code for the listener,
which works for all the possible selection modes:
<blockquote>
<pre>
class SharedListSelectionHandler implements ListSelectionListener {
    public void valueChanged(ListSelectionEvent e) {
        ListSelectionModel lsm = (ListSelectionModel)e.getSource();

        int firstIndex = e.getFirstIndex();
        int lastIndex = e.getLastIndex();
        boolean isAdjusting = e.getValueIsAdjusting();
        output.append("Event for indexes "
                      + firstIndex + " - " + lastIndex
                      + "; isAdjusting is " + isAdjusting
                      + "; selected indexes:");

        if (lsm.isSelectionEmpty()) {
            output.append(" &lt;none&gt;");
        } else {
            // Find out which indexes are selected.
            int minIndex = lsm.getMinSelectionIndex();
            int maxIndex = lsm.getMaxSelectionIndex();
            for (int i = minIndex; i <= maxIndex; i++) {
                if (lsm.isSelectedIndex(i)) {
                    output.append(" " + i);
                }
            }
        }
        output.append(newline);
    }
}

</pre>
</blockquote>
This <code>valueChanged</code> method displays the
first and last indices reported by the event,
the value of the event's <code>isAdjusting</code> flag,
and the indices currently selected.
<P>
Note that the first and last indices reported by the event 
indicate the inclusive range of items
for which the selection has changed.
If the selection mode is multiple interval selection
some items within the range might not have changed.
The <code>isAdjusting</code> flag is <code>true</code> if
the user is still manipulating the selection,
and <code>false</code> if the user has finished changing the selection.
<p>
The <code>ListSelectionEvent</code> object
passed into <code>valueChanged</code> indicates
only that the selection has changed.
The event contains no information about the current selection.
So, this method queries the selection model to
figure out the current selection.
 
<blockquote>
<hr>
<strong>Note</strong>:
The output from this program depends on the version of Swing you are using.
Swing 1.0.x contains several bugs and
the operation of lists and tables were inconsistent.
Later versions of Swing fix these problems.
<hr>
</blockquote>

</blockquote>

<h4>The ListSelectionEvent Class</h4>
<blockquote>
Each list selection event method has a single parameter: a
<a target="_top" href="http://java.sun.com/products/jfc/swingdoc-api/javax/swing/event/ListSelectionEvent.html"><code>ListSelectionEvent</code></a><a target="_top" href="http://java.sun.com/products/jfc/swingdoc-api/javax/swing/event/ListSelectionEvent.html"><img src="http://docs.rinet.ru/Jtuta/images/apiIcon.gif" width=20 height=20 border=0 alt="(in the API reference documentation)"></a> object.
The event object tells the listener that the selection changed.
One list selection event can indicate a change in selection
on multiple, discontiguous items in the list.

<p>

To get the source of a <code>ListSelectionEvent</code>,
use the <code>getSource</code> method,
which <code>ListSelectionEvent</code> inherits from
<a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.util.EventObject.html"><code>EventObject</code></a><a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.util.EventObject.html"><img src="http://docs.rinet.ru/Jtuta/images/apiIcon.gif" width=20 height=20 border=0 alt="(in the API reference documentation)"></a>.
If you register a list selection listener
on a list directly,
then the source for each event 
is the list.
Otherwise, the source is the selection model.

<p>

The <code>ListSelectionEvent</code> class defines the following handy methods: 
<dl>
<dt><strong><code>int getFirstIndex()</code></strong>
<dd> Returns the index of the first item
     whose selection value has changed.
     Note that for multiple interval selection,
     the first and last items are guaranteed to have changed but
     items between them might not have.

<dt><strong><code>int getLastIndex()</code></strong>
<dd> Returns the index of the last item
     whose selection value has changed.
     Note that for multiple interval selection,
     the first and last items are guaranteed to have changed but
     items between them might not have.

<dt><strong><code>int getValueIsAdjusting()</code></strong>
<dd> Returns <code>true</code> if the selection is still changing.
     Many list selection listeners are interested only in
     the final state of the selection and can ignore list selection
     events when this method returns <code>true</code>.
</dl>

</blockquote>

</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="keylistener.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="mouselistener.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/uiHeader.gif" width=26 height=26 align=top border=0 alt="Creating a GUI with JFC/Swing | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Writing Event Listeners</em></strong></a>
</td>
</tr>
</table>
</body>
</html>
