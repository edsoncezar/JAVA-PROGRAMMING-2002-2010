




















<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>How to Write a Window Listener</title>
</head>
<body BGCOLOR="#ffffff">










<table width="100%">
<tr>
<td align=left>
<a href="undoableeditlistener.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="..\painting\index.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/uiHeader.gif" width=26 height=26 align=bottom border=0 alt="Creating a GUI with JFC/Swing | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Writing Event Listeners</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    How to Write a Window Listener
</h2>
<p>
<blockquote>

Window events are generated
by a <code>Window</code> 
just after the window is opened, closed,
iconified, deiconified,
activated, or deactivated.
<em>Opening</em> a window means
showing it for the first time;
<em>closing</em> it means removing the window from the screen.
<em>Iconifying</em> it means substituting
a small icon on the desktop for the window;
<em>deiconifying</em> means the opposite.
A window is <em>activated</em> 
if it or a component it contains
has the keyboard focus;
<em>deactivation</em> occurs
when the window and all of its contents
lose the keyboard focus.
<p>

[PENDING: smooth this out for Swing]
The most common use of window listeners is closing windows.
If a program doesn't handle window-closing events,
then nothing happens when the user attempts to close a window.
An application that features a single window
might react to window-closing events from that window by exiting.
Other programs usually react to window-closing events
by disposing of the window
or making it invisible.
See
<a target="_top" href="..\components\frame.html">How to Make Frames</a><a target="_top" href="..\components\frame.html"><img src="http://docs.rinet.ru/Jtuta/images/uiIcon.gif" width=20 height=20 border=0 alt="(in the Creating a User Interface trail)"></a> for an example of a handler for window-closing events.

     <blockquote>
     <hr>
     <strong>Note:</strong>
     If you're using 
     the Swing <code>JFrame</code> class,
     you might not need to write a window listener.
     See 
<a target="_top" href="..\components\frame.html">How to Make Frames</a><a target="_top" href="..\components\frame.html"><img src="http://docs.rinet.ru/Jtuta/images/uiIcon.gif" width=20 height=20 border=0 alt="(in the Creating a User Interface trail)"></a>     for information on how the <code>JFrame</code> class
     provides automatic handling of window-closing events.
     <hr>
     </blockquote>

<p>

Another common use of window listeners
is to stop threads and release resources
when a window is iconified,
and to start up again when the window is deiconified.
This way, you can avoid unnecessarily
using the processor or other resources.
For example,
when a window that contains animation is iconified,
it should stop its animation thread
and free any large buffers.
When the window is deiconified,
it can start the thread again
and recreate the buffers.

<p>

[PENDING: really? Not in book]
If you want to be notified when a window
is made visible or hidden,
then you should register a
<a href="componentlistener.html">component listener</a>
on the window.

<h4>Window Event Methods</h4>
<blockquote>

The
<a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.awt.event.WindowListener.html"><code>WindowListener</code></a><a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.awt.event.WindowListener.html"><img src="http://docs.rinet.ru/Jtuta/images/apiIcon.gif" width=20 height=20 border=0 alt="(in the API reference documentation)"></a> interface 
and its corresponding adapter class, 
<a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.awt.event.WindowAdapter.html"><code>WindowAdapter</code></a><a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.awt.event.WindowAdapter.html"><img src="http://docs.rinet.ru/Jtuta/images/apiIcon.gif" width=20 height=20 border=0 alt="(in the API reference documentation)"></a>, contain these methods:

<p>
<dl>
<dt> <strong><code>void windowOpened(WindowEvent)</code></strong>
<dd> Called
     just after the listened-to window has been shown for the first time.

<p>
<dt> <strong><code>void windowClosing(WindowEvent)</code></strong>
<dd> Called
     in response to a user request that the listened-to window be closed.
     To actually close the window, 
     the listener should invoke
     the window's <code>dispose</code> or 
     <code>setVisible(false)</code> method.

<p>
<dt> <strong><code>void windowClosed(WindowEvent)</code></strong>
<dd> Called
     just after the listened-to window has closed.

<p>
<dt> <strong><code>void windowIconified(WindowEvent)</code></strong>
     <br>
     <strong><code>void windowDeiconified(WindowEvent)</code></strong>
<dd> Called
     just after the listened-to window
     is iconified or deiconified, respectively.

<p>
<dt> <strong><code>void windowActivated(WindowEvent)</code></strong>
     <br>
     <strong><code>void windowDeactivated(WindowEvent)</code></strong>
<dd> Called
     just after the listened-to window
     is activated or deactivated, respectively.
</dl>

</blockquote>
<h4>Examples of Handling Window Events</h4>
<blockquote>

The following applet demonstrates window events.
By clicking the top button in the applet,
you can bring up a small window.
The controlling class listens for window events from the window,
displaying a message whenever it detects a window event.
You can find the applet's code 
in <a href="http://docs.rinet.ru/Jtuta/uiswing/events/example-swing/WindowEventDemo.java">
<code>WindowEventDemo.java</code></a>.

<p>

<blockquote><a href="windoweventdemo.html" target="_blank"><IMG SRC="http://docs.rinet.ru/Jtuta/figures/uiswing/events/WindowEventDemo.gif" WIDTH="400" HEIGHT="200" ALIGN="BOTTOM" NATURALSIZEFLAG="3" ALT="Click this figure to run the applet."></a><br><em>This is a picture of the applet's GUI.  To run the applet, click the picture.  The applet will appear in a new browser window.</em></blockquote>
<p>

<blockquote>
<hr>
<strong>Try this:</strong>
<ol>
<li> <strong>Bring up the Window Demo Window
     by clicking the applet's top button.</strong>
     <br>
     The first time you click this button,
     you'll see a "Window opened" message
     in the applet's display area.
<li> <strong>Click the window if it doesn't already have the focus.</strong>
     <br>
     Do you see a "Window activated" message
     in the applet's display area?
<li> <strong>Iconify the window, using the window controls.</strong>
     <br>
     You'll see a "Window iconified" message
     in the applet's display area.
<li> <strong>Deiconify the window.</strong>
     <br>
     You'll see a "Window deiconified" message in the applet's display area.
<li> <strong>Close the window, using the window controls.</strong>
     <br>
     You'll see "Window closing"
     in the applet's display area.
     Because the window-closing event handler
     invokes <code>setVisible(false)</code>
     instead of <code>dispose()</code>,
     you won't see "Window closed".
</ol>
<hr>
</blockquote>

<p>

Here is the applet's window event handling code:

<blockquote>
<pre>
public class WindowEventDemo ... implements WindowListener {
     <em>...//where initialization occurs:</em>
        //Create but don't show window.
        window = new JFrame("Window Event Window");
        window.addWindowListener(this);
        window.getContentPane().add(
	    new JLabel("The applet listens to this window for window events."),
	    BorderLayout.CENTER);
        window.pack();
    }

    public void windowClosing(WindowEvent e) {
        window.setVisible(false);
        displayMessage("Window closing", e);
    }

    public void windowClosed(WindowEvent e) {
        displayMessage("Window closed", e);
    }

    public void windowOpened(WindowEvent e) {
        displayMessage("Window opened", e);
    }

    public void windowIconified(WindowEvent e) {
        displayMessage("Window iconified", e);
    }

    public void windowDeiconified(WindowEvent e) {
        displayMessage("Window deiconified", e);
    }

    public void windowActivated(WindowEvent e) {
        displayMessage("Window activated", e);
    }

    public void windowDeactivated(WindowEvent e) {
        displayMessage("Window deactivated", e);
    }

    void displayMessage(String prefix, WindowEvent e) {
        display.append(prefix
                       + ": "
                       + e.getWindow()
                       + newline); 
    }
    ...
}
</pre>
</blockquote>

<p>

Here are some of the source files that contain window listeners:

<ul>
<li> <code><a href="http://docs.rinet.ru/Jtuta/applet/appletsonly/example-1dot1/ShowDocument.java">ShowDocument.java</code></a>
<li> <code><a href="http://docs.rinet.ru/Jtuta/uiswing/events/example-swing/ComponentEventDemo.java">ComponentEventDemo.java</code></a>
<li> <code><a href="http://docs.rinet.ru/Jtuta/uiswing/layout/example-swing/FlowWindow.java">FlowWindow.java</code></a>
<li> <code><a href="http://docs.rinet.ru/Jtuta/uiswing/misc/example-swing/AnimatorApplicationTimer.java">AnimatorApplicationTimer.java</code></a>
</ul>

<p>

</blockquote>
<h4>The <code>WindowEvent</code> Class</h4>
<blockquote>
Each window event method has a single parameter: a
<a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.awt.event.WindowEvent.html"><code>WindowEvent</code></a><a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.awt.event.WindowEvent.html"><img src="http://docs.rinet.ru/Jtuta/images/apiIcon.gif" width=20 height=20 border=0 alt="(in the API reference documentation)"></a> object.
<dl>
<dt><strong><code>Window getWindow()</code></strong>
<dd>Returns the window that generated the event.
    You can use this instead of the <code>getSource</code> method.
</dl>


</blockquote>
</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="undoableeditlistener.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="..\painting\index.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/uiHeader.gif" width=26 height=26 align=top border=0 alt="Creating a GUI with JFC/Swing | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Writing Event Listeners</em></strong></a>
</td>
</tr>
</table>
</body>
</html>
