




















<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>The HighScore Class</title>
</head>
<body BGCOLOR="#ffffff">










<table width="100%">
<tr>
<td align=left>
<a href="game.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="perm.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/security1_2Header.gif" width=26 height=26 align=bottom border=0 alt="Security in JDK 1.2  | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Implementing Your Own Permission</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    The HighScore Class
</h2>
<p>
<blockquote>

The <code>HighScore</code> class stores and protects access to the user's
high score for <code>TerrysGame</code> (and any other games that call it). 
For simplicity, this class saves
the high score value into a file, called <code>.highscore</code>, in the
user's home directory. However, before allowing <code>TerrysGame</code> to
retrieve or update the user's high score value, this class
checks to make sure that the user has granted <code>TerrysGame</code>
permission to access the high score in his/her security
policy file.

<H3>Checking that <code>TerrysGame</code> has the HighScorePermission</H3>

<blockquote>

To check whether or not <code>TerrysGame</code> has permission to access
the user's high score, the <code>HighScore</code> class must:

<ol>
<li>Call <code>System.getSecurityManager()</code> to get
the currently installed security manager.<p>
<li>If the result is not null (i.e., there <i>is</i> a  
security manager, as opposed to the caller being an
application that is unrestricted), then<p>

<ol>
<li>Construct a <code>HighScorePermission</code> object, and<p>
<li>Call the security manager's <code>checkPermission</code> 
method, and pass it the newly constructed <code>HighScorePermission</code> object.
</ol>

</ol>

Here is the code:

<blockquote>
<pre>
SecurityManager sm = System.getSecurityManager();
if (sm != null) {
    sm.checkPermission(new HighScorePermission(gameName));
}
</pre>
</blockquote>

The <code>checkPermission</code> method essentially 
asks the security manager
if <code>TerrysGame</code> has the specified <code>HighScorePermission</code>. 
In other words, it asks
the security manager if <code>TerrysGame</code> has permission to update the user's
high score value for the specified game (<code>TerrysGame</code>). 
The underlying security framework will consult
the user's security policy to see if <code>TerrysGame</code> indeed has this
permission.

</blockquote>


<H3>The HighScore Code</H3>

<blockquote>

<p>
<a href=http://docs.rinet.ru/Jtuta/security1.2/userperm/example-1dot2/HighScore.java>Here</a>
is the complete source code for the <code>HighScore</code> class.

<p>Note: The <code>doPrivileged</code> method calls are used to enable
<code>HighScore</code> to temporarily access resources that are 
available to it
but that are not available to the code that calls it (<code>TerrysGame</code>).
For example, it is expected that the policy file will
grant <code>HighScore</code> permission to access the <code>.highscore</code> 
file in the user's home directory, but it will not grant this permission
to games, such as <code>TerrysGame</code>.
For more information about the use of 
<code>doPrivileged</code> methods, see
<a href="http://java.sun.com/products/jdk/1.2/docs/guide/security/doprivileged.html">
New Privileged Block API</a>
on the public <code>java.sun.com</code> web site.



</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="game.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="perm.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/security1_2Header.gif" width=26 height=26 align=top border=0 alt="Security in JDK 1.2  | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Implementing Your Own Permission</em></strong></a>
</td>
</tr>
</table>
</body>
</html>

