




















<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>Input and Convert the Encoded Public Key Bytes</title>
</head>
<body BGCOLOR="#ffffff">










<table width="100%">
<tr>
<td align=left>
<a href="vstep1.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="vstep3.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/security1_2Header.gif" width=26 height=26 align=bottom border=0 alt="Security in JDK 1.2  | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Generating and Verifying Signatures</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    Input and Convert the Encoded Public Key Bytes
</h2>
<p>
<blockquote>

Next, <code>VerSig</code> needs to import the encoded public key bytes 
from the file specified 
as the first command line argument and to convert them to a <code>PublicKey</code>.
A <code>PublicKey</code> is needed because that is what the 
<code>Signature</code> <code>initVerify</code>
method requires in order to initialize the <code>Signature</code> object for verification.

<p>First, read in the encoded public key bytes.

<blockquote>
<pre>
        FileInputStream keyfis = new FileInputStream(args[0]);
        byte[] encKey = new byte[keyfis.available()];  
        keyfis.read(encKey);

        keyfis.close();
</pre>
</blockquote>

Now the byte array <code>encKey</code> contains the encoded public key bytes.

<p>You can use a <code>KeyFactory</code> class in order to instantiate a DSA public key
from its encoding. The <code>KeyFactory</code> class provides conversions between
opaque keys
(of type <code>Key</code>) and key specifications, which are 
transparent representations of the underlying key material.
With an opaque key you can obtain the algorithm name,
format name, and encoded key bytes, but not the key material,
which, for example, may consist of the key itself and the algorithm
parameters used to calculate the key.
(Note that <code>PublicKey</code>, because it extends <code>Key</code>, is
itself a <code>Key</code>.)

<p>So, first you need a key specification.
You can obtain one via the following, assuming that the key was encoded according to 
the X.509 standard, which is the case, for example, if the key was generated
with the built-in DSA key-pair generator supplied by the SUN provider:

<blockquote>
<pre>
        X509EncodedKeySpec pubKeySpec = new X509EncodedKeySpec(encKey);
</pre>
</blockquote>

<p>Now you need a <code>KeyFactory</code> object to do the conversion. 
That object must be one that works with DSA keys.

<blockquote>
<pre>
        KeyFactory keyFactory = KeyFactory.getInstance("DSA", "SUN");
</pre>
</blockquote>

<p>Finally, you can use the <code>KeyFactory</code> object to generate a 
<code>PublicKey</code> from the key specification.

<blockquote>
<pre>
        PublicKey pubKey = keyFactory.generatePublic(pubKeySpec);
</pre>
</blockquote>

</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="vstep1.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="vstep3.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/security1_2Header.gif" width=26 height=26 align=top border=0 alt="Security in JDK 1.2  | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Generating and Verifying Signatures</em></strong></a>
</td>
</tr>
</table>
</body>
</html>
