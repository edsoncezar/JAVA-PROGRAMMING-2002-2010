




















<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>Verify the Signature</title>
</head>
<body BGCOLOR="#ffffff">










<table width="100%">
<tr>
<td align=left>
<a href="vstep3.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="vstep5.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/security1_2Header.gif" width=26 height=26 align=bottom border=0 alt="Security in JDK 1.2  | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Generating and Verifying Signatures</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    Verify the Signature
</h2>
<p>
<blockquote>

<p>You've added code to the <code>VerSig</code> program to

<ul>

<li>Input the encoded key bytes and converted them
to a <code>PublicKey</code> named <code>pubKey</code><p>
<li>Input the signature bytes into a byte array named <code>sigToVerify</code>

</ul>

You can now proceed to do the verification.


<p><b>Initialize the Signature Object for Verification</b>

<blockquote>

<p>As with signature generation, a signature is verified by
using an instance of the <code>Signature</code> class. 
You need to create a <code>Signature</code> object that uses the same signature algorithm
as was used to generate the signature. The algorithm used by the
<code>GenSig</code> program was the SHA1withDSA algorithm from the SUN
provider.

<blockquote>
<pre>
        Signature sig = Signature.getInstance("SHA1withDSA", "SUN");
</pre>
</blockquote>

Next, you need to initialize the <code>Signature</code> object.
The initialization method for verification requires the public key.

<blockquote>
<pre>
        sig.initVerify(pubKey);
</pre>
</blockquote>

</blockquote>


<p><b>Supply the Signature Object With the Data to be Verified</b>

<blockquote>

You now need to supply the <code>Signature</code> object with the data for which
a signature was generated. This data is in the file whose name was
specified as the third command line argument. As you did
when signing, read in the data one buffer at a time, and supply it to
the <code>Signature</code> object by calling the <code>update</code> method.

<blockquote>
<pre>
        FileInputStream datafis = new FileInputStream(args[2]);
        BufferedInputStream bufin = new BufferedInputStream(datafis);

        byte[] buffer = new byte[1024];
        int len;
        while (bufin.available() != 0) {
            len = bufin.read(buffer);
            sig.update(buffer, 0, len);
            };

        bufin.close();
</pre>
</blockquote>

</blockquote>

<p><b>Verify the Signature</b>

<blockquote>

<p>Once you have supplied all of the data to the <code>Signature</code> object,
you can verify the digital signature of that data and report
the result. Recall that
the alleged signature was read into a byte array called <code>sigToVerify</code>.

<blockquote>
<pre>
       boolean verifies = sig.verify(sigToVerify);

       System.out.println("signature verifies: " + verifies);
</pre>
</blockquote>

<p>The <code>verifies</code> value will be <code>true</code> if
the alleged signature (<code>sigToVerify</code>) is the actual signature of the
specified data file generated by the private key corresponding to the
public key <code>pubKey</code>.

</blockquote>



</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="vstep3.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="vstep5.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/security1_2Header.gif" width=26 height=26 align=top border=0 alt="Security in JDK 1.2  | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Generating and Verifying Signatures</em></strong></a>
</td>
</tr>
</table>
</body>
</html>
