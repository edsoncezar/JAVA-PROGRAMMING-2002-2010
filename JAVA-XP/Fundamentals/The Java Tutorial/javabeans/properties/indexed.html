


















<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>Indexed Properties</title>
</head>
<body BGCOLOR="#ffffff">










<table width="100%">
<tr>
<td align=left>
<a href="constrained.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="..\events\index.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/jdk1_1.gif" width=26 height=26 align=bottom border=0 alt="JavaBeans | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Properties</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/Jtuta/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    Indexed Properties
</h2>
<p>
<blockquote>


<blockquote>
<hr>
<p>
To get the most out of this section, read the following
documentation:
<ul>
  <li>Section 7.2 of the <a href="http://java.sun.com/beans/spec.html">
      JavaBeans API Specification</a>.
  <li><a href="http://java.sun.com/beans/docs/javadoc/java.beans.IndexedPropertyDescriptor.html">
      <code>IndexedPropertyDescriptor</code></a> class
  <li><a href="http://java.sun.com/beans/docs/javadoc/java.beans.PropertyEditor.html">
      <code>PropertyEditor</code></a> interface 
  <li><a href="http://java.sun.com/beans/docs/javadoc/java.beans.PropertyEditorSupport.html">
      <code>PropertyEditorSupport</code></a> class
</ul>
<hr>
</blockquote>

<p>
Indexed properties represent collections of values
accessed, like an array, by index. The indexed property
design patterns are
<blockquote>
<pre>
//Methods to access the entire indexed property array
public &lt;PropertyType&gt;[] get&lt;PropertyName&gt;();
public void set&lt;PropertyName&gt;(&lt;PropertyType&gt;[] value);

//Methods to access individual values
public &lt;PropertyType&gt; get&lt;PropertyName&gt;(int index);
public void set&lt;PropertyName&gt;(int index, &lt;PropertyType&gt; value);
</pre>
</blockquote>

Conforming to these patterns lets builder tools know
that your Bean contains an indexed property.

<p>
The <code>OurListBox</code> demo Bean illustrates how
to use an indexed property.
<code>OurListBox</code> extends the <a href="http://java.sun.com/products/jdk/1.1/api/java.awt.List.html">
<code>List</code></a> class to provide a
Bean that presents the user with a list of choices: Choices
that you can provide and change at design time. Here's
an illustration of an <code>OurListBox</code> instance:

<blockquote><IMG SRC="http://docs.rinet.ru/Jtuta/figures/javabeans/OurListBoxNoPropSheet.gif" WIDTH="275" HEIGHT="192" ALIGN="BOTTOM" NATURALSIZEFLAG="3" ALT=""></blockquote>

<code>OurListBox</code> exposes the <code>item</code>
indexed property with the following accessor methods:
<blockquote>
<pre>
public void setItems(String[] indexprop) {
  String[] oldValue=fieldIndexprop;
  fieldIndexprop=indexprop;
  populateListBox();
  support.firePropertyChange("items",oldValue, indexprop);
}

public void setItems(int index, String indexprop) {
  String[] oldValue=fieldIndexprop;
  fieldIndexprop[index]=indexprop;
  populateListBox();
  support.firePropertyChange("Items",oldValue, fieldIndexprop);
}
 
public String[] getItems() {
  return fieldIndexprop;
}
    
public String getItems(int index) {
  return getItems()[index];
}
</pre>
</blockquote>

<p>
When an item is set by one of the <code>setItems()</code> methods,
<code>OurListBox</code> is populated with the contents of a
<code>String</code> array.

<p>
Indexed properties are almost as easily
exposed to builder tools as simple properties. Writing an indexed property
editor, though, requires writing a custom property editor. 

<h3>Indexed Property Editors</h3>
<blockquote>
<p>
The <code> OurListBox</code> demo Bean provides
an associated <code>IndexPropertyEditor</code> which is a
good example of how to implement an indexed property editor.
The following illustration shows an <code>OurListBox</code>
instance in the BeanBox, the Properties sheet which contains
an entry for the indexed property <code>items</code>, and
the <code>IndexPropertyEditor</code> which pops up when
the <code>items</code> property entry is clicked:

<blockquote><IMG SRC="http://docs.rinet.ru/Jtuta/figures/javabeans/OurListBoxWithEditor.gif" WIDTH="554" HEIGHT="455" ALIGN="BOTTOM" NATURALSIZEFLAG="3" ALT=""></blockquote>
<p>
Implementing <code>IndexPropertyEditor</code>
is the same as implementing any
<a href="..\customization\index.html">custom property editor</a>:

<ol>
  <li><b>Implement the <code>PropertyEditor</code> interface</b>:
      <pre>
       public class IndexPropertyEditor extends Panel
                     implements PropertyEditor, Action Listener {
      </pre>
      You can use the <code>PropertyEditorSupport</code> class,
      either by subclassing or as an inner class.
  <li><b>Denote the custom editor in a related <code>BeanInfo</code> class</b>.
      <code>OurListBox</code> has a related
      <code>OurListBoxBeanInfo</code> class that contains
      the following code:
      <pre>
         itemsprop.setPropertyEditorClass(IndexPropertyEditor.class);
      </pre>
      <p>
   <li><b>Make the property editor a source for bound property events</b>.
       The property editor will register property listeners,
       and fire property change events at those listeners. This is
       how the property changes are propagated back to the Bean
       (via the property sheet). So <code>IndexPropertyEditor</code>
       instantiates an inner <code>PropertyChangeSupport</code> class:
       <pre>
          private PropertyChangeSupport support =
               new PropertyChangeSupport(this);
       </pre>
       Provides the ability for objects to register their
       interest in being notified when a property is edited:
       <pre>
       public void addPropertyChangeListener(PropertyChangeListener l) {
        support.addPropertyChangeListener(l);
       }

       public void removePropertyChangeListener(PropertyChangeListener l) {
        support.removePropertyChangeListener(l);
       }
       </pre>
       And fires property change events at those listeners:
       <pre>
          public void actionPerformed(ActionEvent evt) {
        if (evt.getSource() == addButton) {
            listBox.addItem(textBox.getText());
            textBox.setText("");
            support.firePropertyChange("", null, null);
        }
        else if (evt.getSource()== textBox) {
            listBox.addItem(textBox.getText());
            textBox.setText("");
            support.firePropertyChange("",null,null);
        }
        ...
       }
       </pre>
</ol>

<p>
<code>IndexPropertyEditor</code> maintains <code>listbox</code>
as a proxy for <code>OurListBox</code>. When a change is made to
<code>listbox</code>, a property change event is fired to all
listeners.

<p>
When the Properties sheet, which is registered as an
<code>IndexPropertyEditor</code> listener, receives a
property change event from <code>IndexPropertyEditor</code>,
the Properties sheet calls
<code>IndexPropertyEditor.getValue</code> to
retrieve the new or changed items and update
the Bean.
</blockquote>
<p>
</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="constrained.html"><img src="http://docs.rinet.ru/Jtuta/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="..\events\index.html"><img src="http://docs.rinet.ru/Jtuta/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="..\..\trailmap.html"><img src="http://docs.rinet.ru/Jtuta/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/Jtuta/images/jdk1_1.gif" width=26 height=26 align=top border=0 alt="JavaBeans | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Properties</em></strong></a>
</td>
</tr>
</table>
</body>
</html>
