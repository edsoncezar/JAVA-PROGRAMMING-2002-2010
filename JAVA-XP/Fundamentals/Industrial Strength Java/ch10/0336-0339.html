<HTML>

<HEAD>



<TITLE>Industrial Strength Java:Introducing Networking:EarthWeb Inc.-</TITLE>



















<P><CENTER>

<a href="0331-0335.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0340-0343.html">Next</A>

</CENTER></P>



<A NAME="PAGENUM-336"><P>Page 336</P></A>







<P>Listing 10.8 Continued

</P>


<PRE>

      System.out.println(&quot;before: &quot; + s);

      s = URLEncoder.encode(s);

      System.out.println(&quot;after: &quot; + s);

  }

}

</PRE>




<P>As you can see in the sample run in listing 10.9, all non-alphanumeric characters

were converted by the encode() method.

</P>



<P>Listing 10.9 encode sample run

</P>


<PRE>

%java encode <a href="http://www.millikin.edu/">

http://www.millikin.edu</A>

before: <a href="http://www.millikin.edu/">

http://www.millikin.edu</A>

after: <a href="http://library.cs.tuiasi.ro/programming/java/industrial_strenght_java/ch10/://www.millikin.edu">

http:%3a%2f%2fwww%2emillikin%2eedu</A>

%

</PRE>




<P>URL and URLConnection enable the programmer to access information through a

variety of standard Internet services; however, you usually need a server designed to fit a

specific project's requirements. URL and URLConnection fall short in that aspect; they

were designed to provide an easy interface to standard network services and are limited

to standard services. To implement a server or access data you wrote on a server, you need

to become familiar with sockets and datagrams.

</P>



<H4><A NAME="ch10_ 10">

Sockets

</A></H4>



<P>The classes java.net.Socket and java.net.ServerSocket are the heart of Java

networking. They enable two or more processes to reliably communicate over the network.

Although the Socket class can be used to transmit datagrams, it is usually used to implement

a connection-oriented stream protocol. ServerSocket listens for clients requesting

connections on a specified port, usually infinitely, but a time-out can be specified. After

a connection is made, the server program creates a Socket so that it can pass

information back to the client (see fig. 10.1).

</P>



<P>Before discussing the constructors and methods of Socket and ServerSocket, the

class InetAddress must be mentioned. An InetAddress represents the actual number, not

the name or IP address of a computer. The name studsys.mscs.mu.edu is never used by

your program; instead it uses the corresponding address, 134.48.4.25. The class itself is

fairly simple, as listing 10.10 shows.

</P>

<A NAME="PAGENUM-337"><P>Page 337</P></A>







<P><a href="images\ch10fg01.jpg"><img src="images\tn_ch10fg01.jpg"></a><BR>

Figure 10.1

With sockets, a connection is opened and used until it

is closed to pass data between hosts.

</P>



<P>Listing 10.10 java.net.InetAddress

</P>


<PRE>

public final class InetAddress extends Object {

  //No Constructors

  //Methods

  public static syncrhonized InetAddress[] getAllByName

    (String host) throws UnknownHostException;

  public static syncrhonized InetAddress getByName

    (String host) throws UnknownHostException;

  public static InetAddress getLocalHost()

    throws UnknownHostException;

  public boolean equals(Object obj);

  public byte[] getAddress();

  public String getHostName();

  public int hashCode();

  public String toString();

</PRE>




<P>InetAddress has no constructors. Instead, it provides three methods that return

an InetAddress. The getHostName()method returns a String containing the host's name.

An array of bytes representing an IP address is returned by

getAddress(). Lastly, getAllByName() returns an array of InetAddresses containing all the available

addresses for a host. (A single computer can be assigned multiple IP addresses.)

</P>



<P>Listing 10.11 java.net.Socket

</P>


<PRE>

public final class Socket extends Object {

  //Constructors

  public Socket(String host, int port)

    throws UnknownHostException, IOException;

  public Socket(String host, int port, boolean stream)

    throws UnknownHostException, IOException;

</PRE>


<PRE>
continues
</PRE>




<A NAME="PAGENUM-338"><P>Page 338</P></A>







<P>Listing 10.11 Continued

</P>


<PRE>

  public Socket(InetAddress address, int port)

    throws IOException;

  public Socket(InetAddress address, int port, boolean stream)

    throws IOException;

  //Methods

  public static synchronized void setSocketImplFactory

    (SocketImplFactory fac) throws IOException, SocketException;

  public synchronized void close() throws IOException;

  public InetAddress getInetAddress();

  public InputStream getInputStream();

  public int getLocalPort();

  public OutputStream getOutputStream() throws IOException;

  public int getPort();

  public String toString();

}

</PRE>




<P>Socket provides the programmer with four constructors. The address of the server may

be specified as a String or an InetAddress. In each case, an optional Boolean

parameter implements a connectionless socket if set to false. After the socket is

created, getInetAddress and getPort provide information about the server, whereas

getLocalPort provides information about the machine on which the Socket was created. The

methods getInputStream and getOutputStream provide access to the InputStream

and OutputStream, which are used for the actual communication.

</P>



<P>Listing 10.12 java.net.ServerSocket

</P>


<PRE>

public final class ServerSocket extends Object {

  //Constructors

  public ServerSocket(int port) throws IOException;

  public ServerSocket(int port, int count) throws IOException;

  //Methods

  public static synchronized void setSocketFactory

    (SocketImplyFactory fac) throws IOException, SocketException;

  public Socket accept() throws IOException;

  public void close() throws IOException;

  public InetAddress getInetAddress();

  public int getLocalPort();

  public String toString();

}

</PRE>






<A NAME="PAGENUM-339"><P>Page 339</P></A>







<P>ServerSocket provides two constructors:

</P>



<UL>

<LI>          The port number to listen on must be specified

<LI>          Count, an optional parameter, specifies how long the ServerSocket should listen

</UL>



<P>By default, the ServerSocket listens indefinitely or until it is closed. After a connection

is made, getInetAddress() returns the client's address. The accept() method returns a

Socket that is connected to the client.

</P>



<H4><A NAME="ch10_ 11">

Datagrams

</A></H4>



<P>Although Socket and ServerSocket are most often used to implement

client/server programs, datagrams offer a faster alternative.

Datagrams are used to implement a connectionless protocol, such as UDP. One machine sends packets, each with a

destination address attached, and then forgets about it (see fig. 10.2). The packets are not

guaranteed to arrive, and, if they all arrive, their order of arrival is not necessarily the order they

were sent. Datagrams are not reliable, but the lack of reliability means less overhead,

making the connection faster. A UDP packet contains a header of only 8 bytes, whereas a

TCP header occupies 20 bytes.

</P>



<P><a href="images\ch10fg02.jpg"><img src="images\tn_ch10fg02.jpg"></a><BR>

Figure 10.2

Datagram flow.

</P>



<P>Datagrams may seem useless if they are not reliable. However, their speed is often

needed. Many game servers, which are programs that communicate with several clients

constantly sending small pieces of information, rely on datagrams. The program will not fail if

a command to increment the scores does not reach the client. A real-world example

of datagrams is Domain Name Service (DNS). Each time you type an Internet address,

it must be converted to its numeric equivalent. This uses DNS, which relies on UDP

or datagrams. Without the low overhead of datagrams, every single name lookup would

take longer, and the Internet would have even more traffic on it.

</P>



<P>Two classes are used to implement datagrams in Java:java.net.DatagramPacket

and java.net.DatagramSocket. DatagramPacket is the actual packet of information, an array

of bytes, that is transmitted over the network. DatagramSocket is a socket that sends

and

</P>



<P><CENTER>

<a href="0331-0335.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0340-0343.html">Next</A>

</CENTER></P>











</BODY>
</HTML>







