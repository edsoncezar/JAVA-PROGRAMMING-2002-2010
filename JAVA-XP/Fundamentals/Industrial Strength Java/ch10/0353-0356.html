<HTML>

<HEAD>



<TITLE>Industrial Strength Java:Introducing Networking:EarthWeb Inc.-</TITLE>



















<P><CENTER>

<a href="0349-0352.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0357-0361.html">Next</A>

</CENTER></P>



<A NAME="PAGENUM-353"><P>Page 353</P></A>







<P>execute your code on somebody else's machine as

a privilege and not a right. In order to be sure all users can run your program, it is best to

write code that works with security limitations that at times seem burdensome and

oversecure.

</P>



<B>

java.net Limitations

</B>



<P>The next example was chosen to illustrate a limitation of the java.net package.

Experienced network programmers are probably aware that the

ping command, often used to test whether a machine is alive, uses a protocol known as Internet Control Message

Protocol. ICMP sits on top of IP; however, it is not a fully functional network layer protocol

like TCP. The current Java Development Kit provides access to TCP and UDP; however,

no classes are available to make calls to IP directly or to ICMP. Without using native

methods, the ping command, as it is specified in the RFC, could not be simulated in Java.

</P>



<P>The example acts much like a ping command, although it does not use ICMP

commands. It sends a DatagramPacket to the echo server on the host machine, which resides on port

7. It measures and displays the amount of time, in milliseconds, before the packet is

returned, just as the ping command does. A true ping utility accepts the host name of

the machine to try to connect to as a parameter; however, applets can only open

connections to the machine from which they were downloaded. This applet shows two limitations

of java.net: one deals with applet security, and the other deals with the actual protocols

that java.net cannot handle.

</P>



<B>

NetSpeed.java

</B>



<P>The first section of code, shown in listing 10.25, contains standard applet

methods including init(), start(), and stop(). When the applet is loaded, it attempts to get the

host name of the machine from which it was loaded. The search may fail if you load the

applet from your hard drive using the file:// tag unless your machine has a registered

domain name. If the init() method does not print the host name to the standard output, it could

not get the host name. Chances are, the applet would not work on a machine without a

host name because the machine is probably not running an echo server on port 7. The

init() method also creates an instance of the NetTest class, which does the actual

simulated pinging. Finally, init() creates the user interface; start() only calls super.start(); stop()

calls super.stop() and the stop() method of the NetTest class.

</P>



<P>Listing 10.25 NetSpeed.java First of Two

</P>


<PRE>

import java.net.*;

</PRE>


<PRE>
continues
</PRE>




<A NAME="PAGENUM-354"><P>Page 354</P></A>







<P>Listing 10.25 Continued

</P>




<PRE>

import java.awt.*;

import java.lang.*;

import java.applet.*;



public class NetSpeed extends Applet

{



  NetTest nt;

      //separate class to handle the network connection

  TextArea display;

  String host;

      //must be address where applet was downloaded from

  Button tryAgain;



  public void init()

  {

    try

    {

      //get address wher applet came from

      //we much connect back to this host

      host = this.getCodeBase().getHost();

      //for debugging purposes

      System.out.println(host);



      nt = new NetTest(InetAddress.getByName(host));

      display = new TextArea(&quot;Click on the button\n&quot;);

      //intialize GUI components

      display.setEditable(false);

      tryAgain = new Button(&quot;Send Packet&quot;);

      tryAgain.resize(20,40);



      this.setLayout(new BorderLayout()); // layout GUI components

      this.add(&quot;South&quot;, tryAgain);

      this.add(&quot;Center&quot;, display);

    }

    catch (Exception e)

    {

       System.out.println(e);

    }

  }



  public void start() //a generi