<HTML>
<HEAD>


<TITLE>Industrial Strength Java:JDBC:EarthWeb Inc.-</TITLE>





<P><CENTER>
<a href="0757-0760.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0766-0769.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-761"><P>Page 761</P></A>


<P><B>
The JDBC-ODBC Bridge
</B></P>

<P>The Open Database Connectivity (ODBC) interface is Microsoft's solution for
DBMS-independent database access; however, ODBC is not appropriate for direct use from
Java applications because it is a C interface. Calls from Java programs to native C code have
a number of drawbacks that would impact the security, implementation, robustness,
and automatic portability of these applications. Some ODBC binary code and, in some
cases, database client code must be loaded on each client machine that uses this driver. As
a result, this driver is a good choice on a corporate network or in a three-tiered
architecture for application server code written in Java.
</P>

<P>JDBC is based on the X/Open SQL Call Level Interface, which is also the basis
for ODBC. Due to the similarities of the two specifications, the JDBC-ODBC bridge is
quite small and efficient. The bridge translates JDBC calls to those that can be understood
by ODBC clients at a C language level. The bridge is a joint development of JavaSoft
and Intersolv.
</P>

<P>The JDBC-ODBC bridge provides backward compatibility to a wide range of
databases that have ODBC drivers, but no JDBC drivers yet. JDBC has been designed to be
efficiently implemented on ODBC, so the bridge is a good way to use ODBC from Java.
The name of the bridge package is sun.jdbc.odbc. It is available for the Solaris and
NT/Win95 platforms and can be downloaded from:
</P>

<PRE>
<a href="http://splash.javasoft.com/jdbc/index.html">
http://splash.javasoft.com/jdbc/index.html</A>
</PRE>

<H4><A NAME="ch17_ 7">
The JDBC Driver Test Suite
</A></H4>

<P>JavaSoft and Intersolv have jointly developed a JDBC driver test suite that nicely
profiles the capabilities of a JDBC driver. This test suite is an attempt to ensure the portability
of applications across different JDBC drivers. As of now, it is not intended as a
driver certification.
</P>

<P>The JDBC Test Harness version 0.03 and the JDBC Test Suite version 0.05 are
available for download at the following:
</P>

<PRE>
<a href="http://splash.javasoft.com/jdbc/index.html">
http://splash.javasoft.com/jdbc/index.html</A>
</PRE>

<P>Both are needed to test a JDBC driver.
</P>

<H3><A NAME="ch17_ 8">
Interfaces and Classes
</A></H3>


<A NAME="PAGENUM-762"><P>Page 762</P></A>


<P>The JDBC API has a collection of interfaces that enable the primary functions of
opening and managing connections to particular DBMSs, executing SQL statements, and
processing the results. Added functionality in the form of cursors, transaction
management, dynamic database access, and metadata is also provided. Exception handling is an
essential part of any robust application. For this purpose, three exception handling classes
are provided. The java.sql package contains the various interfaces and classes.
</P>

<P>The interfaces follow:
</P>

<UL>
<LI>          Driver
<LI>          Connection
<LI>          Statement
<LI>          CallableStatement
<LI>          PreparedStatement
<LI>          ResultSet
<LI>          DatabaseMetaData
<LI>          ResultSetMetaData
</UL>

<P>The classes follow:
</P>

<UL>
<LI>          DriverManager
<LI>          DriverPropertyInfo
<LI>          Date
<LI>          Time
<LI>          Timestamp
<LI>          Types
</UL>

<P>The exception classes follow:
</P>

<UL>
<LI>          DataTruncation
<LI>          SQLException
<LI>          SQlWarning
</UL>

<P>Figure 17.2 illustrates the interaction between the commonly used interfaces and classes.
</P>

<P>The following sections describe the interfaces and classes and explain their
commonly used methods and data members. A complete listing of all the data members and
methods
</P>


<A NAME="PAGENUM-763"><P>Page 763</P></A>


<P><a href="images\ch17fg02.jpg"><img src="images\tn_ch17fg02.jpg"></a><BR>
Figure 17.2 Interaction between interfaces and classes.
</P>

<P>is beyond the scope of this chapter.
</P>

<P>To obtain a complete listing of all data members and methods, visit the following URL:
</P>

<PRE>
<a href="http://splash.javasoft.com/jdbc/html-0110/package-java.sql.html">
http://splash.javasoft.com/jdbc/html-0110/Package-java.sql.html</A>
</PRE>

<H4><A NAME="ch17_ 9">
The java.sql.Driver Interface
</A></H4>

<P>As is the case with all Java interfaces and classes, the Driver interface extends the 
Object class. Each driver should provide a class that implements the Driver
interface. When a Driver class is loaded, it should create an instance of itself and register with
the DriverManager. In the following section, some of the commonly used methods of
the Driver interface are discussed.
</P>

<P><B>
Boolean acceptsURL(String DatabaseURL) Method
</B></P>

<P>This method returns true if the driver is capable of opening a connection to the
given URL, or false otherwise. The method accepts the URL of the connecting database.
</P>

<P><B>
Connection Connect (String DatabaseUrl, Properties <BR>Props) Method
</B></P>


<A NAME="PAGENUM-764"><P>Page 764</P></A>


<P>This method attempts to make a database connection to the given URL. It accepts
the URL of the connecting database. Moreover, the Properties type parameter can be used
to pass a list of name-value pairs as connection arguments. Usually, the user name
and password are passed in the Properties parameter.
</P>

<P>The driver should return null if it realizes that it cannot connect to the given URL. If it
is successful, it returns a Connection object that represents a connection to the URL.
The driver raises an SQLException if it has trouble connecting to the database.
</P>

<P><B>
int getMajorVersion() Method
</B></P>

<P>This method obtains the major version number of the driver. Initially, the major
version number of the driver should be 1.
</P>

<P><B>
int getMinorVersion() Method
</B></P>

<P>This method obtains the minor version number of the driver. Initially, the minor
version number should be 0.
</P>

<P><B>
DriverPropertyInfo[] getPropertyInfo(String <BR>DatabaseURL, Properties Props) Method
</B></P>

<P>With this method, a user interface tool can get a list of properties to be obtained from
the user, in order to connect to a database. It might be necessary to have more than one call
to this method, depending on what the user has supplied so far.
</P>

<P>This method accepts the URL of the connecting database and also a Properties
type parameter that indicates the proposed information that will be sent while opening
a connection.
</P>

<P>The method returns an array, possibly empty, of DriverPropertyInfo objects,
which describes the possible properties to be supplied by the user. It can throw a SQLException.
</P>

<P><B>
Boolean jdbcCompliant() Method
</B></P>

<P>This method ascertains whether the Driver is a JDBC
COMPLIANT&#137; driver. A driver should return a true value only if it passes the JDBC Compliance tests, otherwise it
returns false. To be JDBC COMPLIANT&#137;, a driver must provide full support for the JDBC
API and SQL 92 Entry Level.
</P>


<A NAME="PAGENUM-765"><P>Page 765</P></A>


<H4><A NAME="ch17_ 10">
The java.sql.Connection Interface
</A></H4>

<P>The public interface Connection extends the Object class. A Connection represents a
data access and manipulation session with a particular database. Within this session,
SQL statements can be executed, returning result sets. Some widely used methods are
described in the following sections.
</P>

<P><B>
void close() Method
</B></P>

<P>Some situations may warrant an immediate release of the Connection's database
resource and JDBC resources, instead of waiting for them to be automatically released. The
close() method provides these functions. Errors occurring in this method throw a SQLException.
</P>

<P><B>
void commit() Method
</B></P>

<P>By default, changes are automatically committed after each statement is executed. In
case the auto-commit feature has been disabled, explicitly call commit() to save the changes
to the database, or they will be lost. This method also releases any
database locks currently held by the Connection. It throws a SQLException, in case of an error.
</P>

<P><B>
void rollback() Method
</B></P>

<P>This method discards all the changes made since the last commit() or rollback() call.
It also causes any database locks held by the Connection to be released.
</P>

<P><B>
Statement createStatement() Method
</B></P>

<P>This method returns a new Statement object that can be used to execute SQL
statements without parameters. This method throws a SQLException in case of an error.
</P>

<P><B>
PreparedStatement prepareStatement(String <BR>SQL_Statement) Method
</B></P>

<P>This method returns a new PreparedStatement object containing the pre-compiled
statement. This object can be used to execute the pre-compiled statement many times.
This method accepts a SQL statement as a parameter that may contain more than one `?'
IN parameter placeholder.
</P>

<P>It throws a SQLException, in case of an error.
</P>


<P><CENTER>
<a href="0757-0760.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0766-0769.html">Next</A>
</CENTER></P>






</BODY>
</HTML>



