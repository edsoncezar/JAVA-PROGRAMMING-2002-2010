<HTML>
<HEAD>


<TITLE>Industrial Strength Java:JDBC:EarthWeb Inc.-</TITLE>





<P><CENTER>
<a href="0781-0783.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0788-0791.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-784"><P>Page 784</P></A>


<UL>
<LI>          int getColumnCount(). Obtains the number of columns in the ResultSet. It
returns an integer that equals the number of columns.
<LI>          String getColumnName(int
Column_Number). Obtains the actual name of a column, given the column number in a ResultSet.
<LI>          int getColumnType(int
Column_Number). Returns the SQL type of the column indicated by Column_Number. SQL types are defined in java.sql.Types. Refer
to table 17.1 for a list of SQL types and their mapping to corresponding Java
data types.
<LI>          Boolean isCurrency(int
Column_Number). Checks whether the value in the column specified using Column_Number is a currency (cash) value or not.
This method is quite useful in financial applications. The method returns a true or
false value.
<LI>          String getTableName(int
Column_Number). Gets the name of the table to which the column represented by Column_Number belongs. It returns the name
<LI>of the table in a Java String object.
</UL>

<P>There are other methods to determine whether a particular column can only be read 
or written, or whether a search can be specified using the column.
</P>

<H3><A NAME="ch17_ 28">
Implementation Scenario Using JDBC
</A></H3>

<P>H2O Inc. is an upcoming dealer in water pumps of all
kinds, with offices in Atlanta and Macon, Georgia. With growing competition, H2O decided that they needed to target a
wide market, including the entire state of Georgia, by using the World Wide
Web. H2O was convinced that web shopping would bring in an unprecedented amount of revenue
because their company would become more visible and more accessible from distant places.
</P>

<P>However, they faced certain problems. The offices in Atlanta and Macon had
grown independently, creating differences in the way each of the offices maintained
information. The Atlanta office maintained its inventory database on Oracle, whereas the Macon
office, being smaller, maintained its database on mSQL (Mini SQL&#151;for full details refer
to <a href="http://hughes.com.au/product/msql/)">
http://Hughes.com.au/product/msql/)</A>, a lightweight database engine.
</P>

<P>To enable their web shoppers to see the entire inventory contained collectively within
both offices, they designed an application using Java and JDBC.
</P>

<P>The following sections demonstrate how JDBC and Java were used to create a
web shopping site.
</P>


<A NAME="PAGENUM-785"><P>Page 785</P></A>



<H4><A NAME="ch17_ 29">
System Overview
</A></H4>

<P>From the system overview in figure 17.3, it is evident that the application must read
the databases at both sites and combine the information to give a complete picture to
the prospective customer.
</P>


<P><a href="images\ch17fg03.jpg"><img src="images\tn_ch17fg03.jpg"></a><BR>
Figure 17.3 System overview of the web shopper.
</P>


<P>It is assumed that the application uses JDBC API 1.10. H2O obtained Oracle and
mSQL JDBC drivers from JDBC driver vendors. The application is logically composed of
two units: a user interface combined with a business logic component coded using Java, and
a database component coded using the JDBC API.
</P>

<P>H2O's aim is to first provide a list of the available water pumps from which the
shopper can choose. This can be followed by non-update types of operations (such as price
inquiry, inventory inquiry, and so on) or update operations (such as ordering a particular
water pump).
</P>

<H4><A NAME="ch17_ 30">
System Implementation
</A></H4>

<P>Because this chapter is mainly about JDBC, the discussion focuses on the
database component of the system. The implementation can be done in a series of systematic
steps, as shown in the following sections.
</P>

<UL>
<LI>          Connecting to the
Databases. This section explains two sample methods
of establishing database connections.
<LI>          Querying the
Database. After a connection is established, various query
operations can be performed. This section explores commonly used query operations.
<LI>          Update
Operations. In this section, you are introduced to some of the
update operations provided by JDBC.
<LI>          Cleaning
up. This section illustrates the closing of statements and connections.
</UL>


<A NAME="PAGENUM-786"><P>Page 786</P></A>


<P><B>
Step One: Connecting to the Databases
</B></P>

<P>The first step in any database application is to establish a connection to the databases
that contain information pertinent to the application. The following code creates a
connection to the database at Macon, Georgia.
</P>

<P>Listing 17.1Connecting to the Database at Macon
</P>

<PRE>
new imaginary.sql.iMsqlDriver();
String url = &quot;jdbc:msql://www.H2OMacon.com:4333/Shopdb&quot;;
Connection con = DriverManager.getConnection(url, &quot;nobody&quot;,
 &quot;&quot;);
</PRE>

<P>The first line of code creates an instance of the mSQL JDBC driver provided by
Imaginary (refer to
<a href="http://www.imaginary.com/~borg/java).">
http://www.imaginary.com/~borg/Java).</A> The application will
communicate with the mSQL database using the previously mentioned mSQL JDBC driver.
Another way to inform the DriverManager about a Driver class is to use the standard
Class.for-     Name method, in the following way:
</P>

<PRE>
Class.forName(&quot;imaginary.sql.iMsqlDriver&quot;);
</PRE>

<P>The second line of code creates a String object with the value of
the location of the H2O Macon office database. This
String object is required to create a Connection object and follows the
naming convention defined in JDBC 1.10 specifications. Here, the
substring &quot;jdbc&quot; informs the server that the protocol to be used is JDBC.
The substring &quot;msql&quot; defines the subprotocol, and
&quot;//www.H2OMacon.     com:4333/Shopdb&quot; specifies the database name &quot;Shopdb&quot; and
the server name.
</P>

<P>The next line of code actually creates the connection by using the location specified
by String url and logging in as user &quot;nobody&quot; with an empty password parameter. This
whole section of code must be placed within a &quot;try&quot; block to catch any SQLException that
might be caused by the execution of this code. A SQLException is thrown if a connection
could not be established.
</P>

<P>There are other ways to obtain a database connection. One way is to use the
Driver interface to obtain a connection. The same effect as the previously defined piece of
code can be achieved by implementing the code in listing 17.2. 
</P>

<BR>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
NOTE
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
4333 is the MSQL_-     PORT for non-root access on
Unix systems.
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>


<A NAME="PAGENUM-787"><P>Page 787</P></A>


<P>Listing 17.2Alternative Method of Connecting to a Database
</P>

<PRE>
     Properties props = new Properties();
          props.put(&quot;server&quot;,&quot;www.H2OMacon.com:4333&quot;);
          props.put(&quot;user&quot;,&quot;nobody&quot;);
          props.put(&quot;password&quot;,&quot;&quot;);
          Driver msqldr = new imaginary.sql.iMsqlDriver();
          String url = &quot;jdbc:msql://www.H2OMacon.com:4333/Shopdb&quot;;
connection1 = msqldr.connect(url,props);
</PRE>

<P>Here, the connection is obtained by asking the mSQL JDBC driver to create a
connection to the given URL, using the given properties. In essence, both segments of code
achieve the same result&#151;they create a connection.
</P>

<P>The next action is to create a connection to the database in the Atlanta office of H2O.
This can be accomplished by using a JDBC driver for Oracle (refer to
<a href="http://www.weblogic.com/&#151;this">
http://www.weblogic.com/&#151;this</A> is an Oracle JDBC driver offered by webLogic
Technologies) or by using the JDBC-ODBC bridge. The code lines in listing 17.3 use jdbcKona, a
JDBC driver offered by webLogic for connecting to Oracle, Sybase, and MS SQL databases.
</P>

<P>Listing 17.3Connecting to the Database at Atlanta
</P>

<PRE>
Properties props = new Properties();
props.put(&quot;user&quot;,     &quot;nobody&quot;);
props.put(&quot;password&quot;, &quot;&quot;);
props.put(&quot;server&quot;,   &quot;www.H2OAtlanta.com/inventory&quot;);
try {
     Connection connection2 =
     &Acirc;DriverManager.getConnection(&quot;jdbc:weblogic:oracle&quot;, props);
     }
catch (SQLException e) {
          System.out.println(&quot;Error message &quot; + e.getMessage();
          }
</PRE>

<P>Now that both the connections are set up, it is time for the next step.
</P>

<P><B>
Step Two: Querying the Database
</B></P>

<P>H2O needs to present to the prospective customer the list of all the different kinds
of water pumps available at both sites of the company. The solution is to run queries
against both databases, and then combine the results to give an overall picture. The queries
are shown in code listing 17.4.
</P>


<P><CENTER>
<a href="0781-0783.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0788-0791.html">Next</A>
</CENTER></P>






</BODY>
</HTML>



