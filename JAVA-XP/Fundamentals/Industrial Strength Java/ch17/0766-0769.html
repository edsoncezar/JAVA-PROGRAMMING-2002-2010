<HTML>
<HEAD>


<TITLE>Industrial Strength Java:JDBC:EarthWeb Inc.-</TITLE>





<P><CENTER>
<a href="0761-0765.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0770-0772.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-766"><P>Page 766</P></A>


<P><B>
CallableStatement prepareCall(String
SQL_Statement) <BR>Method
</B></P>

<P>This method returns a new CallableStatement object containing the pre-compiled
SQL statement. The SQL_Statement parameter is a SQL statement that may contain more
than one `?' parameter placeholder. This method throws a SQLException, in case of an error.
</P>

<P><B>
void setAutoCommit(Boolean enableAutoCommit) Method
</B></P>

<P>This method enables an application to specify whether its SQL statements should
be automatically committed or grouped into transactions that are terminated by a
commit()or rollback() call. The auto-commit mode is the default for new connections.
</P>

<H4><A NAME="ch17_ 11">
The java.sql.Statement Interface
</A></H4>

<P>The Statement interface extends the Object class. Statement objects execute SQL
statements that are static by nature, and obtain results following their execution. Results are
in the form of ResultSet objects; however, there can be only one ResultSet object open
for each Statement object at any time. This means that if multiple ResultSets are required
by the application, each must be generated by a corresponding Statement object.
</P>

<P>The following sections discuss the most widely used methods of this interface.
</P>

<P><B>
void close() Method
</B></P>

<P>This method can be used when it is necessary to release a Statement's database
resource and other JDBC resources immediately, instead of waiting for this to occur when
the Statement is automatically closed. The void close() method throws a SQLException
when an error occurs.
</P>

<P><B>
Boolean execute(String SQL_Statement) Method
</B></P>

<P>This method executes a SQL statement that can return multiple results. The return
value indicates the form of the first result. If the return value is true, the next result is
a ResultSet. A return value of false indicates either that there are no more results or that
the next result is an update count. You can then use the
getResultSet(), getMoreResults(), or getUpdateCount() methods to retrieve any subsequent results. A SQLException is
thrown in case of an error.
</P>


<A NAME="PAGENUM-767"><P>Page 767</P></A>


<P><B>
ResultSet executeQuery(String SQL_Statement) Method
</B></P>

<P>This method executes a SQL statement that returns a single ResultSet object.
A SQLException is thrown, in case of an error.
</P>

<P><B>
int executeUpdate(String SQL_Statement) Method
</B></P>

<P>This method executes SQL UPDATE, DELETE, or INSERT statements. A row count
is returned for these statements. SQL statements that do not return anything, such as
SQL DDL statements, can also be executed. These statements return a value of 0. In case of
an error, a SQLException is thrown.
</P>

<P><B>
ResultSet getResultSet() Method
</B></P>

<P>This method returns the result of the current Statement, in the form of a ResultSet
object. This method should be called only once for each result. A SQLException is thrown,
in case of an error.
</P>

<P><B>
Boolean getMoreResults() Method
</B></P>

<P>This method moves to the next result of a Statement object. A value true is returned if
the next result of the Statement is a ResultSet. If the next result is an update count or if
there are no more results, a value false is returned.
</P>

<H4><A NAME="ch17_ 12">
The java.sql.PreparedStatement Interface
</A></H4>

<P>The public interface PreparedStatement extends the Statement interface. If the
application requires multiple executions of a particular SQL statement, it is a good idea to
pre-compile it and store it in a PreparedStatement object. The object can be used many
times to execute the statement efficiently. Some of the most widely used methods of
this interface are described in the following sections.
</P>

<P><B>
void clearParameters() Method
</B></P>

<P>In general, parameter values persist during repeated executions of a Statement. Setting
a parameter's value clears its previous value automatically. However, to immediately
release the resources used by current parameter values, use the clearParameters() method.
It throws a SQLException, in case of an error.
</P>



<A NAME="PAGENUM-768"><P>Page 768</P></A>



<P><B>
setXXX Methods
</B></P>

<P>The setXXX methods that are used for setting the IN parameter values must specify
types compatible with the defined SQL type of the input parameter. For example, setInt
should be used if the SQL type of the IN parameter is Integer. &quot;XXX&quot; stands for the various
data types that are supported.
</P>

<H4><A NAME="ch17_ 13">
The java.sql.CallableStatement Interface
</A></H4>

<P>The public interface CallableStatement extends the PreparedStatement interface.
This interface provides the functions that execute SQL stored procedures.
</P>

<P>A CallableStatement can return one or multiple ResultSets. JDBC provides a SQL
escape for stored procedures; this enables a uniform call to all relational DBMSs. The
escape syntax has a form that includes a result parameter, and it has a form that does not.
The result parameter must be registered as an OUT parameter, if it is used. The other
parameters may be used for input, output, or both.
</P>

<P>Parameters are referred to by number in a sequential manner, beginning from 1.
</P>

<P>The set methods inherited from PreparedStatement are used to set the IN
parameter values. All OUT parameter types must be registered before the execution of the
stored procedure. The most commonly used methods of the CallableStatement interface
are described in the following sections.
</P>

<P><B>
getXXX Methods
</B></P>

<P>The getXXX methods are used to obtain the values of the OUT parameters, after
execution of the stored procedure.
</P>

<P><B>
void registerOutParameter(int parameterIndex,int sqlType) <BR>Method
</B></P>

<P>This method must be called before executing a stored procedure call to register
the java.sql.Type of each OUT parameter. The parameterIndex parameter indicates the
number of the parameter. For example, 1 indicates the first parameter, 2 indicates the
second parameter, and so on. The sqlType parameter is a SQL type code defined
by java.sql.Types. This method throws a SQLException, in case of an error.
</P>


<A NAME="PAGENUM-769"><P>Page 769</P></A>



<P><B>
void registerOutParameter(int parameterIndex,int sqlType, <BR>int scale) Method
</B></P>

<P>This version of the registerOutParameter method is used for
registering Numeric or Decimal OUT parameters. The first two
parameters are the same as in the previous version of the method. The
scale parameter represents the number of digits to the right of the
decimal point. Its value should be greater than or equal to zero. This
method throws a SQLException, in case of an error.
</P>

<P><B>
Boolean wasNull() Method
</B></P>

<P>An OUT parameter can have the value of SQL NULL.
The wasNull() method returns true if the last value read was SQL
NULL; otherwise, false is returned. This method throws a SQLException,
in case of an error.
</P>

<H4><A NAME="ch17_ 14">
The java.sql.ResultSet Interface
</A></H4>

<P>The public interface ResultSet extends the Object class. The table
of data that is generated by the execution of a Statement can
be accessed through a ResultSet object.
</P>

<P>The ResultSet object maintains a cursor that points to its current
row of data. Initially, the cursor points to a location before the first
row. Then, the table rows can be retrieved in sequence by using
the &quot;next&quot; method.
</P>

<P>The getXXX methods retrieve the values in the columns of a particular row. Within a
row, the column values can be randomly accessed. The columns are numbered
sequentially beginning from 1. Column index numbers or names can be used to retrieve the
column values. The JDBC driver attempts to convert the data to the specified Java type and
returns a suitable Java value for the getXXX methods. The section that describes the
mappings between SQL types and Java types provides more details.
</P>

<P>When a Statement is re-executed or is used to retrieve the next result from a sequence
of results, the current ResultSet is automatically closed. This also happens when the
Statement that generated the ResultSet is closed.
</P>

<P>The ResultSet interface's most widely used methods are described in the
following sections.
</P>

<BR>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
NOTE
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
You must use the getXXX method whose Java type XXX
corre-     sponds to the para-     meter's registered
SQL type, when reading the value of an OUT parameter.
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
NOTE
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
You must first call getXXX on a parameter to read its
value and then call was-     Null() to determine
if the value was SQL NULL.
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>


<P><CENTER>
<a href="0761-0765.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0770-0772.html">Next</A>
</CENTER></P>






</BODY>
</HTML>



