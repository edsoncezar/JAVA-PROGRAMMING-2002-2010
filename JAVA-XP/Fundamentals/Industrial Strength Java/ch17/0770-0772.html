<HTML>
<HEAD>


<TITLE>Industrial Strength Java:JDBC:EarthWeb Inc.-</TITLE>





<P><CENTER>
<a href="0766-0769.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0773-0776.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-770"><P>Page 770</P></A>


<P><B>
ResultSetMetaData getMetaData() Method
</B></P>

<P>The ResultSetMetaData object, returned by the getMetaData method, provides
the number, types, and properties of a ResultSet's columns. The getMetaData() method 
throws a SQLException, in case an error occurs.
</P>

<P>Details of the ResultSetMetaData interface are provided later in the chapter.
</P>

<P><B>
void close() Method
</B></P>

<P>This method is used when the application wants to release a ResultSet's database
resource and JDBC resources immediately instead of waiting for this to happen when the
ResultSet is automatically closed. This method throws a SQLException to indicate an error
condition.
</P>

<P><B>
Boolean next() Method
</B></P>

<P>A ResultSet is initially positioned before its first row. To access
the rows of the ResultSet, successive calls must be made to the
next() method. It throws a SQLException, in case of an error. So, the
first call to next()makes the first row of the ResultSet the current row.
</P>

<P>The next() method returns true if the new, current row is a valid
row. It returns false if no more rows exist. This functionality is
achieved by the use of a cursor.
</P>

<P>The idea of a cursor should be familiar to most programmers
who have worked with a database. A cursor can be thought of as a
pointer or iterator pointing to or indexing into a set of tuples. A
tuple is a record in a database table. It has values for the fields in the table.
In the JDBC API, a cursor is an iterator indexing into a ResultSet.
</P>

<P>Cursors are very useful for dealing with multi-tupled
ResultSets. Extracting information from each row in the ResultSet is
facilitated through cursors. When a ResultSet is first created, the cursor
points to the first row of data. The row that a cursor points to is referred
to as the current row. The next() method of the ResultSet
interface iterates through the ResultSet. The next() method advances
the position of the cursor to the next row of data. The current version
of JDBC provides only rudimentary support for cursors. The name
of the cursor can be obtained by using
ResultSet.getCursorName(), which returns a Java String object. The row of a ResultSet object, 
</P>

<BR>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
TIP
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
Not all commercially available DBMSs support
positioned updates and positioned deletes. So, it
is up to the programmer to use the Database-     MetaData.
supports-     Positioned Update() and
DatabaseMeta-     Data. supports-    
Positioned Delete() methods to confirm that the
underlying DBMS does, in fact, support them. For example, the
Oracle RDBMS supports positioned updates and deletes.
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>


<A NAME="PAGENUM-771"><P>Page 771</P></A>


<P>currently pointed to by
a cursor, can be updated or deleted by a positioned update or delete, respectively, that
uses the name of the cursor.
</P>

<P>Developers who have worked with ODBC style cursors should be aware that JDBC
does not support scrollable cursors or enable the placement of bookmarks. The use of cursors
is illustrated in the &quot;Querying the Database&quot; section of the example scenario discussed
later in this chapter.
</P>

<H4><A NAME="ch17_ 15">
The java.sql.ResultSetMetaData Interface
</A></H4>

<P>The public interface ResultSetMetaData extends the Object class. Information about
the java.sql.ResultSetMetaData appears in the section, &quot;Noteworthy Features in JDBC,&quot;
later in the chapter.
</P>

<H4><A NAME="ch17_ 16">
The java.sql.DatabaseMetaData Interface
</A></H4>

<P>The public interface DatabaseMetaData extends the Object class. Information about
the java.sql.DatabaseMetaData appears in the section, &quot;Noteworthy Features in JDBC,&quot;
later in the chapter.
</P>

<H4><A NAME="ch17_ 17">
The java.sql.DriverManager Class
</A></H4>

<P>The DriverManager class extends the Object class. It controls the interface between
the application and a set of JDBC drivers. The DriverManager also provides a set of
services for managing the drivers.
</P>

<P>During its initialization, the DriverManager class tries to load the driver classes that
are referenced in the &quot;jdbc.drivers&quot; system property. If this property exists, it should have
a colon-separated list of driver names. The DriverManager class will attempt to load
each named Driver class. By modifying this property, a user can choose the JDBC drivers to
be used by his or her application. A program can also load JDBC drivers at run time.
For example, a Driver class can be explicitly loaded using the standard
Class.forName method. To load the imaginary.sql.iMsqldriver class, the following line of code can
be used.
</P>

<PRE>
Class.forName(&quot;imaginary.sql.iMsqlDriver&quot;);
</PRE>

<P>The methods of the DriverManager class are described in the sections that follow.
</P>

<P><B>
Connection getConnection() Method
</B></P>


<A NAME="PAGENUM-772"><P>Page 772</P></A>


<P>The getConnection method attempts to establish a connection to the specified
database URL. If it is successful, it returns a Connection object, which represents the connection
to the database URL. If there is an error, a SQLException is thrown.
</P>

<P>The method has three different forms:
</P>

<UL>
<LI>          Connection
getConnection(String DatabaseURL). This causes the DriverManager to try to select an appropriate JDBC driver from among those
that are registered.
<LI>          Connection
getConnection(String DatabaseURL, Properties
Props). This form accepts a Properties type parameter, which specifies a list of string
name-value pairs. Usually, a &quot;user&quot; and &quot;password&quot; property should be included.
<LI>          Connection getConnection(String DatabaseURL,
String UserName, String UserPassword). With this form, the user name and password are explicitly
passed as parameters, instead of being included in a Properties object.
</UL>

<P><B>
void registerDriver(Driver newDriver) Method
</B></P>

<P>To register itself with the DriverManager, a newly loaded Driver class should call
this method. In the case of an error, a SQLException is thrown.
</P>

<P><B>
Driver getDriver(String DatabaseUrl) Method
</B></P>

<P>This method causes the DriverManager to attempt to load a driver that understands
a particular database URL. If such a driver is present and is registered, the method returns
a Driver object. This Driver object represents a JDBC driver that can connect to the
database URL. This method throws a SQLException, if an error occurs.
</P>

<P><B>
Enumeration getDrivers() Method
</B></P>

<P>To get a list of JDBC drivers that the current caller can access, use the
getDrivers() method. This method returns an Enumeration of all the currently loaded JDBC drivers
that are accessible to the caller.
</P>

<P><B>
void deregisterDriver(Driver dropDriver) Method
</B></P>

<P>The DriverManager can also de-register drivers from the list of registered drivers.
This method drops the driver from the DriverManager's list. However, applets can only
de-register drivers from their own class loader. In the event of an error, this method throws
a SQLException.
</P>

<H4><A NAME="ch17_ 18">
The java.sql.DriverPropertyInfo Class
</A></H4>

<P><CENTER>
<a href="0766-0769.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0773-0776.html">Next</A>
</CENTER></P>






</BODY>
</HTML>



