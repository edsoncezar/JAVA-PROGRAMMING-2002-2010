<HTML>
<HEAD>


<TITLE>Industrial Strength Java:Java Beans:EarthWeb Inc.-</TITLE>





<P><CENTER>
<a href="0696-0700.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0706-0708.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-701"><P>Page 701</P></A>


<UL>
<LI>     Provides mechanisms enabling listeners to register as listeners of both buttons
<LI>     Provides mechanisms to close the dialog box when a button is clicked
</UL>

<P>How the dialog box closes should be explained. Because the class that builds the
screen uses two instances of OkCancel to monitor the buttons, it cannot discern when a button
is clicked. A solution is to have the GUI building class register itself as a listener of
each OkCancel class; therefore it properly terminates the window when notified of a
button click.
</P>

<P>The class is contained in listings 15.11a through 15.11f; discussion of each section
is provided before the section is introduced.
</P>

<P>Listing 15.11a contains declarations of private member data and the class signature.
Note how implementing the FWEListener interface enables this class to register itself as
a listener of an OkCancel object.
</P>

<P>Listing 15.11aDeclarations of Private Member Data and Class Signature
</P>

<PRE>
import java.awt.*;

//Decision class prompts the user for an answer to either accept or
 cancel
//some question.
public class Decision extends Dialog implements FWEListener{
      //GUI controls
      private       Label              text;
      private       Button             okButton;
      private       Button             cancelButton;
      private       OkCancel           ok;
      private       OkCancel           cancel;
</PRE>

<P>Listing 15.11b contains the beginning of the constructor. In this method necessary
classes are instantiated. Note that when the ok and cancel objects are instantiated, a parameter
is passed that informs these objects of the type of button being monitored.
</P>

<P>Listing 15.11bThe Decision Constructor
</P>

<PRE>
     //Decision class allows the user to answer a user specified question
     //with either OK or Cancel.
      public Decision(Frame parent, String incommingText) {
            super(parent, true);
</PRE>
<PRE>
                                                           continues
</PRE>

<A NAME="PAGENUM-702"><P>Page 702</P></A>


<P>Listing 15.11bContinued
</P>

<PRE>
           //create the compotes
            text = new Label(incommingText);

           //event sources
            okButton = new Button(&quot;OK&quot;);
            cancelButton = new Button(&quot;Cancel&quot;);

           //create the event listeners
            ok = new OkCancel(OkCancel.OK);
            cancel = new OkCancel(OkCancel.CANCEL);
</PRE>

<P>Listing 15.11c contains the code that actually registers each listener. First, the
OkCancel objects are registered as listeners of the buttons, and then the Decision object is
registered as a listener of the OkCancel classes.
</P>

<P>Listing 15.11cRegistration of All Listeners
</P>

<PRE>
//register the listeners of the buttons
            okButton.addActionListener(ok);
            cancelButton.addActionListener(cancel);

           //register ourself as listeners of the OkCancel classes
            ok.addFWEListener(this);
            cancel.addFWEListener(this);
</PRE>

<P>Listing 15.11d contains the code that actually draws the screen. The
GridBagLayout layout manager is used to provide maximum functionality. Also in this listing, the
insets() method provides a border on all sides of the dialog box.
</P>

<P>Listing 15.11dDrawing the Screen
</P>

<PRE>
           //use the GridBagLayout manager to draw the screen
            GridBagLayout myLayout = new GridBagLayout();
            GridBagConstraints constraints = new GridBagConstraints();
            this.setLayout(myLayout);

            constraints.weightx = 100;
            constraints.weighty = 100;
</PRE>


<A NAME="PAGENUM-703"><P>Page 703</P></A>


<PRE>
            constraints.gridx = 0;
            constraints.gridy = 0;
            constraints.gridwidth = 6;
            constraints.gridheight = 1;
            myLayout.setConstraints(text, constraints);
            this.add(text);

            constraints.gridx = 5;
            constraints.gridy = 3;
            constraints.gridwidth = 1;
            constraints.gridheight = 1;
            myLayout.setConstraints(okButton, constraints);
            this.add(okButton);

            constraints.gridx = 2;
            myLayout.setConstraints(cancelButton, constraints);
            this.add(cancelButton);

            this.pack();
            this.show();
      }


     //place a border around the dialog
      public Insets insets() {
            return new Insets(15, 15, 15, 15);
      }


     //called when either the OK or Cancel button is clicked.
     //closes the dialog.
      public void dialogDismissed(FrameWorkEvent evt) {
            this.hide();
      }
</PRE>

<P>Listing 15.11e contains a method to add new listeners and a method to remove
current listeners. These methods act as dispatchers and pass along any requests for registeration
or unregisteration to all instantiated OkCancel objects.
</P>

<P>Listing 15.11eMethods to Manage Registration and Unregisteration of
Event Listeners
</P>

<PRE>
     //add an event listener.
     //since listeners need to be notified of both the OK button
</PRE>

                                                           continues
</PRE>

<A NAME="PAGENUM-704"><P>Page 704</P></A>


<P>Listing 15.11eContinued
</P>

<PRE>
     //clicks and the Cancel button clicks, this method
     //registers the listener with both sources.
      public synchronized void addFWEListener(FWEListener fwe) {
            ok.addElement(fwe);
            cancel.addElement(fwe);
      }

     //remove an event listener
     //since listeners need to be notified of both the OK button
     //clicks and the Cancel button clicks, this method
     //registers the listener with both sources.
      public synchronized void removeFWEListener(FWEListener fwe) {
            ok.removeElement(fwe);
            cancel.removeElement(fwe);
      }
</PRE>

<P>Listing 15.11f contains the dialogDismissed() method which is called when either of
the buttons is clicked. This method closes the current dialog box.
</P>

<P>Listing 15.11fClosing the Dialog Box when Either Button is Clicked
</P>

<PRE>
     //called when either the OK or Cancel button is clicked.
     //closed the dialog
      public void dialogDismissed(FrameWorkEvent evt){
            this.hide();
      }
}
</PRE>

<P>At this point, GUI components and the Decision class have been converted to Beans.
With a little additional effort, you can now convert all the GUI components developed
in Chapter 6 to Java Beans. Concluding this section, the FrameWork class is converted to
a Java Bean that works as a listener of all the GUI controls.
</P>

<H4><A NAME="ch15_ 15">
Converting the FrameWork Class
</A></H4>

<P>Making the FrameWork class a listener of the Beans that replace the GUI
components requires the following two changes:
</P>


<A NAME="PAGENUM-705"><P>Page 705</P></A>


<UL>
<LI>     The FrameWork class must implement the FWEListener interface.
<LI>     The dialogDismissed() method must be implemented with proper support
to &quot;listen&quot; to each Java Bean.
</UL>

<P>Implementing FWEListener is accomplished by adding &quot;implements FWEListener&quot; to
the class signature. A little additional work is required to properly
implement dialogDismissed(). Listing 15.12 contains an implementation of the method supporting
the Decision class.
</P>

<P>Listing 15.12Implementing the dialogDismissed() Method in the
FrameWork Class
</P>

<PRE>
//as specified by the interface, this method is called when
//a button on a created dialog is clicked.
public void dialogDismissed(FrameWorkEvent evt) {
      if(evt.getSource() instanceof Decision) {
            if(evt.getInformation.equals(&quot;OK&quot;)) {
                  //do ok action
            }
            else {
                  //do cancel action
            }
      }
}
</PRE>

<H4><A NAME="ch15_ 16">
The Need For Two Frameworks
</A></H4>

<P>In this book you have developed two different application frameworks. One based on
the Java 1.0 event model, and another compromised of Java Beans (based on the Java
1.1 event model). Having developed both frameworks, the following question arises:
Why develop the same product based upon two different models?
</P>

<P>Although developing components as Beans is definitely part of the long-term future,
the truth of the matter is that developers have spent thousands of hours developing code
as class libraries based on the Java 1.0 event model. Although the Java 1.1 event model,
and the Java Bean specification in general, may be a more advanced event model, much
code will become legacy and will never be converted. For this reason it is important that
developers become familiar with both models.
</P>


<P><CENTER>
<a href="0696-0700.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0706-0708.html">Next</A>
</CENTER></P>






</BODY>
</HTML>



