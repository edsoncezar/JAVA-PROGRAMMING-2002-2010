<HTML>
<HEAD>


<TITLE>Industrial Strength Java:Jeeves and Java Servlets:EarthWeb Inc.-</TITLE>





<P><CENTER>
<a href="0724-0726.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0731-0734.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-727"><P>Page 727</P></A>


<H4><A NAME="ch16_ 11">
Running the Jeeves Server
</A></H4>

<P>After installing Jeeves, you must perform some initial configuration of the server. As
with all servers, a variety of parameters need to be set for proper server operation.
Maintenance of the configuration files is the only drawback of the flexibility of the Jeeves server.
All configuration files are kept in the admin directory. Fortunately, much of this
administrative burden is handled by the AdminServlet.
</P>

<P>The Jeeves server uses a variety of files to set parameters and control its configuration; <BR>
all files are in the Properties class file format.
Properties is a subclass of Hashtable that defines a mechanism to load and store the contents of a
hashtable to a file. Each line in the file corresponds to one key/value entry in a hashtable and is comprised of key
string separated from a value string by the equality (=) character. For example, the server's
TCP port is specified by the following entry:
</P>

<PRE>
server.port=8080
</PRE>

<P>This line is located in the httpd.properties file.
</P>

<P>The Jeeves HTTP server uses the following configuration information to support servlets:
</P>

<UL>
<LI>     Server operational parameters&#151;httpd.properties file
<LI>     Path translation rules&#151;rules.properties file
<LI>     File alias table&#151;aliases.properties file
<LI>     Servlet control and init parameters&#151;servlet.properties file
<LI>     File suffix to MIME type translation&#151;mime.properties file
</UL>

<P>In addition to configuration information directly related to
servlets, the Jeeves HTTP server supports virtual hosting and proxy
operation. Virtual hosting enables the administrator to establish
multiple, logically disjoint HTML document collections on one
physical server. You are probably unaware that different virtual hosts
are served by one physical server unless you closely inspect the
IP address of the servers; compare IP addresses because even the
IP host names of virtual hosts are indistinct. Proxy services
supports operation through a security firewall and provide local caching
for proxied files. This advanced server configuration information
is stored in the following files:
</P>

<BR>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
NOTE
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
The details of server administration are certain to change
as Jeeves evolves into a shipping product. In this section you
learn about the concepts being administered and with less
emphasis on the actual administration mechanisms.
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>


<A NAME="PAGENUM-728"><P>Page 728</P></A>

<UL>
<LI>     Proxy configuration&#151;proxy.properties file
<LI>     Virtual hosting configuration&#151;included in the httpd.properties file
</UL>

<P>The final aspect of server operation is security. In Jeeves, server security is supported by
a complex scheme of security realms, users and groups, and access control lists. The
related files are as follows:
</P>

<UL>
<LI>     Access control lists&#151;acl.properties file
<LI>     General security configuration&#151;security.properties file
<LI>     User and group identification files stored within the realm directory
</UL>

<P>The next section focuses only on the configuration aspects related to servlets and not
the virtual hosting, proxy, and security configuration information.
</P>

<H4><A NAME="ch16_ 12">
Server Operational Parameters
</A></H4>

<P>Most server operational parameters are defined in the &quot;httpd.properties&quot; files. The
major parameters and their function are shown in table 16.3.
</P>

<P>Table 16.3 Server Operational Parameters
</P>

<TABLE>

<TR><TD>
Parameter
</TD><TD>
Function
</TD></TR><TR><TD>
server.port
</TD><TD>
Defines the TCP port number used by
the server. The standard system HTTP server runs on port 80, but 8080 is used as the
default value for user-run servers.
</TD></TR><TR><TD>
server.min.threads/
server.max.threads
</TD><TD>
Define the minimum and maximum number of
threads in use by the server framework to 
handle HTTP requests. If a new request is 
received and all threads are currently busy, a
new thread is created and used to process the
request as long as the number of allocated
threads is less than server.max.threads. Service
threads that have been idle for a period of time
are destroyed until the number of threads
equals server.min.threads. You do not normally
need to change these default values.
</TD></TR><TR><TD>
server.grace
</TD><TD>
Specifies the period of time, in seconds,
that server waits for pending requests to complete before the server closes the connection.
The default value usually provides servlets with more than enough time to complete
their request.
</TD></TR></TABLE>



<A NAME="PAGENUM-729"><P>Page 729</P></A>


<TABLE>

<TR><TD>
Parameter
</TD><TD>
Function
</TD></TR><TR><TD>
ramcache.entry.size
</TD><TD>
Specifies the maximum size of files, in
bytes, that are read into the in-memory file
cache. The default value (8000 bytes) should cover most circumstances. Setting the value to
0 disables operation of the in-memory file cache.
</TD></TR><TR><TD>
keepalive.count
</TD><TD>
Specifies the maximum number of
transactions that can be exchanged over the TCP
connection before the server closes the
connection. This feature is used only for those
connections that include the keep-alive HTTP request
field. Setting the value to 0 disables this feature
and the TCP connection is always closed after the response is sent.
</TD></TR><TR><TD>
keepalive.timeout
</TD><TD>
Specifies the maximum time, in seconds,
that the TCP connection is kept open to accept additional requests. This feature is used
only for those connections that include the keep-alive HTTP request field. The connection
is closed when the keepalive.count is reached or the keepalive.timeout expires.
</TD></TR><TR><TD>
welcome
</TD><TD>
Specifies the file name of the default
welcome file in a directory. The contents of this file
is returned rather than the standard directory display. The default value is index.html.
</TD></TR><TR><TD>
rules.config
</TD><TD>
Defines the file path (directory and file
name) of the property file that defines the rules
that translate a URL to a servlet name. You change this file to add special
URL-to-servlet mappings.
</TD></TR><TR><TD>
aliases.config
</TD><TD>
Defines the file path (directory and file
name) of the property file that defines the file aliases.
</TD></TR><TR><TD>
servlets.config
</TD><TD>
Defines the file path (directory and file
name) of the property file that specifies the
loading and initialization information for all
named servlets loaded at start-up.
</TD></TR><TR><TD>
mime.config
</TD><TD>
Defines the file path (directory and file
name) of the property file that defines the
mapping from file suffix to MIME type. You will
need to change this file only to add an additional suffix to MIME type translation or to
change the extension of the server-side include
files from the default .shtml.
</TD></TR></TABLE>


<A NAME="PAGENUM-730"><P>Page 730</P></A>



<H4><A NAME="ch16_ 13">
Path Translation Rules
</A></H4>

<P>The rules.properties file defines the translation rules for converting an URL request to
the name of the servlet to handle the request. An example file is as follows:
</P>

<PRE>
/=file
/cgi-bin=cgi
/imagemap=imagemap
/servlet=invoker
/admin/adminservlet=admin
/admin/performanceservlet=performance
/admin/servletinfoservlet=servletinfo
/admin/aclServlet=aclServlet
/loganalyzer=loganalyzer
</PRE>

<P>The string to the left of the equals sign (=) is matched against the requested URL;
the longest match, starting from the left of the requested URL, is used in the translation.
The string on the right of the = is the name of the servlet to handle the request. The
string &quot;/&quot; to the left on the first line specifies the default mapping as &quot;file,&quot; which provides the
usual HTTP file and directory service.
</P>

<P>If you want to replace one of the standard, built-in servlets, such as &quot;file,&quot; with your
own custom version, do not change the name of the servlet in the rules.properties file,
but instead change the class to be loaded for the servlet named &quot;file&quot; in the
servlet.properties file. Internally, the server code provides some special processing based on the name of
the servlet. The name in the rules.properties file is treated as a description of the service.
</P>

<H4><A NAME="ch16_ 14">
Alias Table
</A></H4>

<P>Jeeves provides an aliasing mechanism to translate the requested path information
into another string. For files, the FileServlet uses the rules in the alias.properties file to map
the shorthand path name specified in an URL to a full file path name. Use aliases as a way
to accomplish the following:
</P>

<UL>
<LI>     Eliminate typing long URLs
<LI>     Hide your internal directory structure
<LI>     Temporarily fix broken links when reorganizing directories and moving files
</UL>

<P>An example alias.properties file follows:
</P>

<PRE>
/=public_html
/cgi-bin=cgi-bin
</PRE>


<P><CENTER>
<a href="0724-0726.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0731-0734.html">Next</A>
</CENTER></P>






</BODY>
</HTML>



