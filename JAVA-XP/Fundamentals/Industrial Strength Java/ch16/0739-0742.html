<HTML>
<HEAD>


<TITLE>Industrial Strength Java:Jeeves and Java Servlets:EarthWeb Inc.-</TITLE>





<P><CENTER>
<a href="0735-0738.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0743-0745.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-739"><P>Page 739</P></A>


<P><B>
Authentication-Related Information
</B></P>

<P>The servlet can provide some very weak access control by using name and
address information about the client as provided by getHostName() and getHostAddress().
The type of HTTP-level authentication in use is available using getAuthType(). Finally,
for connections running in basic mode, getRemoteUser() returns the user identification:
</P>

<UL>
<LI>     getAuthType(). Returns the authentication scheme of the request, or null if
none (CGI variable AUTH_TYPE).
<LI>     getRemoteUser(). Returns the name of the user making this request; null
is returned if the name is not supplied with the request (CGI's equivalent
is REMOTE_USER).
</UL>

<P><B>
Access to HTTP Request Header Fields
</B></P>

<P>HttpServletRequest provides a means to get direct access to the
HTTP request header fields to get information not explicitly supported by an HttpServletRequest
method. Examples include user-agent, referer, preferred languages, accepted content
encodings, and client-state (cookie) information, as well as all non-standard header fields.
</P>

<P>Instead of using an enumerator, the following two methods to access the raw header
take an index into the header. An index of 0 retrieves the first header field; null is returned
if the index is greater than the number of fields available:
</P>

<UL>
<LI>     getHeader(int). Returns the value of the nth header field; null is returned if
there are fewer than n fields.
<LI>     getHeaderName(int). Returns the name of the nth header field; null is returned
if there are fewer than n fields.
</UL>

<P>You can also access request header fields by name, which happens to be the
easiest approach. In this case, the request header is searched for a matching field name
and returns the field value. Use one of the following methods, depending on the desired
data conversion:
</P>

<UL>
<LI>     getHeader(String
fieldname). Returns the value of a header field; if this
method is not available, null is returned.
<LI>     getIntHeader(String fieldname, int
default). Returns the value of an integer header field after converting the string to an int. If the field is not found, it
returns the default value.
<LI>     getDateHeader(String fieldname, long
default). Returns the value of a date header field after converting the string to a date. If the field is not found, it
returns the default value.
</UL>


<A NAME="PAGENUM-740"><P>Page 740</P></A>


<P><B>
HttpServletResponse Interface Class
</B></P>

<P>The HttpServletResponse is a subclass of ServletResponse and provides the
mechanisms to create an HTTP response header. These mechanisms are used for the following
four purposes:
</P>

<UL>
<LI>     To set the response status.
<LI>     To add arbitrary response header fields.
<LI>     To create an error response.
<LI>     To redirect the request to another URL.
</UL>

<P>Creating normal, error, and redirect responses using the HttpServletResponse object
is described in the following sections.
</P>

<P><B>
Setting the Response Status
</B></P>


<P>The return status defaults are 200 or OK. If an error is returned or OK is not the
correct status, the servlet can specify both an error code and some descriptive text. If only an
error code is given, the code is translated into a standard status text string. The two methods
are as follows:
</P>

<UL>
<LI>     setStatus(statusCode). Sets the status code in the returned HTTP header.
The status code is translated into a text string using a standard definition of arguments.
<LI>     setStatus(statusCode,
messageString). Sets the status code in the returned
HTTP header.
</UL>

<P><B>
Specifying Non-Standard Header Fields
</B></P>

<P>Your servlet can add any field to the response header by using one of the
setHeader() methods, leting you add non-standard header fields not supported
by HttpServletResponse. Provide the name of the header field (without a colon) as the
first argument and the data as the second argument. Variants of setHeader are defined
for String, int, and date parameters. Successive calls to set the same header field overwrite
the previous value and do not add multiple copies of the field. The four methods are
as follows:
</P>

<UL>
<LI>     setHeader(String fieldname,
String). Sets the value of the named header field
to the indicated value.
<LI>     setIntHeader(String fieldname,
int). Sets the value of the named integer header field after converting the value to a string.
</UL>


<A NAME="PAGENUM-741"><P>Page 741</P></A>


<UL>
<LI>     setDateHeader(String fieldname,
long). Set the value of the named date field after converting the long into an Internet-standard date-time string.
<LI>     unsetHeader(String
fieldname). Removes the named header field from
the response.
</UL>

<P><B>
Returning Error Responses
</B></P>

<P>HttpServletResponse provides two methods to create and send standard error
responses. To return an error, your servlet calls sendError() with a status code and possibly
an explanatory message. The page is titled and has a header that indicates the status code
and a standard text message based on the status code. The optional explanatory message
is inserted into the body of the returned page. Calling sendError(404, &quot;Couldn't find
it!&quot;) would create a returned page that has a title and H1 header of &quot;404 Not Found&quot;
and &quot;Couldn't find it!&quot; as the text. These methods are
</P>

<UL>
<LI>     sendError(int). Sends an error response to the client using the specified
status code and no explanatory message.
<LI>     sendError(int,
String). Sends an error response to the client using the
specified status code and detailed explanatory message.
</UL>


<P><B>
Returning Redirect Response
</B></P>

<P>HttpServletResponse also provides a method to create and send a standard
redirect response. Calling sendRedirect() creates and sends a &quot;302&quot; (Moved Temporarily)
response. Pass a string that indicates the new location of the page. The string should be
a URL because it is placed in the returned page as a link. However, sendRedirect() does
not check to see whether the string is a correctly formatted URL. If you have a URL
object already, convert it to a string using toString() before calling sendRedirect(). This
method, sendRedirect(String), sends a redirect response to the client using the specified
redirect location URL.
</P>

<P><B>
FormServlet Class
</B></P>

<P>The FormServlet class is the only servlet class that is specified as part of the Servlet
API, and hence it is available in all web servers that support servlets. Build forms
processing servlets by subclassing FormServlet and overriding the sendResponse() method.
The sendResponse() method handles form information and generates a response. As a
subclass of HttpServlet, the following methods are defined for the FormServlet:
</P>

<UL>
<LI>     getServletInfo(). Override this method to return a String containing
information 
</UL>


<A NAME="PAGENUM-742"><P>Page 742</P></A>


<UL>
(such as author and version) about your servlet.
<LI>     service(HttpServletRequest, HttpServletResponse). If special request processing is required, override this method in your servlet.
<LI>     sendResponse(HttpServletResponse, Hashtable). Override this method to supply code to process the form and generate a response.
</UL>

<P>An example construction of your own form processing servlet is provided in
&quot;Handling HTML Forms.&quot;
</P>

<P><B>
HttpUtils Class
</B></P>

<P>The HttpUtils class is a set of static utility routines useful in building servlets. In
Jeeves Alpha 2, the only method defined is parseQueryString(String). This method builds
a Hashtable of name/value pairs based on parsing a query string. Your servlet can use
the name (as the key) in the Hashtable.get() method to retrieve the value string.
</P>

<H4><A NAME="ch16_ 20">
The java.servlet.html Package
</A></H4>

<P>The third package that defines the Servlet API is java.servlet.html. This package
includes 13 HTML support classes that provide operations for assembling HTML elements such
as tables, imagemaps, and forms. From these elements, you can build an HTML page as
a hierarchical list of HTML commands and text elements, and then you can write out
the completed page to a ServletOutputStream. The
classes are as follows:
</P>

<UL>
<LI>     HtmlElement. Supports the basic interface definition
<LI>     HtmlText. Supports text enclosed by tags
<LI>     HtmlContainer. Supports a list of HtmlElements enclosed by tags
<LI>     HtmlApplet.
Supports the applet HTML tag with width and height specification
<LI>     HtmlChoice.
Supports the select HTML tag
<LI>     HtmlDefinitionList. Supports the dl, dt, and dd HTML tags
<LI>     HtmlForm. Supports building HTML forms comprised of input fields,
check boxes, radio buttons, text areas, selections, and submit buttons
<LI>     HtmlFrameset. Supports frameset HTML tag
<LI>     HtmlImageMap. Supports client-side image map HTML tags
<LI>     HtmlList. Supports the ul and ol HTML list tags
<LI>     HtmlPage. Supports building a web page comprised of a header and body areas
</UL>

<P><CENTER>
<a href="0735-0738.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0743-0745.html">Next</A>
</CENTER></P>






</BODY>
</HTML>



