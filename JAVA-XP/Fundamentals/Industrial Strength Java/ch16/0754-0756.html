<HTML>
<HEAD>


<TITLE>Industrial Strength Java:Jeeves and Java Servlets:EarthWeb Inc.-</TITLE>





<P><CENTER>
<a href="0750-0753.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="..\ch17\0757-0760.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-754"><P>Page 754</P></A>


<P>If the status is 404, you use the URL request string to lookup a list of potential matches
by calling getAlternates(). If no alternates are found, call super.service() for the standard
error reply as shown in the following code:
</P>

<PRE>
String request = req.getRequestURI();
Vector alternates = getAlternates(request);
if (alternates.isEmpty()) {
  super.service(req, res);
  return;
}
</PRE>

<P>The getAlternates() method returns a Vector of URL strings that are similar to the
requested URL. This method might reference a hand-generated table, consult an
automatically generated site index, or perform a real-time search of the file system; the
exact mechanism is not defined for this example. The intent is to present a list of candidate
links to the user. You can then construct the reply page with this information as shown in
the following code:
</P>

<PRE>
res.setContentType(&quot;text/html&quot;);
res.setDateHeader(&quot;Date&quot;, System.currentTimeMillis());
ServletOutputStream out = res.getOutputStream();
HtmlPage page = new HtmlPage(&quot;404 File not Found&quot;);
page.add(&quot;404 - File not found&quot;, &quot;h1&quot;);
page.add(&quot;The file &lt;strong&gt;&quot; + request + &quot;&lt;/strong&gt; was not found. &quot;);
page.add(&quot;You may have misspelled the URL or the file has moved. &quot;);
page.add(&quot;Here is a list of possible links that are similar to your
&Acirc;original request:&quot;);
</PRE>

<P>After adding the initial message to the error reply page, construct a table of links to
the candidate documents. When the table is complete, add it to the page and write the
page's HTML to the ServletOutputStream. The first write to the ServletOutputStream causes
the response header to be written to the ServletOutputStream. The following code
completes the definition of the service() method:
</P>

<PRE>
HtmlTable tbl = new HtmlTable();
Enumeration enum = alternates.elements();
while (enum.hasMoreElements()) {
  String link = (String)(enum.nextElement());
  tbl.newRow();
  tbl.addData(new HtmlText(link, &quot;a href=&quot; + link));
}
page.add(tbl);
</PRE>


<A NAME="PAGENUM-755"><P>Page 755</P></A>


<PRE>
page.write(out);
}
</PRE>

<P>The getAlternates() method is called to build a list of alternate URLs for the indicated
file. The exact technique for constructing this list is undefined in this example. Depending
on your application, this method could reference a manually constructed file or perform
a search for similar file names. The following code is only the shell of the method:
</P>

<PRE>
  Vector getAlternates(String file) {
  Vector v = new Vector();
     .
     .
     .
  return v;
  }

}
</PRE>

<P>This completes the definition of the NewErrorServlet class.
</P>

<H3><A NAME="ch16_ 27">
Summary
</A></H3>

<P>The Jeeves Alpha 2 release covered in this chapter is just a beginning step toward
defining a radically new architecture for server software. Taken to its logical conclusion,
servlets can evolve into the server-side equivalent of application components, and Jeeves
can become the future of server software component architecture&#151;a Java Beans for the
server. This new architecture goes beyond simply replacing CGI programs to completely
changing server implementations. Jeeves shows how an HTTP server can be remolded to
use servlets to significantly increase flexibility and customization. As the servlet
technology matures, more standard servlets will be defined, such as standard servlet bridges
to databases, and new server-side technologies, such as JDBC, will be first introduced
as servlets.
</P>


<A NAME="PAGENUM-756"><P>Page 756</P></A>



<P><CENTER>
<a href="0750-0753.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="..\ch17\0757-0760.html">Next</A>
</CENTER></P>






</BODY>
</HTML>



