<HTML>
<HEAD>


<TITLE>Industrial Strength Java:Jeeves and Java Servlets:EarthWeb Inc.-</TITLE>





<P><CENTER>
<a href="0709-0711.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0717-0720.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-712"><P>Page 712</P></A>


<P>Java's Servlet API has a significant advantage over CGI in terms of performance,
transport independence, and security. The differences between servlets and CGI are
highlighted in table 16.2. The use of servlets for all web server operations makes a very powerful
and flexible web platform. For example, server administrators can easily augment the
file serving servlet to collect statistics on files requested or track user information, or
augment the error response servlet to specialized error messages.
</P>

<P>Table 16.2
</P>

<P>Comparison of Servlet API and CGI
</P>

<TABLE>

<TR><TD>
</TD><TD>
Servlet
</TD><TD>
CGI
</TD></TR><TR><TD>
Language
</TD><TD>
Java
</TD><TD>
Any programming language
</TD></TR><TR><TD>
Invocation
</TD><TD>
Direct method call
</TD><TD>
Run program
</TD></TR><TR><TD>
Parameters
</TD><TD>
ServletRequest methods
</TD><TD>
Environment variables
</TD></TR><TR><TD>
Runtime Checks
</TD><TD>
Java Virtual Machine
</TD><TD>
Language specific
</TD></TR><TR><TD>
Security
</TD><TD>
Java Security Manager
</TD><TD>
Operating system specific
</TD></TR></TABLE>

<H4><A NAME="ch16_ 5">
Servlet API Overview
</A></H4>

<P>Briefly, the Java Servlet API is comprised of three packages that define
high-level functionality, HTTP-specific support, and dynamic HTML creation support. You
can assume these packages are available on any server platform supporting servlets.
</P>

<P>The java.servlet package contains classes that define the high-level servlet
functionality independent from the details of using HTTP for transport. These
classes are as follows:
</P>

<UL>
<LI>     Servlet
<LI>     GenericServlet
<LI>     ServletContext
<LI>     ServletInputStream
<LI>     ServletOutputStream
<LI>     ServletRequest
<LI>     ServletResponse
</UL>

<P>The java.servlet.http package contains subclasses of the generic classes in java.servlet
and an HTTP-specific utilities class. You use these classes in building servlets that
specifically support HTTP. These classes are as follows:
</P>

<UL>
<LI>     HttpServlet
<LI>     HttpServletRequest
</UL>

<A NAME="PAGENUM-713"><P>Page 713</P></A>



<UL>
<LI>     HttpServletResponse
<LI>     FormServlet
<LI>     HttpUtils
</UL>

<P>The java.servlet.html package contains 13 HTML support classes that provide
operations for assembling HTML elements such as tables, imagemaps, and forms. These classes
are as follows:
</P>

<UL>
<LI>     HtmlApplet
<LI>     HtmlChoice
<LI>     HtmlContainer
<LI>     HtmlDefinitionList
<LI>     HtmlElement
<LI>     HtmlForm
<LI>     HtmlFrameset
<LI>     HtmlImageMap
<LI>     HtmlList
<LI>     HtmlPage
<LI>     HtmlRow
<LI>     HtmlTable
<LI>     HtmlText
</UL>

<P>Together, these three packages define the Servlet API and form the basis for
building servlets. These packages are covered in more detail in &quot;The Servlet API,&quot; later in
this chapter. Of course, web servers that support servlets are likely to offer
vendor-specific classes in addition to these standard ones. The HTTP server included in the
Jeeves package has its own set of JavaSoft-specific classes (such as the sun.server.*
and sun.security.* packages). These vendor-specific packages provide additional support
for implementing servlets beyond the basic API. The JavaSoft classes provide support
for additional security mechanisms, regular expression parsing, and cache file
handling, among others.
</P>


<A NAME="PAGENUM-714"><P>Page 714</P></A>


<H3><A NAME="ch16_ 6">
Jeeves at Your Service
</A></H3>

<P>JavaSoft supports the Servlet API as part of its
Jeeves server development package. Designed to simplify the construction of network services software, Jeeves has three
main elements:
</P>

<UL>
<LI>     A set of JavaSoft-specific classes for building servers and advanced servlets.
This extensive set of classes (most are not externally documented) are found in
the sun.server and sun.security packages.
<LI>     A complete HTTP server written in Java that extensively uses the
JavaSoft-specific packages. The server provides a first implementation of the Servlet API
and demonstrates the practicality of using built-in servlets for all server functions.
<LI>     A set of classes for implementing servlets that utilize HTTP. These classes are
in the java.servlet packages and define the Servlet API.
</UL>

<H4><A NAME="ch16_ 7">
Server Construction Toolkit
</A></H4>

<P>To enable the construction of high-performance servers using Java, Jeeves defines a
server framework that manages multiple network connections, service threads, and
client handlers. This framework is used to build connection-oriented (TCP-based) servers
that use multiple threads to handle concurrent client connections. These server
construction classes are part of the sun.server package and include Server, ServerHandler,
and ServerParameters. Jeeves only supports TCP as the transport protocol; no support
is provided in Jeeves for implementing UDP-based servers.
</P>

<P>A Jeeves-based server has a main thread that accepts incoming connections on
a ServerSocket, deploys the actual service processing to a handler thread, and loops back
to accept additional connections. The handler threads are allocated from a pool of
service threads to reduce the overhead of thread allocation for each request. By using a
different thread to handle each connection, the server can service several clients
concurrently. Server connection processing and request handling is shown in figure 16.1. The
framework classes have been optimized to reuse objects and thus avoid object creation
and garbage collection overhead.
</P>


<A NAME="PAGENUM-715"><P>Page 715</P></A>



<P><a href="images\ch16fg01.jpg"><img src="images\tn_ch16fg01.jpg"></a><BR>
Figure 16.1 Server request handling.
</P>

<H4><A NAME="ch16_ 8">
Jeeves HTTP Server Overview
</A></H4>

<P>The Jeeves HTTP server uses the server construction toolkit. A main thread listens on
an administrator-configured TCP port for incoming HTTP requests. Each request is
dispatched to a separate service thread to process the request. To handle a request, the
HTTP server carries out the following:
</P>

<OL>
<LI>     Creates an HttpServletRequest object from the information in the HTTP
request header.
<LI>     Applies the path translation rules from the rules.properties file to convert the
URL into the name of the appropriate servlet. All URLs are converted into a
servlet name; the longest matching rule is used to perform the translation.
<LI>     Verifies access permission to the resource according to the information in
the acl.properties file.
<LI>     Translates the servlet name according to the information in the
servlet.properties file into a full pathname, such as URL, codebase, or class name information
which specifies how to load the servlet.
<LI>     Loads and, if necessary, initializes the servlet. Every HTTP request either
invokes a servlet or returns an error.
<LI>     Creates an HttpServletResponse object with basic response information such as
the server identification and current time.
</OL>

<A NAME="PAGENUM-716"><P>Page 716</P></A>


<OL START="7">
<LI>     Calls the servlet's service() method passing the request and response objects
as arguments.
<LI>     Completes the transaction by ensuring that the response is sent and, if
appropriate, that the connection is closed.
</OL>

<P>Because servlets can be identified by a full URL, servlets can be downloaded from
the network, similar to applets, and executed on the server. These steps are described in
the following sections.
</P>

<P><B>
Creating the HttpServletRequest
</B></P>

<P>The server creates an HttpServletRequest object to store all the information about
the HTTP request. This object's methods provide access to all the fields in the HTTP
header and supply information about the TCP connection. The HttpServletRequest
object performs the same functions as the environment variables used to communicate
request information to CGI programs.
</P>

<P><B>
Translating the URL to Servlet Name
</B></P>

<P>In Jeeves, all URL requests either implicitly or explicitly refer to a servlet. The
mapping of URL to servlet name is determined by using a translation table defined by
the rules.properties file. This file contains entries such as
</P>

<PRE>
/=file
/servlet/special=myservlet
/servlet=invoker
/admin/adminservlet=admin
</PRE>

<P>The string to the left of the equals sign (=) is matched against the requested URL;
the longest match starting from the left of the request URL is used in the translation.
The string to the right of the = is the name of the servlet that handles the request; this name
is subsequently mapped into the servlet's codebase and class name. The string
&quot;/&quot; to the left specifies the default mapping as &quot;file,&quot; which provides the usual HTTP file service.
</P>

<P>Explicitly invoke a servlet by using an URL such as /servlet/counter. This URL is
actually mapped to a reference to the invoker servlet (matching the &quot;/servlet&quot; translation rule)
that takes the rest of the URL as the name of the servlet to execute. In this example, the URL<BR>
/servlet/special is mapped to myservlet rather than invoker. This
mapping of file names or directory paths to servlets is the basis for dynamic content.
</P>


<P><CENTER>
<a href="0709-0711.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0717-0720.html">Next</A>
</CENTER></P>






</BODY>
</HTML>



