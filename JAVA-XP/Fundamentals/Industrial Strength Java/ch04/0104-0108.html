<HTML>
<HEAD>


<TITLE>Industrial Strength Java:Applets:EarthWeb Inc.-</TITLE>





<P><CENTER>
<a href="0099-0103.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0109-0111.html">Next</A>
</CENTER></P>

<A NAME="PAGENUM-104"><P>Page 104</P></A>


<P>Listing 4.5aContinued
</P>

<PRE>
  //called when the applet is loaded
      public void init() {
            //get the bark
            bark = getAudioClip(this.getDocumentBase(), &quot;audio
                          &Acirc;bark.au&quot;);

            //get the image
            shaker1 = this.getImage(this.getDocumentBase(), &quot;gifs
                          &Acirc;shaker.gif&quot;);
            theTracker = new MediaTracker(this);

            //add the image to the MediaTracker object
            theTracker.addImage(shaker1, 0);

            //halt execution until after the image is fully loaded.
            //Users expect a slight wait when the applet is loading, but
            //do not expect one when a button is clicked.
            try{      theTracker.waitForID(0); }
            catch(   InterruptedException ie) { showStatus(&quot;error
                          &Acirc;loading image&quot;); }
            //draw the screen
            Panel buttonPanel = new Panel();
            buttonPanel.setLayout(new GridLayout(4, 1, 20, 20));
            buttonPanel.add(new Button(&quot;See Shaker Pics&quot;));
            buttonPanel.add(new Button(&quot;Hear Shaker&quot;));
            buttonPanel.add(new Button(&quot;Read His Bio&quot;));
            buttonPanel.add(new Button(&quot;Links To Other Dog Sites&quot;));

            //add the buttons to the actual screen
            this.add(buttonPanel);
      }
</PRE>

<P>In listing 4.5b are the methods called when different buttons are clicked. The
action() method in listing 4.5c calls each of these methods when the user requests it.
</P>

<P>Listing 4.5bMethods that Control the Web Browser as Instructed by the User
</P>

<PRE>
      //create a new window and show a shaker picture
      public void showShaker() {
            Frame pictureFrame = new ImageFrame(&quot;Shaker&quot;, shaker1);
            pictureFrame.show();
      }
</PRE>


<A NAME="PAGENUM-105"><P>Page 105</P></A>


<PRE>
      //play the .au file of shaker barking
      public void bark() {
            bark.play();
      }

      //display Shaker's bio in the bottom frame
      public void showBio() {
            try{      URL newLocation = new URL(getDocumentBase(),
                           &Acirc;&quot;bio.html&quot;);
                      this.getAppletContext().showDocument(newLocation,
                                                 &Acirc;&quot;information&quot;);
                  }
            catch(Exception e) { this.showStatus(&quot;ERR: Issues With File&quot;); }
      }
      //display Shaker's bio in the bottom frame
      public void showLinks() {
            try{     URL newLocation = new URL(getDocumentBase(),
                           &Acirc;&quot;links.html&quot;);
                     this.getAppletContext().showDocument(newLocation,
                                               &Acirc;&quot;information&quot;);
                  }
            catch(Exception e) { this.showStatus(&quot;ERR: Issues With File&quot;); }
      }
</PRE>

<P>The code in listing 4.5b traps the event that is sent when a user clicks on a button.
A method associated with each button is called when the the click occurs.
</P>

<P>Listing 4.5cCalling the Method Associated with Each Button
</P>

<PRE>
      //deal with client clicks
      public boolean action (Event evt, Object arg) {
            if (&quot;See Shaker Pics&quot;.equals(arg)) {
                  this.showShaker();
                  return true;
            }
            else if (&quot;Hear Shaker&quot;.equals(arg)) {
                  this.bark();
                  return true;
            }
            else if (&quot;Read His Bio&quot;.equals(arg)) {
                  this.showBio();
                  return true;
</PRE>
<PRE>
                                                           continues
</PRE>

<A NAME="PAGENUM-106"><P>Page 106</P></A>


<P>Listing 4.5cContinued
</P>

<PRE>
            }
            else if (&quot;Links To Other Dog Sites&quot;.equals(arg)) {
                  this.showLinks();
                  return true;
            }
            return false;
      }
}
</PRE>

<P>Listing 4.5d creates a class that will display an image in a frame.
</P>

<P>Listing 4.5dCode to Display an Image in a Frame
</P>

<PRE>
//will create a new Frame displaying an image
class ImageFrame extends Frame {
      Image theImage;

      public ImageFrame(String title, Image newImage) {
            super(title);
            theImage = newImage;
            this.resize(125, 100);
      }

      public boolean handleEvent(Event e) {
            if(e.id == Event.WINDOW_DESTROY) {
                  this.hide();
                  return true;
            }
            return super.handleEvent(e);
      }

      public void paint(Graphics g) {
            g.drawImage(theImage, 0, 0, this);
      }
}
</PRE>

<P>Figure 4.3 illustrates the applet in action. Note the warning attached to the
spawned window.
</P>

<H3><A NAME="ch04_ 9">
Applet Frameworks
</A></H3>

<A NAME="PAGENUM-107"><P>Page 107</P></A>


<P><a href="images\ch04fg03.jpg"><img src="images\tn_ch04fg03.jpg"></a><BR>
Figure 4.3 The listing 4.5 applet in action, as viewed in Netscape 3.0
for the MacOS.
</P>

<P>So far, now that you have witnessed the development of two
applets, you probably want to create applets of your own. To facilitate
your development, this next section examines the two basic forms that
an applet can take: a single-threaded model and a multithreaded model.
</P>

<H4><A NAME="ch04_ 10">
The Single-Threaded Applet Model
</A></H4>

<P>Although this book has not covered threads yet,
you are probably familiar with them. If you think of a thread as a task that executes
on its own, you understand the basic concept. An application that
must process multiple requests at the same time simply spins each task
onto a separate thread. Usually, you will develop multithreaded
applets (and applications), but at times you must create a
quick-and-dirty applet that does not require the power of threads. The two
applets created in the beginning of this chapter are examples of these
single-threaded applets.
</P>

<P>Certain structural methods are defined by the applet's parent or interface, and
these methods control the execution of the applet. Other methods exist that your applet
should support to provide particular functionalities. The following list details the suite of
methods required by a single threaded applet:
</P>

<BR>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
NOTE
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
Due to a bug in Netscape's implementation of Java,
the spawned window on the Macintosh will not correctly display
the image. As a work-around, you may want to force a redraw
of the image when the frame is resized.
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>

<A NAME="PAGENUM-108"><P>Page 108</P></A>



<UL>
<LI>     init()
<LI>     start()
<LI>     stop()
<LI>     destroy()
<LI>     paint()
<LI>     action()
<LI>     handleEvent()
</UL>

<P><B>
The init() Method
</B></P>

<P>The init() method basically serves as an applet's form of
constructor and is called when you initialize the applet. It is here that you
will want to perform any initialization code that your applet may
require. Listing 4.5a, for example, used the init() method to load the sound
and image files. The listing also used this method to draw your
screen. Placing code from 4.5a in the init() method assures that,
before anything else can happen in the applet, the screen,
image, and sound files are ready to go.
</P>

<P><B>
The start() Method
</B></P>

<P>After an applet finishes with the init() method, it is ready to begin
its full course of execution. Execution begins in the start() method,
and from there you can branch to any other methods or classes. The
only way to alter this flow of execution is to design your applet
to respond to events. The ShakerNET applet developed in listing
4.5 classifies as such an applet. In fact, this applet did nothing
beyond drawing the initial screen until the user took some action.
</P>

<P><B>
The action() and handleEvent() Methods
</B></P>

<P>If your applet responds to any type of user events, you must
support either the action() or handleEvent() methods, depending on
the requirements of your applet.
</P>

<P>When an event is generated by a user, that event is sent to the handleEvent()
method contained in the component that the event occurred in. handleEvent() acts as a
dispatcher and will pass most events on to action(). It is commonplace for an applet to
override 
</P>

<BR>
<P>

<CENTER>
<TABLE BGCOLOR="#FFFF99">
<TR><TD><B>
NOTE
</B></TD></TR>
<TR><TD>
<BLOCKQUOTE>
Sound and image files set up using the getAudioClip()
and getImage() methods (respectively) are not loaded into
memory. The applet instead  checks that the files actually exist
where you indicate. In the case of the image file, loading was
forced with the aid of the MediaTracker class. At some point in
the future, Sun claims that this class will be modified to deal
with audio files, but at this point, no easy way exists to force
audio files to load into memory.
</BLOCKQUOTE></TD></TR>
</TABLE></CENTER>
</P>

<P><CENTER>
<a href="0099-0103.html">Previous</A> | <a href="..\ewtoc.html">Table of Contents</A> | <a href="0109-0111.html">Next</A>
</CENTER></P>






</BODY>
</HTML>



