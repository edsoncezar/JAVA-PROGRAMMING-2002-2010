<html>

<head><meta http-equiv="pragma" content="no-cache">

<meta NAME="GENERATOR" CONTENT="Internet Assistant for Microsoft Word 2.0z">
<title>15.3 The LinkedList constructor and add() actions</title>

</head>

<body BGCOLOR="WHITE">

<h2>15.3 The LinkedList constructor and <i>add()</i> actions.<br>
</h2>

<p>
The implementation of the <i>LinkedList</i>
class, as far as the end of the constructor, is as follows. <br>

<pre>
0001  // Filename <i>LinkedList.java</i>.
0002  // Class to implement the <i>OrderedStructure</i> interface
0003  // making use of the a single linked list. 
0004  //
0005  // Written for JFL book, chapter 14.
0006  // Fintan Culwin, v0.1, August 1997.
0007  
0008  
0009  <b>package</b> <i>Generics</i>;
0010  
0011  <b>import</b> <i>Generics.GenericStructure</i>;
0012  <b>import</b> <i>Generics.GenericException</i>;
0013  <b>import</b> <i>Generics.OrderedStructure</i>;
0014  <b>import</b> <i>AlreadyPresentException</i>;
0015  
0016  <b>import</b> java.util.Enumeration;
0017  <b>import</b> java.util.NoSuchElementException;
0018  <b>import</b> java.lang.ArrayIndexOutOfBoundsException;
0019  
0020  <b>public class</b> <i>LinkedList</i> <b>extends</b>     <i>GenericStructure</i>
0021                          <b>implements</b>  <i>OrderedStructure</i>{ 
0022  
0023  <b>private</b> <i>ListNode</i> <i>theList          </i>= <b>null</b>;
0024  <b>private</b> <b>int</b>      <i>numberOfElements</i> = 0;
0025  
0026  
0027     <b>public</b> <i>LinkedList</i>( Class <i>theElementClass</i>) { 
0028        <b>super</b>( <i>theElementClass</i>);     
0029     } // end <i>LinkedList</i> constructor.<br>

</pre>

<p>
This implementation is very similar to that of the <i>OrderedList</i>
presented in the previous chapter. There is no need for this class
to import the Vector class and
this has been removed from the list of imported classes. On line
0023, the data attribute <i>theList</i>
is implemented as an instance of the <i>ListNode</i>
class and will be used as the first node of the linked list. The
default <b>null</b> value of
<i>theList</i> is confirmed in
the listing emphasising that the list is currently empty.<br>

<p>
In order to maintain a count of the number of elements in the
structure an <b>int</b>eger <i>numberOfElements</i>
attribute, with the initial value 0, is declared on line 0024.
The constructor is implemented as a call of its parent, <i>GenericStructure</i>,
constructor to record the class of elements which can be stored
in the structure.<br>

<p>
The design of the <i>add()</i>
action is as follows. <br>

<p>
<center><img SRC="c15p3i1.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter15/c15p3i1.gif" WIDTH="594" HEIGHT="531">
</center>
<p>
The easiest way to explain this design is to present its implementation
and then to trace through the implementation as elements are added
to the list. The implementation of this design is as follows.
<br>

<pre>
0033     <b>public void add</b>( <i>Keyable</i>   <i>toAdd</i>) {
0034  
0035     <i>Orderable</i>  <i>keyToAdd     </i>= <i>toAdd.keyvalueis()</i>;
0036     <i>Orderable</i>  <i>nextKeyValue </i>= <b>null</b>;
0037     <i>ListNode</i>   <i>newNode</i>      = <b>new</b> <i>ListNode</i>( <i>toAdd.copy()</i>, <b>null</b>);
0038     <i>ListNode</i>   <i>thisNode     </i>= <b>null</b>;
0039     <i>ListNode</i>   <i>nextNode</i>     = <b>null</b>;
0040 
0041        <b>if</b> ( !<i>isAcceptableElement</i>( <i>toAdd</i>) ){ 
0042           <b>throw new</b> <i>GenericException</i>();
0043        } <b>else</b> {      
0044           <b>if</b> ( <b>this</b><i>.isEmpty</i>()) {
0045              <i>theList</i> = <i>newNode</i>;
0046              <i>numberOfElements</i>++;
0047           } <b>else</b> {
0048               <b>if</b> ( <i>keyToAdd.keyIsLessThan</i>(
0049                            <i>theList.dataIs</i>().<i>keyValueIs</i>()) ){          
0050                  <i>newNode.setNextNode</i>( <i>theList</i>);
0051                  <i>theList</i> = <i>newNode</i>;
0052                  <i>numberOfElements</i>++;
0053               } <b>else</b> {
0054                  <i>thisNode</i>     = <i>theList</i>;
0055                  <i>nextNode</i>     = <i>thisNode.nextIs</i>();         
0056                  <b>if</b> ( <i>nextNode</i> != null ) {            
0057                     <i>nextKeyValue</i> = <i>nextNode</i>.<i>dataIs</i>().<i>keyValueIs</i>();
0058                  } <b>else</b> {            
0059                     <i>nextKeyValue</i> = <b>null</b>;
0060                  } // End if. 
0061                  <b>while</b>( (<i>nextKeyValue</i> != <b>null</b>)                     &amp;&amp;
0062                         (!(<i>keyToAdd.keyIsLessThan</i>( <i>nextKeyValue</i>))) ){ 
0063                     <i>thisNode</i> = <i>nextNode</i>;
0064                     <i>nextNode</i> = <i>thisNode.nextIs</i>();
0065                     <b>if</b> ( <i>nextNode</i> != <b>null</b>) { 
0066                        <i>nextKeyValue</i> = <i>nextNode.dataIs</i>().<i>keyValueIs</i>();
0067                     } <b>else</b> { 
0068                        <i>nextKeyValue</i> = <b>null</b>;
0069                     } // End if.              
0070                  } // End while.
0071                  <b>if</b> ( (<i>nextKeyValue</i> != <b>null</b>)  &amp;&amp;
0072                       (<i>keyToAdd.keyIsEqualTo</i>( <i>nextKeyValue</i>)) ){         
0073                     <b>throw new</b> AlreadyPresentException();
0074                  } <b>else</b> { 
0075                       <i>thisNode.setNextNode</i>( <i>newNode</i>);  
0076                       <i>newNode.setNextNode</i>(  <i>nextNode</i>);
0077                       <i>numberOfElements</i>++; 
0078                  } // End if.
0079               } // End if before existing.
0080           } // End if empty list.             
0081        } // End if unacceptable.
0082     } // End add.<br>

</pre>

<p>
Assuming that <i>theList</i>
is initially empty and the <i>add()</i>
action is called to add an element whose e-mail key value is <i>geek@nowhere.edu</i>,
the state of the action at line 0040 can be visualised as shown
in Figure 15.5. <br>

<p>
<center><img SRC="c15p3i2.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter15/c15p3i2.gif" WIDTH="605" HEIGHT="154"></center>
<br>
<center>Figure 15.5 The list before adding <i>geek@nowhere.edu</i>.
<br>
</center>
<p>
This diagram shows, on the left, the encapsulated data attributes,
<i>numberOfElements</i> which
has the value 0 and <i>theList</i>
which is currently empty. To the right are the four local variables,
of which only <i>newNode</i>
has been initialised as shown with a copy of the element <i>toAdd</i>.
On the far right the arguments to the action are shown.<br>

<p>
Assuming that the class of <i>toAdd</i>
is deemed acceptable on line 0041 the condition on line 0044 should
evaluate <b>true</b> as the list
contains no elements. This will cause the lines 0045 and 0046
to be executed which will cause the state of the attributes to
change to that shown in figure 15.6. As the <b>if</b>
condition on line 0044 was <b>true</b>
control will pass to the end of the <b>if</b>
structure on line 0080 and the action will terminate. <br>

<p>
<center><img SRC="c15p3i3.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter15/c15p3i3.gif" WIDTH="302" HEIGHT="71"></center>
<br>
<center>Figure 15.6 The list's data attributes after adding <i>geek@nowhere.edu.</i></center>
<p>
A second call of the <i>add()</i>
action, adding an element whose e-mail address is sad@lost.org,
will be traced. On this occasion the test on line 0041 will again
be <b>false</b> and the test
on line 0044 will be <b>false</b>
causing the statements starting on line 0048 to be executed. The
test on lines 0048 and 0049 uses the <i>keyIsLessThan()</i>
action of the <i>keyToAdd Keyable</i>
object. The argument to this action is the key value of the data
stored in the <i>theList</i>
node. This effectively compares <i>sad@lost.org</i> with <i>geek@nowhere.edu</i>
and will evaluate <b>false</b>
as <i>sad</i> is not alphabetically less than <i>geek</i>.<br>

<p>
Execution of the statements on lines 0054 to 0060 will produce
the situation shown in Figure 15.7. Line 0054 causes <i>thisNode</i>
to have the same value as <i>theList</i>,
and as the link in <i>theList</i>
does not connect it to another node the execution of line 0055
will not initialise <i>nextNode</i>.
The test on line 0056 will be false as <i>nextNode</i>
is uninitialised (<b>null</b>)
and so the value of <i>nextKeyValue</i>
will remain <b>null</b>.<br>

<p>
<center><img SRC="c15p3i4.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter15/c15p3i4.gif" WIDTH="551" HEIGHT="182"></center>
<br>
<center>Figure 15.7 The list from Figure 15.5 during the addition of <i>sad@lost.org</i>.<br>
</center>
<p>
The compound condition, controlling the <b>while</b>
loop, on lines 0061 to 0062 will commence by evaluating the first
term, <i>nextKeyValue</i>&nbsp;!=&nbsp;<b>null</b>.
As <i>nextKeyValue</i> is <b>null</b>
this will be <b>false</b> and
as <b>false</b> and anything
will always be <b>false</b> Java
will not evaluate the second term on line 0062. This is fortunate
as it would attempt to apply the <i>keyIsLessThan()</i>
action to a <b>null</b> argument
which would cause an exception to be thrown. As the <b>while</b>
loop condition is <b>false</b>
the loop will not iterate and the condition on line 0071 will
be evaluated. This is a check to make sure that an attempt is
not being made to add an element whose key is already in the list
and will evaluate <b>false</b>.
<br>

<p>
The statements on lines 0075 to 0077 cause the new node to be
added to the list. The statement on line 0075 causes the link
value of <i>thisNode</i> to point
to the <i>newNode</i>. As <i>theList</i>
and <i>thisNode</i> both refer
to the same object this will cause the value of <i>theList</i>
to change, effectively causing it to link itself to the <i>newNode</i>.
The situation after line 0077 has executed and the action has
terminated is shown in Figure 15.8.<br>

<p>
<center><img SRC="c15p3i5.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter15/c15p3i5.gif" WIDTH="271" HEIGHT="134"></center>
<br>
<center>Figure 15.8 The list from Figure 15.6 after the addition of <i>sad@lost.org</i>.<br>
</center>
<p>
Next, considering the addition of <i>anorak@boring.com</i>. This
will cause the condition on line 0048 to evaluate <b>true</b>
as <i>anorak</i> is alphabetically less than <i>geek</i>. The
statement on line 0050 will cause the link in the <i>newNode</i>
to connect it to <i>theList</i>,
and through it to the rest of the list. The execution of line
0051 will cause <i>theList</i>
to take the value of <i>newNode</i>
which, following the execution of line 0052, will produce the
situation shown in Figure 15.9.<br>

<p>
<center><img SRC="c15p3i6.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter15/c15p3i6.gif" WIDTH="271" HEIGHT="205"></center>
<br>
<center>Figure 15.9 The list from Figure 15.8 after the addition of <i>anorak@boring.com</i>.<br>
</center>
<p>
The addition of <i>zzz.snooze.com</i> will cause the while loop
condition on line 0061 to be evaluated. On this occasion <i>nextKeyValue</i>
will not be <b>null</b> as line
0055 will cause <i>nextNode</i>
to refer to the node linked to <i>thisNode</i>,
that is the the <i>geek</i> node, and subsequently line 0057 will
cause <i>nextKeyValue</i> to
take the value <i>geek@nowhere.edu</i>. As the term on line 0061
is <b>true</b> the second term,
on line 0062, will be evaluated comparing <i>zzz</i> with <i>geek</i>
and evaluating <b>true</b>. 
<br>

<p>
The loop will iterate causing the <i>thisNode</i>
link to refer to the <i>geek</i> node and <i>nextNode</i>
to refer to the <i>sad</i> node. The <b>if</b>
condition in line 0065 will be <b>true</b>
and line 0066 will cause <i>nextKeyValue</i>
to have the value <i>sad@lost.org</i>. This situation is illustrated
in Figure 15.10.<br>

<p>
<center><img SRC="c15p3i7.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter15/c15p3i7.gif" .GIF" WIDTH="553" HEIGHT="259"></center>
<br>
<center>Figure 15.10 The list from 15.9 during the addition of <i>zzz@snooze.gov</i>.<br>
</center>
<p>
The loop condition will again evaluate <b>true</b>
and the loop will iterate for a second time casing <i>thisNode</i>
to move down the list to <i>sad@lost.org</i>, and thus <i>nextNode
</i>and<i> nextKeyValue</i>
to become <b>null</b>. The third
evaluation of the loop condition will be <b>false</b>
and the loop will terminate. Lines 0075 to 0077 will connect the
new node to the list by setting <i>thisNode</i>'s
link to point to the <i>newNode</i>,
the <i>newNode</i>'s link to
be set <b>null</b> and the <i>numberOfElements</i>
to be incremented to 4. This effectively adds the <i>zzz</i> node
beyond the <i>sad</i> node. <br>

<p>
Considering Figure 15.10 and assuming that <i>nerd@nerdy.com</i>
is to be added, the evaluation of the loop term on line 0062 would
be <b>false</b> causing the loop
to terminate. The execution of line 0075 will cause <i>thisNode</i>,
the <i>geek</i> node, to become linked to the <i>newNode</i>,
the nerd <i>node</i>. Line 0076 will cause the link in the <i>newNode</i>
to be linked to the <i>nextNode</i>,
the <i>sad</i> node and via it to any other nodes which it is
linked to, for example the <i>zzz</i> node.<br>

<p>
A higher level description of the implementation of the <i>add()</i>
action would be that lines 0044 to 0047 are concerned with adding
an element to an empty list. Lines 0048 to 0053 are concerned
with inserting an element before the first node of an non-empty
list. Lines 0054 to 0070 are concerned with iterating through
the list until the list comes to an end or the correct location
for the new node to be inserted is found. Lines 0071 to 0074 make
sure that an element with the same key is not already present
and, finally, lines 0075 to 0077 insert the node into the list.
<br>
<br>



<p>
<hr>
<h2>
<ul>

<a HREF="chap15p4.html" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter15/chap15p4.html"><img SRC="..\next.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/next.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="50" HEIGHT="40">
15.4 The linked list <i>obtain(),</i> <i>remove()</i> and <i>isPresent()</i> actions</a>.
<p>
<a HREF="chap15p2.html" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter15/chap15p2.html"><img SRC="..\last.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/last.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="50" HEIGHT="40">
15.2 The <i>LinkedList</i> class diagram and <i>ListNode</i> class</a>.
</ul>
</h2>
<hr>

</body>

</html>
