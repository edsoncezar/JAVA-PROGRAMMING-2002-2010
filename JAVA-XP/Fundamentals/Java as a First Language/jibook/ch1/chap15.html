<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPad 2.0">
<title> 1.5 The ClickCounterTranslation class </title>
</head>

<body bgcolor="#FFFFFF">

<h1 align="center">1.5 The <font size="5" face="Arial"><i>ClickCounterTranslation</i></font><font
size="6"> class</font></h1>

<p>As shown in the instance diagram in Figure 1.8 the <font
size="2" face="Arial"><i>ClickCounterTranslation</i></font> class
provides <font size="2" face="Arial"><i>theApplet</i></font>
which implements the application. Its' responsibility is to
construct an instance of the <font size="2" face="Arial"><i>clickCounter</i></font>
class, called <font size="2" face="Arial"><i>theCounter</i></font>,
and an instance of the <font size="2" face="Arial"><i>clickCounterPresentation</i></font>
class, called <font size="2" face="Arial"><i>itsInterface</i></font>;
and to place the application into its initial state. It also has
the responsibility of listening to the events generated from the
interface, calling methods of the application module and
instructing the visible part of the application how to change
itself in response. The class diagram of the <font size="2"
face="Arial"><i>ClickCounterTranslation</i></font> class is given
in Figure 1.13. </p>

<p align="center"><font size="2"><b><img src="fig113.gif"
width="417" height="217"></b></font></p>

<p align="center"><font size="2"><b>Figure 1.13</b> </font><font
size="2" face="Arial"><i>ClickCounterTranslation</i></font><font
size="2"> class diagram.</font></p>

<p>The <font size="2" face="Arial"><i>init()</i></font> method
will be automatically called after the inherited (<font size="2"
face="Arial">Applet</font>) constructor method has been called
and before the <font size="2" face="Arial">Applet</font> is
posted to the display. It will be used to create the instances <i>used</i>
by this interface, as shown in Figure 1.8, and to place them, and
itself, into a well defined initial state. The only other method
is <font size="2" face="Arial"><i>actionPerformed()</i></font>,
so called as it is the method which will be performed when an
event is dispatched to it from any AWT components which have
registered it as their action listener. This is the only method
which this class must supply in order for it to implement the <font
size="2" face="Arial">ActionListener</font> interface. The
implementation of this class, as far as the end of the <font
size="2" face="Arial"><i>init()</i></font> method is as follows. </p>

<pre><font size="2">0001  // Filename ClickCounterTranslation.java.
0002  // Provides the behaviour for the interactive ClickCounter.
0003  // Written for the Java Interface book Chapter 1.
0004  //
0005  // Fintan Culwin, v 2.0, August 1997.
0006  
0007  <b>import</b> java.awt.*;
0008  <b>import</b> java.awt.event.*;
0009  <b>import</b> java.applet.Applet;
0010  
0011  <b>import</b> <i>ClickCounter</i>;
0012  <b>import</b> <i>ClickCounterPresentation</i>;
0013  
0014  <b>public class</b> <i>ClickCounterTranslation</i> <b>extends</b>    Applet
0015                                       <b>implements</b> ActionListener { 
0016         
0017  <b>private final int</b> <i>INITIAL_STATE</i>  = 0;
0018  <b>private final int</b> <i>MINIMUM_STATE</i>  = 1;
0019  <b>private final int</b> <i>COUNTING_STATE</i> = 2;
0020  <b>private final int</b> <i>MAXIMUM_STATE</i>  = 3;
0021  <b>private       int</b> <i>theState</i>       = <i>INITIAL_STATE</i>;
0022   
0023  <b>private</b> <i>ClickCounter</i>             <i>theCounter</i>;
0024  <b>private</b> <i>ClickCounterPresentation</i> <i>itsInterface</i>;
0025  
0026         
0027     <b>public void</b> <i>init</i>() { 
0028        <i>theCounter</i>   = <b>new</b> <i>ClickCounter</i>( 0, 5);
0029        <i>itsInterface</i> = <b>new</b> <i>ClickCounterPresentation</i>( <b>this</b>);
0030        <i>itsInterface</i>.<i>setValueDisplay</i>( <i>theCounter</i>.<i>countIsAsString</i>()); 
0031        <i>itsInterface</i>.<i>setMinimumState</i>();
0032        <i>theState</i> = <i>MINIMUM_STATE</i>;   
0033     } // End <i>init</i>.         </font></pre>

<p>The import statements on lines 0007 to 0009 provide access to
the Java API resources required by this class and on line 0011
and 0012 to the <font size="2" face="Arial"><i>ClickCounter</i></font>
class which provides the application part and to the <font
size="2" face="Arial"><i>ClickCounterPresentation</i></font>
class providing the presentation part. These two <font size="2"
face="Arial"><b>import</b></font>ations are not strictly
required, however they document the dependencies between this
source code file and the other two source code files in the
application, as such they should be used even though they are
technically not required by Java in this case.</p>

<p>On lines 0017 to 0020 four manifest class-wide constants which
are used to represent the states of the interface are declared,
and on line 0021 an <font size="2" face="Arial"><b>int</b></font>eger
instance variable, called <font size="2" face="Arial"><i>theState</i></font>,
is declared and initialized to the manifest value <font size="2"
face="Arial"><i>INITIAL_STATE.</i></font> The intention is that
the value of this variable will always record the current state
of the application and its interface.</p>

<p>On line 0023 an instance of the <font size="2" face="Arial"><i>ClickCounter</i></font>
class, called <font size="2" face="Arial"><i>theCounter</i></font>,
is declared and on line 0024 an instance of the <font size="2"
face="Arial"><i>ClickCounterPresentation</i></font> class, called
<font size="2" face="Arial"><i>itsInterface</i></font>. These two
instances provide the two objects which are used by the
application, as shown in Figure 1.8.</p>

<p>The first step of the <font size="2" face="Arial"><i>init()</i></font>
method, on line 0028 is to construct the <font size="2"
face="Arial"><i>ClickCounter</i></font> instance; the arguments
to the constructor, 0 and 5, delimit a very small range of values
which it can count between in order to allow the interface to be
easily demonstrated and tested. On line 0029 <font size="2"
face="Arial"><i>itsInterface </i></font>is constructed, passing
as an argument the identity of the <font size="2" face="Arial"><i>ClickCounterInstance
</i></font>which is currently being <font size="2" face="Arial">init</font>ialized
(<font size="2" face="Arial"><b>this</b></font>) As explained
above, this will cause the interface components to be created and
mounted onto <font size="2" face="Arial"><b>this</b></font> <font
size="2" face="Arial">Applet</font>'s <font size="2" face="Arial">Panel</font>
and will also cause <font size="2" face="Arial"><b>this</b></font>
instance to become the <font size="2" face="Arial">ActionListener</font>
of the buttons on the interface. </p>

<p>Once constructed the <font size="2" face="Arial"><i>setValueDisplay()</i></font>
method of the <font size="2" face="Arial"><i>itsInterface </i></font>instance
is called passing as an argument the <font size="2" face="Arial">String</font>
obtained from the <font size="2" face="Arial"><i>theCounter</i></font>'s
<font size="2" face="Arial"><i>countIsAsString()</i></font>
method. This will cause the <font size="2" face="Arial"><i>valueDisplay</i></font>
component of the interface to display the initial value of <font
size="2" face="Arial"><i>theCounter</i></font> when it
subsequently first becomes visible. The final <font size="2"
face="Arial">init</font>ialisation steps are to call the <font
size="2" face="Arial"><i>itsInterface setMinimumState()</i> </font>method
to effect the transition from the initial to the minimum states,
as required by the state transition diagram, and the value of <font
size="2" face="Arial"><i>theState</i></font> is set to reflect
this. When the <font size="2" face="Arial"><i>init()</i></font>
method concludes the <font size="2" face="Arial">applet</font>
will show itself to the user on the desktop and, as the <font
size="2" face="Arial"><i>ClickCounterPresentation</i></font>
instance has constructed the interface within the <font size="2"
face="Arial">applet</font>'s window, this will cause the
interface to become visible to the user.</p>

<p>The <font size="2" face="Arial"><i>actionPerformed()</i></font>
method will be called every time the user presses one of the
buttons on the interface; the <font size="2" face="Arial">ActionEvent</font>
generated in response to the press being passed as an argument to
the method. The implementation of this method is as follows. </p>

<pre><font size="2">0036     <b>public void</b> <i>actionPerformed</i>( ActionEvent <i>event</i>) {   
0037   
0038     String <i>buttonPressed</i> = <i>event</i>.getActionCommand();
0039   
0040        <b>if</b> ( <i>buttonPressed</i>.equals( &quot;increment&quot;)) { 
0041           <b>if</b> ( <i>theState</i> == <i>MINIMUM_STATE</i>) { 
0042              <i>itsInterface</i>.<i>setCountingState</i>();
0043              <i>theState</i> = <i>COUNTING_STATE</i>;
0044           } // End if.
0045           <i>theCounter.count</i>();
0046           <b>if</b> ( <i>theCounter.isAtMaximum</i>()) { 
0047               <i>itsInterface.setMaximumState</i>();
0048               <i>theState</i> = <i>MAXIMUM_STATE</i>;
0049           } // End if. 
0050                     
0051        } <b>else if</b> ( <i>buttonPressed</i>.equals( &quot;reset&quot;)) { 
0052        
0053           <i>theCounter.reset</i>();
0054           <i>itsInterface.setMinimumState</i>();      
0055           <i>theState</i> = <i>MINIMUM_STATE</i>;
0056        
0057        } <b>else if</b> ( <i>buttonPressed</i>.equals( &quot;decrement&quot;)) { 
0058        
0059           <b>if</b> ( <i>theCounter.isAtMaximum</i>()) { 
0060              <i>itsInterface.setCountingState</i>();
0061              <i>theState = COUNTING_STATE</i>;
0062           } // End if.      
0063           <i>theCounter.unCount</i>();
0064           <b>if</b> ( <i>theCounter.isAtMinimum</i>()) { 
0065              <i>itsInterface.setMinimumState</i>();
0066              <i>theState</i> = <i>MINIMUM_STATE</i>;
0067           } // End if.          
0068        } // End if.
0069        
0070        <i>itsInterface</i>.<i>setValueDisplay</i>( <i>theCounter.countIsAsString</i>() ); 
0071     } // End <i>actionPerformed</i>. 
0072  
0073  } // End class <i>ClickCounterTranslation</i>.</font></pre>

<p>This method will be called whichever button is pressed and the
<font size="2" face="Arial"><i>event</i></font> instance will
contain a copy of the <font size="2" face="Arial"><i>actionCommand</i></font>
attribute of the button which caused it to be generated. The <font
size="2" face="Arial"><i>actionPerformed()</i></font> method
commences, on line 0038, by retrieving this attribute from the <font
size="2" face="Arial"><i>event</i></font> by using its <font
size="2" face="Arial">getActionCommand()</font> method. The
remainder of the method is a three way selection which contains a
branch for each button. </p>

<p>Lines 0041 to 0049 contain the steps required to respond to a
press of the <font size="2" face="Arial"><i>incrementButton</i></font>,
and starts by effecting the transition from the <font size="2"
face="Arial"><i>MINIMUM_STATE</i></font> to the <font size="2"
face="Arial"><i>COUNTING_STATE</i></font> if the value of the <font
size="2" face="Arial"><i>theState</i></font> attribute indicates
that it should be taken. This is accomplished by calling the <font
size="2" face="Arial"><i>itsInterface</i></font>'s <font size="2"
face="Arial"><i>setCountingState()</i></font> method and updating
the value of <font size="2" face="Arial"><i>theState</i></font>
to reflect this. Following this, on line 0045, the <font size="2"
face="Arial"><i>count()</i></font> method of <font size="2"
face="Arial"><i>theCounter</i></font> instance is called to
record the occurrence and finally, on lines 0046 to 0049, the
transition to the <font size="2" face="Arial"><i>MAXIMUM_STATE</i></font>
is taken, if appropriate.</p>

<p>On lines 0053 to 0055 a press of the <font size="2"
face="Arial"><i>resetButton</i></font> is handled by resetting <font
size="2" face="Arial"><i>theCounter</i></font>, setting the <font
size="2" face="Arial"><i>itsInterface</i></font> to its minimum
state and recording this in <font size="2" face="Arial"><i>theState</i></font>.
Lines 0059 to 0067 handle a press of the <font size="2"
face="Arial"><i>decrementButton</i></font> in a manner comparable
to the way in which a press of the <font size="2" face="Arial"><i>incrementButton</i></font>
was handled. The last step of the <font size="2" face="Arial"><i>actionPerformed()</i></font>
method is to update the <font size="2" face="Arial"><i>valueDisplay</i></font>
component on the interface by passing to its <font size="2"
face="Arial"><i>setValueDisplay()</i></font> method the value
obtained from <font size="2" face="Arial"><i>theCounter</i></font>'s
<font size="2" face="Arial"><i>countIsAsString()</i></font>
method. </p>

<p>Referring back to Figure 1.7 the identity of the <font
size="2" face="Arial"><i>ClickCounterTranslation</i></font>
instance is registered with the three buttons on the interface as
their listener when they are constructed. Subsequently, when the
user presses one of the buttons an <font size="2" face="Arial"><i>ActionEvent</i></font>,
containing an <font size="2" face="Arial">actionCommand</font>
attribute to identify which button, is dispatched to its
listener. When the event is received by the <font size="2"
face="Arial"><i>ClickCounterTranslation</i></font> instance its <font
size="2" face="Arial"><i>performAction()</i></font> method is
called passing as an argument the <font size="2" face="Arial"><i>ActionEvent</i></font>
instance received. Within the <font size="2" face="Arial"><i>performAction()</i></font>
method public methods of the <font size="2" face="Arial"><i>ClickCounter</i></font>
instance, <font size="2" face="Arial"><i>theCounter</i></font>,
are called to perform the appropriate application functionality.
Public methods of the <font size="2" face="Arial"><i>ClickCounterPresentation</i></font>
instance, <font size="2" face="Arial"><i>itsInterface</i></font>,
are also called to change the appearance of the interface to
provide feedback to the user. </p>

<p>&nbsp;</p>

<hr>

<blockquote>
    <p><a href="clickcountertranslation.java"><font size="4"><img
    src="list.gif" align="middle" border="0" width="40"
    height="35"> ClickCounterTranslation.java</font></a></p>
</blockquote>

<hr>

<blockquote>
    <p><a href="chap16.html"><img src="next.gif" align="middle"
    border="0" width="50" height="40"><font size="5"><b>1.6 </b></font><font
    size="5" face="Arial"><b><i>ClickCounter</i></b></font><font
    size="3"><b> </b></font><font size="5"><b>- executing the
    applet in a browser</b></font></a></p>
    <p><a href="chap14.html"><font size="4"><img src="last.gif"
    align="middle" border="0" width="50" height="40"></font><font
    size="5">1.4 The </font><font size="5" face="Arial"><i>ClickCounterPresentation</i></font><font
    size="6"> </font><font size="5">class</font></a></p>
</blockquote>

<hr>
</body>
</html>
