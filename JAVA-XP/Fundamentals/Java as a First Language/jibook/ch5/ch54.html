<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPad 2.0">
<title> 5.4 The SemiDirectTuttleInterface class </title>
</head>

<body bgcolor="#FFFFFF">

<h1 align="center">5.4 The <font size="5" face="Arial"><i>SemiDirectTuttleInterface</i></font><font
size="6"> class </font></h1>

<p>The <font size="2" face="Arial"><i>SemiDirectTuttleInterface</i></font>
class is responsible for supplying the collection of <font
size="2" face="Arial"><i>TuttleButtons</i></font>, shown at the
bottom of Figure 5.4, and also for dispatching events generated
by the user's interactions with the buttons to its listener
object. It contains only a constructor action and so a class
diagram will not be presented.</p>

<p>The layout managers which have been introduced in the previous
chapters are not sufficiently sophisticated for the layouts which
are required in the <font size="2" face="Arial"><i>SemiDirectTuttleInterface</i></font>.
In order to produce the required groupings the <font size="2"
face="Arial"><i>GridBagLayout</i></font> layout manager has to be
used. This is the most complex of the Java AWT layout managers
and only a brief introduction to its full capabilities will be
given here; further details can be obtained from the AWT
documentation.</p>

<p>The basis of using a <font size="2" face="Arial"><i>GridBagLayout</i></font>
layout manager is to imagine the area which will be occupied by a
collection of components divided in a grid containing an
arbitrary number of columns and rows. Figure 5.6 shows the panel
upon which the four movement buttons were laid out, with a
suitable grid superimposed.</p>

<p align="center"><b><img src="fig56.gif" width="478"
height="306"></b></p>

<p align="center"><b>Figure 5.6</b> Grid used to layout the <font
face="Arial"><i>Tuttle</i></font> movement buttons.</p>

<p>The top left cell of all grids must have the co-ordinates
(0,&nbsp;0) but the grid can contain any number of rows and
columns. A component can then be placed onto the grid by
specifying the cell where its top left corner should appear and
the width and height it should occupy, in cells. So the backward
movement button is located in cell (&nbsp;1,&nbsp;2) and has a
width of 1 cell and a height of 2 cells. This information, known
as <i>constraints</i>, is summarised for all four <font size="2"
face="Arial"><i>TuttleButtons</i></font> in Table 5.2. </p>

<p align="center"><b><img src="table52.gif" width="581"
height="119"></b></p>

<p align="center"><b>Table 5.2</b> Layout constraints for the <font
face="Arial"><i>Tuttle movementPanel</i></font>.</p>

<p>To apply these constraints an instance of the <font size="2"
face="Arial"><i>GridBagConstraints </i></font>class has to be
constructed, configured and communicated to the <font size="2"
face="Arial"><i>GridBagLayout</i></font> instance which has been
specified as the <font size="2" face="Arial">Panel</font>'s
layout manager. This will be described in detail below when these
four <font size="2" face="Arial"><i>TuttleButton</i></font>s are
constructed and added to their <font size="2" face="Arial">Panel</font>
in the <font size="2" face="Arial"><i>SemiDirectTuttleInterface</i></font>
constructor, which commences as follows. </p>

<pre><font size="3">0018      <b>public</b> SemiDirectTuttleInterface( Applet itsApplet) { 
0019      
0020      ActionListener sendToHere = (ActionListener) itsApplet; 
0021  
0022        Panel foreGroundPanel  = <b>new</b> Panel();
0023        Panel backGroundPanel  = <b>new</b> Panel();
0024        Panel screenPanel      = <b>new</b> Panel();
0025        Panel penPanel         = <b>new</b> Panel();
0026        Panel movementPanel    = <b>new</b> Panel();
0027     
0028        GridBagLayout      tuttleLayout   = <b>new</b> GridBagLayout();
0029        GridBagLayout      movementLayout = <b>new</b> GridBagLayout();
0030        GridBagConstraints constraints    = <b>new</b> GridBagConstraints();
0031     
0032  
0033        TuttleButton goForward;
0034        TuttleButton goBackward;
0035        TuttleButton turnLeft;
0036        TuttleButton turnRight;
<b>----        Other TuttleButton declarations omitted. 
</b></font></pre>

<p>The constructor requires as an argument the identity of the <font
size="2" face="Arial">Applet</font> which implements the <font
size="2" face="Arial">ActionListener</font> interface to which it
is to send the <font size="2" face="Arial"><i>ActionEvent</i></font>s
generated by its <font size="2" face="Arial"><i>TuttleButton</i></font>s.
This identity is established, for convenience, on line 0020 as
both the identity of the <font size="2" face="Arial">Applet</font>
and of its <font size="2" face="Arial">ActionListener</font> are
required for the construction of the <font size="2" face="Arial"><i>TuttleButton</i></font>s
and a single cast here prevents multiple casts later. </p>

<p>The five <font size="2" face="Arial"><i>Panels</i></font>,
declared and constructed on lines 0022 to 0026, are used to mount
the five groups of <font size="2" face="Arial"><i>TuttleButton</i></font>s,
in order to implement the groupings as described above. The <font
size="2" face="Arial"><i>SemiDirectTuttleInterface</i></font><i> </i>itself<i>
</i>and the <font size="2" face="Arial"><i>movementPanel</i></font>
require a <font size="2" face="Arial"><i>GidbagLayout</i></font>
policy and two suitably named instances of the <font size="2"
face="Arial"><i>GridBagLayout</i></font> class are declared and
constructed on lines 0028 and 0029 to provide these and an
instance of the <font size="2" face="Arial"><i>GridBagConstraints</i></font>
class, called <font size="2" face="Arial"><i>constraints</i></font>,
is declared and constructed on line 0030. The 21 <font size="2"
face="Arial"><i>TuttleButtons</i></font> are then declared on
lines 0033 to 0054. </p>

<p>Following these declarations, the <font size="2" face="Arial"><i>movementPanel</i></font>
is prepared as follows. The first step, on line 0059, is to set
the layout policy of the <font size="2" face="Arial"><i>movementPanel</i></font>
to <font size="2" face="Arial"><i>GridBagLayout</i></font> by
passing the <font size="2" face="Arial"><i>GridBagLayout</i></font>
instance <font size="2" face="Arial"><i>movementLayout</i></font>
as an argument to its <font size="2" face="Arial"><i>setLayout()</i></font>
action. </p>

<pre><font size="3">0059         <i>movementPanel</i>.setLayout( <i>movementLayout</i>);</font></pre>

<p>When the <font size="2" face="Arial">Component</font>s
contained within the <font size="2" face="Arial"><i>movementPanel</i></font>
are laid out, during layout negotiations, the <font size="2"
face="Arial">Constraints</font> associated with each <font
size="2" face="Arial">Component</font> are consulted to determine
where it should be positioned. For this to be accomplished each <font
size="2" face="Arial"><i>TuttleButton</i></font> in turn is
constructed, has its <font size="2" face="Arial"><i>actionCommand</i></font>
and <font size="2" face="Arial"><i>actionListener</i></font>
attributes set, and then is added to the <font size="2"
face="Arial"><i>movementPanel</i></font> after its <font size="2"
face="Arial"><i>Constraints</i></font> are associated with it by
a call of the <font size="2" face="Arial"><i>movementLayout
setConstraints()</i></font> action. The first <font size="2"
face="Arial"><i>TuttleButton</i></font> to be prepared is the <font
size="2" face="Arial"><i>turnLeft</i></font> button, as follows. </p>

<pre><font size="3">0061         <i>turnLeft</i> = <b>new</b> <i>TuttleButton</i>( &quot;greyltutt.gif&quot;, <i>itsApplet</i>);
0062         <i>turnLeft</i>.<i>setActionCommand</i>( &quot;Turn left&quot;);
0063         <i>turnLeft</i>.<i>addActionListener</i>( <i>sendToHere</i>);
0064         <i>constraints</i>.gridx = 0;
0065         <i>constraints</i>.gridy = 1;       
0066         <i>constraints</i>.gridwidth  = 1;
0067         <i>constraints</i>.gridheight = 2;     
0068         <i>movementLayout</i>.setConstraints( <i>turnLeft</i>, <i>constraints</i>);       
0069         <i>movementPanel</i>.add( <i>turnLeft</i>);</font></pre>

<p>On line 0061 the <font size="2" face="Arial"><i>TuttleButton</i></font>
is constructed specifying as arguments the image which it is to
display and the identity of <font size="2" face="Arial"><i>itsApplet</i></font>
which is required to obtain the <font size="2" face="Arial">Image</font>
for its button, as described above. On lines 0062 and 0063, its <font
size="2" face="Arial"><i>actionCommand</i></font> and <font
size="2" face="Arial"><i>actionListener</i></font> attributes are
specified, the latter of which specifies as its argument the <font
size="2" face="Arial">ActionListener</font> cast value, <font
size="2" face="Arial"><i>sendToHere</i></font>, of <font size="2"
face="Arial"><i>itsApplet</i></font>. Lines 0064 to 0067 set the
public attributes of the <font size="2" face="Arial"><i>constraints</i></font>
object to those shown in Table 5.2, as required by the <font
size="2" face="Arial"><i>turnLeft TuttleButton</i></font>. Line
0068 associates these <font size="2" face="Arial"><i>constraints</i></font>
with the <font size="2" face="Arial"><i>turnLeft</i></font>
button within the <font size="2" face="Arial"><i>movementLayout</i>
GridBagLayout</font> instance, by calling its <font size="2"
face="Arial"><i>setConstraints()</i></font> action, Finally, on
line 0069, the <font size="2" face="Arial"><i>turnLeft</i></font>
<font size="2" face="Arial"><i>TuttleButton</i></font> is <font
size="2" face="Arial">add</font>ed to the <font size="2"
face="Arial"><i>movementPanel</i></font>. Each of the other three
<font size="2" face="Arial"><i>TuttleButton</i></font>s on the <font
size="2" face="Arial"><i>movementPanel</i></font> are prepared
and <font size="2" face="Arial">add</font>ed in a similar way,
specifying the appropriate constraints from Table 5.2.</p>

<p>The other four <font size="2" face="Arial">Panel</font>s; <font
size="2" face="Arial"><i>foreGroundPanel, backGroundPanel,
screenPanel </i></font>and <font size="2" face="Arial"><i>penPanel</i></font>,
use their default <font size="2" face="Arial">FlowLayout</font>
policy as their <font size="2" face="Arial">TuttleButton</font>s
are constructed, configured and added to them. For example the <font
size="2" face="Arial"><i>penPanel</i></font> is prepared as
follows. </p>

<pre><font size="3">0118         <i>penUpButton </i>= <b>new</b> TuttleButton( &quot;penup.gif&quot;, <i>itsApplet</i>);
0119         <i>penUpButton</i>.setActionCommand(   &quot;Penup&quot;);
0120         <i>penUpButton</i>.addActionListener(  <i>sendToHere</i>);
0121         <i>penPanel</i>.add( <i>penUpButton</i>);
0122         
0123         <i>penDownButton </i>= <b>new</b> TuttleButton( &quot;pendown.gif&quot;, <i>itsApplet</i>);
0124         <i>penDownButton</i>.setActionCommand(   &quot;Pendown&quot;);
0125         <i>penDownButton</i>.addActionListener(  <i>sendToHere</i>);
0126         <i>penPanel</i>.add( <i>penDownButton</i>);</font></pre>

<p>All five <font size="2" face="Arial">Panel</font>s, the four
described in the paragraph above and the <font size="2"
face="Arial"><i>movementPanel</i></font>, are also subject to a <font
size="2" face="Arial">GridBagLayout</font> policy in order to
produce the required positionings. The grid which is required to
lay out the <font size="2" face="Arial">Panel</font>s is
illustrated in Figure 5.7 and the layout attributes derived are
listed in Table 5.3.</p>

<p align="center"><b><img src="fig57.gif" width="797"
height="208"></b></p>

<p align="center"><b>Figure 5.7</b> Grid used to layout the <font
face="Arial"><i>TuttleControl </i>Panel</font>s.</p>

<p align="center"><b><img src="table53.gif" width="608"
height="141"></b></p>

<p align="center"><b>Table 5.3</b> Layout constraints for the <font
face="Arial"><i>tuttleControlPanel</i></font>. </p>

<p>The widths of the <font size="2" face="Arial">Panel</font>s
were derived from the consideration that each of the small
buttons is two thirds of the width of each of the large buttons.
Thus the panels have a width ratio of 6, 4 and 3 which has been
doubled to produce the integer ratio 12, 9 and 6. The <font
size="2" face="Arial">anchor</font> attribute is used by the
layout manager to decide what to do when the space allocated to
the component is larger than it required. For example if the area
allocated to the <font size="2" face="Arial"><i>foregroundPanel</i></font>
is larger than it requires it will be positioned in the lower
right (<font size="2" face="Arial">SOUTHEAST</font>) of the area.
The anchor values were chosen so as to preserve the functional
and aesthetic properties of the interface under these
circumstances. The part of the <font size="2" face="Arial"><i>init()</i></font>
action responsible for positioning the <font size="2"
face="Arial"><i>penPanel</i></font> is as follows. </p>

<pre><font size="3">0233         <i>constraints</i>.gridx      = 21;
0234         <i>constraints</i>.gridy      = 1;       
0235         <i>constraints</i>.gridwidth  = 6;
0236         <i>constraints</i>.gridheight = 1;
0237         <i>constraints</i>.anchor     = GridBagConstraints.NORTHWEST;
0238         <i>tuttleLayout</i>.setConstraints( <i>penPanel</i>, <i>constraints</i>);
0239         <b>this</b>.add( <i>penPanel</i>);                                                                
0240        } // End <i>SemiDirectTuttleInterface</i> constructor.</font></pre>

<p>The <font size="2" face="Arial"><i>tuttleLayout GridbagLayout</i></font>
instance has been specified as the layout manager of the <font
size="2" face="Arial"><i>SemiDirectTuttleInterface</i></font> and
so when it is informed, on line 0238, of the <font size="2"
face="Arial"><i>constraints</i></font> to be applied to the <font
size="2" face="Arial"><i>penPanel</i></font> it is ready to use
this information in layout negotiations after the <font size="2"
face="Arial"><i>penPanel</i></font> has been added to it, on line
0239.</p>

<p>All the data attributes of the <font size="2" face="Arial"><i>GridBagConstraints</i></font>
class, and the effect which they have on the layout of the
components, are summarised in Table 5.4. Additional details can
be found in the API documentation.</p>

<p align="center"><font size="2"><b><img src="table54.gif"
width="606" height="293"></b></font></p>

<p align="center"><font size="3"><b>Table 5.4</b> Attributes of
the </font><font size="3" face="Arial">GridBagConstraints</font><font
size="3"> class. </font></p>

<p>&nbsp;</p>

<hr>

<blockquote>
    <p><a
    href="..\tuttles\semidirecttuttle\semidirecttuttleinterface.java"><font
    size="5"><img src="list.gif" align="middle" border="0"
    width="40" height="35"> SemiDirectTuttleInterface.java</font></a></p>
</blockquote>

<hr>

<blockquote>
    <p><a href="ch55.html"><img src="next.gif" align="middle"
    border="0" width="50" height="40"><font size="5">5.5 The </font><font
    size="5" face="Arial"><i>SemiDirectTuttle</i></font><font
    size="6"> </font><font size="5">class </font></a></p>
    <p><a href="ch53.html"><font size="4"><img src="last.gif"
    align="middle" border="0" width="50" height="40"></font><font
    size="5">5.3</font><font size="7"> </font><font size="5"
    face="Arial"><i>SemiDirectTuttle</i></font><font size="6">,</font><font
    size="5"> construction overview</font></a></p>
</blockquote>

<hr>
</body>
</html>
