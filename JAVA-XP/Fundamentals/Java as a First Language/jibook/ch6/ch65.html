<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPad 2.0">
<title> 6.5 The MenuBarTuttle class </title>
</head>

<body bgcolor="#FFFFFF">

<h1 align="center">6.5 The <font size="5" face="Arial"><i>MenuBarTuttle</i></font><font
size="6"> class</font></h1>

<p>The <font size="2" face="Arial"><i>MenuBarTuttle</i></font>
class has the responsibility for constructing the <font size="2"
face="Arial"><i>MenuBarTuttleInstance</i></font> passing to it a <font
size="2" face="Arial">Frame</font> which it has created and
subsequently installing into it an instance of the <font size="2"
face="Arial">Tuttle</font> class and a feedback area, before the <font
size="2" face="Arial">Fame</font>, and the interface it contains,
is made visible to the user. It then listens to the <font
size="2" face="Arial"><i>ActionEvents</i></font> sent to it by
the <font size="2" face="Arial"><i>MenuBarTuttleInterface</i></font>
and the <font size="2" face="Arial"><i>ExitDialog</i></font>
instances, controlling <font size="2" face="Arial"><i>theTuttle</i></font>
and the <font size="2" face="Arial">applet</font> in response.
The implementation of the <font size="2" face="Arial"><i>MenuBarTuttle</i></font>
class as far as the start of its <font size="2" face="Arial"><i>init()</i></font>
method is as follows. </p>

<pre><font size="3">0001  // Filename <i>MenuBarTuttle.java</i>.
0002  // Supplies a main menu interface for the <i>Tuttle</i> class.
0003  //
0004  // Written for Java Interface book chapter 6.
0005  // Fintan Culwin, v 0.2, August 1997.
0006  
0007  <b>package</b> <i>MenuBarTuttle</i>;
0008  
0009  <b>import</b> java.awt.*;
0010  <b>import</b> java.applet.*;
0011  <b>import</b> java.awt.event.*;
0012  <b>import</b> java.util.StringTokenizer;
0013  
0014  <b>import</b> <i>Tuttles.Tuttle</i>;
0015  <b>import</b> <i>MenuBarTuttle.MenuBarTuttleInterface</i>;
0016  
0017  <b>import</b> <i>MenuBarTuttle.ExitDialog</i>;
0018  <b>import</b> <i>MenuBarTuttle.VersionDialog</i>;
0019  <b>import</b> <i>MenuBarTuttle.MenuBarTuttleHelpDialog</i>;
0020  
0021  <b>public class</b> <i>MenuBarTuttle</i> <b>extends</b>    Applet 
0022                             <b>implements</b> ActionListener {
0023  
0024  <b>private</b> Label  <i>feedbackLabel</i>;
0025  <b>private</b> Panel  <i>feedbackPanel</i>;
0026  
0027  <b>private</b> Tuttle                  <i>theTuttle</i>;
0028  <b>private</b> MenuBarTuttleInterface  <i>theInterface</i>;
0029  
0030  <b>private</b> ExitDialog              <i>exitDialog</i>;
0031  <b>private</b> VersionDialog           <i>versionDialog</i>;
0032  <b>private</b> MenuBarTuttleHelpDialog <i>helpDialog</i>;</font></pre>

<p>Lines 0014 to 0019 import the various classes indicated in the
instance diagram in Figure 6.4 after the required Java packages,
including the <font size="2" face="Arial">StringTokenizer</font>
class, have been imported. Following the class declaration, on
lines 0021 and 0022, the feedback <font size="2" face="Arial">Label</font>
and <font size="2" face="Arial">Panel</font> are declared as
instance attributes, as are <font size="2" face="Arial"><i>theTuttle</i>
Tuttle</font> instance and <font size="2" face="Arial"><i>theInterface</i></font>
<font size="2" face="Arial"><i>MenuBarTuttleInterface</i></font>
instances, on lines 0024 to 0028. The instance attribute
declarations conclude with the declaration of three specialized
dialogs on lines 0030 to 0032. The <font size="2" face="Arial"><i>init()</i></font>
method constructs the <font size="2" face="Arial">applet</font>,
as follows, </p>

<pre><font size="3">0036     <b>public void</b> <i>init</i>() { 
0037     
0038     Panel  <i>tuttlePanel</i>; 
0039     Frame  <i>tuttleFrame</i>;
0040     
0041        <i>tuttleFrame</i> = <b>new</b> Frame();
0042        <i>tuttleFrame</i>.setTitle( &quot;Menu Bar Tuttle Interface&quot;);
0043        <i>tuttleFrame</i>.setBackground( Color.white);
0044        <i>tuttleFrame</i>.setFont( <b>new</b> Font( &quot;TimesRoman&quot;, Font.PLAIN, 20));
0045                         
0046        <i>feedbackPanel</i> = <b>new</b> Panel();
0047        <i>feedbackLabel</i> = <b>new</b> Label();
0048        <i>feedbackPanel</i>.add( <i>feedbackLabel</i>);
0049        
0050        <i>tuttlePanel</i>   = <b>new</b> Panel(); 
0051        <i>theTuttle</i>     = <b>new</b> Tuttle( <b>this</b>, 500, 500);            
0052        <i>tuttlePanel</i>.add( <i>theTuttle</i>); 
0053        
0054        <i>theInterface</i> = <b>new</b> MenuBarTuttleInterface( <i>tuttleFrame</i>, 
0055                                                   (ActionListener) <b>this</b>);
0056        <i>theInterface</i>.<i>setForegroundCheckmark( &quot;</i>blue<i>&quot;);
</i>0057        <i>theInterface</i>.<i>setBackgroundCheckmark( &quot;</i>yellow<i>&quot;);
</i>0058        <i>theInterface</i>.setPenUpCheckmark( <b>false</b>) 
0059  
0060        <i>tuttleFrame</i>.add( <i>tuttlePanel</i>,   &quot;Center&quot;);
0061        <i>tuttleFrame</i>.add( <i>feedbackPanel</i>, &quot;South&quot;);
0062        
0063        <i>tuttleFrame</i>.setSize( <i>tuttleFrame</i>.getPreferredSize());      
0064        <b>this</b>.feedback();
0065        <i>tuttleFrame</i>.setVisible( <b>true</b>);    
0066         
0067        <i>helpDialog</i>    = <b>new</b> <i>MenuBarTuttleHelpDialog</i>( <i>tuttleFrame</i>);
0068        <i>exitDialog</i>    = <b>new</b> <i>ExitDialog</i>( <i>tuttleFrame</i>, <b>this</b>); 
0069        <i>versionDialog</i> = <b>new</b> <i>VersionDialog</i>( <i>tuttleFrame</i>, <b>this</b>.getAppletInfo());          
0070     } // End <i>init</i>.</font></pre>

<p>The <font size="2" face="Arial"><i>init()</i></font> method
commences, on lines 0041 to 0044, by constructing and configuring
an instance of the <font size="2" face="Arial">Frame</font> class
called <font size="2" face="Arial"><i>tuttleFrame</i></font>.
Lines 0046 to 0048 then prepare the <font size="2" face="Arial"><i>feedbackPanel</i></font>
and lines 0050 to 0052 the <font size="2" face="Arial"><i>tuttlePanel</i></font>,
containing <font size="2" face="Arial"><i>theTuttle</i> <i>Tuttle</i></font>
instance. Lines 0054 to 0055 then construct <font size="2"
face="Arial"><i>theInterface</i></font>, passing as arguments the
<font size="2" face="Arial"><i>tuttleFrame</i></font> to have the
menu bar installed into and the identity of the <font size="2"
face="Arial"><i>MenuBarTuttle</i></font> instance (<font size="2"
face="Arial"><b>this</b></font>) being initialized as its
listener object. Once constructed the color and pen menus are
configured as appropriate on lines 0056 to 0058. A <font size="2"
face="Arial">Frame</font> instance, by default, has a <font
size="2" face="Arial">BorderLayout</font> policy and the <font
size="2" face="Arial"><i>MenuBar</i></font> is automatically
added to its &quot;North&quot; location. Lines 0060 and 0061
place the <font size="2" face="Arial"><i>tuttlePanel</i></font>
into its &quot;<i>Center</i>&quot; location and the <font
size="2" face="Arial"><i>feedbackPanel</i></font> into its &quot;<i>South</i>&quot;
location. Lines 0063 to 0065 set the size of the <font size="2"
face="Arial">Frame</font>, update the <font size="2" face="Arial"><i>feedbackPanel</i></font>
and then call the <font size="2" face="Arial">Frame setVisible()</font>
method to make the interface visible to the user. The final stage
of the <font size="2" face="Arial"><i>init()</i></font> method,
on lines 0067 to 0069, constructs the three specialized dialogs,
which will be considered in detail below. </p>

<p>The <font size="2" face="Arial"><i>actionPerformed()</i></font>
method of the <font size="2" face="Arial"><i>MenuBarTuttle</i></font>
class will be called whenever the user activates any of the items
on <font size="2" face="Arial"><i>theInterface</i></font>'s
menus. The first part of this method is as follows.</p>

<pre><font size="3">0071     <b>public void</b> <i>actionPerformed</i>( ActionEvent <i>event</i>) { 
0072  
0073     StringTokenizer <i>tokenizer</i> = <b>new</b> StringTokenizer( 
0074                                           <i>event</i>.getActionCommand());
0075     String <i>theCommand</i>  = <i>tokenizer</i>.nextToken();
0076     String <i>theArgument</i> = &quot;&quot;;
0077     
0078        <b>if</b> ( <i>tokenizer</i>.hasMoreTokens()) { 
0079           <i>theArgument</i> = <i>tokenizer</i>.nextToken();      
0080        } // End if.
0081  
0082  
0083        <b>if</b> ( <i>theCommand</i>.equals( &quot;exit&quot;)) { 
0084           <b>if</b> ( <i>theArgument</i>.equals( &quot;show&quot;)) {          
0085              <i>exitDialog</i>.<i>setVisible</i>( <b>true</b>); 
0086           } <b>else if</b> ( <i>theArgument</i>.equals( &quot;please&quot;)) { 
0087              System.exit( 0);
0088           } // End if.      
0089                    
0090        } <b>else if</b> ( <i>theCommand</i>.equals( &quot;fd&quot;)) { 
0091           <i>theTuttle</i>.<i>forward</i>( Integer.parseInt( <i>theArgument</i>));
0092        } <b>else if</b> ( <i>theCommand</i>.equals( &quot;bd&quot;)) { 
0093           <i>theTuttle</i>.<i>backward</i>(<i> </i>Integer.parseInt( <i>theArgument</i>));
0094  
0095        } <b>else if</b> ( <i>theCommand</i>.equals( &quot;tr&quot;)) { 
0096           <i>theTuttle</i>.<i>turnRight</i>( Integer.parseInt( <i>theArgument</i>));
0097        } <b>else if</b> ( theCommand.equals( &quot;tl&quot;)) {  
0098           <i>theTuttle.turnLeft</i>( Integer.parseInt( <i>theArgument</i>));</font></pre>

<p>The method commences by constructing a <font size="2"
face="Arial">StringTokenizer</font> instance, called <font
size="2" face="Arial"><i>tokenizer</i></font>, initialized to
process the <font size="2" face="Arial">commandString</font>
retrieved from the <font size="2" face="Arial">ActionEvent</font>
passed to <font size="2" face="Arial"><i>actionPerformed()</i></font>
as an argument. The <font size="2" face="Arial">commandString</font>s
installed into <font size="2" face="Arial"><i>theInterface</i></font>'s
<font size="2" face="Arial">MenuItem</font>s included single word
commands, such as &quot;<i>cs</i>&quot; for <i>clear&nbsp;screen</i>
or &quot;<i>pu</i>&quot; for <i>pen&nbsp;up</i>; and two word
commands, such as &quot;<i>fd&nbsp;10</i>&quot; for <i>forward&nbsp;10</i>
or &quot;<i>bg&nbsp;green</i>&quot; for <i>background&nbsp;green</i>.
The <font size="2" face="Arial"><i>tokenizer</i></font> will
facilitate the scanning of the <font size="2" face="Arial">commandString</font>
to divide the multiple word command into its constituent phrases.
Line 0075 extracts the first word of the command into <font
size="2" face="Arial"><i>theCommand</i></font> and lines 0076 to
0080 extract the second word, if any, into <font size="2"
face="Arial"><i>theArgument</i></font>. </p>

<p>The remaining part of the <font size="2" face="Arial"><i>performAction()</i></font>
method, starting on line 0083, consists of a multiple way <font
size="2" face="Arial"><b>if</b></font> structure containing a
branch for each of the possible commands. To facilitate
maintenance the sequence of commands in the <font size="2"
face="Arial"><b>if</b></font> structure corresponds to the
sequence in which their <font size="2" face="Arial">MenuItem</font>s
were added to the <font size="2" face="Arial">MenuBar</font> in
the constructor of the <font size="2" face="Arial"><i>MenuBarTuttleInterface</i></font>
class. Consequently the first command to be considered, on lines
0083 to 0088, is the &quot;<i>exit</i>&quot; command; this part
of the method will be described below when the <font size="2"
face="Arial"><i>ExitDialog</i></font> class is described below.</p>

<p>Lines 0090 to 0098 process the commands originating from the <font
size="2" face="Arial"><i>Move</i></font> and <i>Turn</i> menu.
The commands passed will be &quot;<i>fd</i>&quot;, &quot;<i>bd</i>&quot;,
&quot;<i>tr</i>&quot; and &quot;<i>tl</i>&quot; for <i>forward</i>,
<i>backward</i>, <i>turn&nbsp;right</i> and <i>turn&nbsp;left</i>
respectively. Each of these commands is followed by an integer
indicating the number of steps to move or the number of degrees
to turn. The repeated phrase <font size="1"><tt>Integer.parseInt(
</tt><i><tt>theArgument</tt></i><tt>)</tt></font> will convert
the integer contained as a <font size="2" face="Arial">String</font>
in <font size="2" face="Arial"><i>theArgument</i></font> into a
primitive <font size="2" face="Arial"><b>int</b></font> value.
This value is passed as an argument to the appropriate <font
size="2" face="Arial"><i>Tuttle</i></font> command. </p>

<p>For example, if the user activates the <font size="2"
face="Arial">MenuItem</font> labelled &quot;<i>15&nbsp;Degrees</i>&quot;
on the <i>Turn&nbsp;Right</i> menu, the <font size="2"
face="Arial"><i>commandString</i></font> passed in the <font
size="2" face="Arial">ActionEvent</font> instance will be &quot;<i>tr&nbsp;15</i>&quot;.
The <font size="2" face="Arial"><i>tokenizer</i></font> will
place &quot;<i>tr</i>&quot; into the <font size="2" face="Arial"><i>theCommand</i>
String</font> and &quot;<i>15</i>&quot; into the <font size="2"
face="Arial"><i>theArgument</i></font> <font size="2"
face="Arial">String</font>. The <font size="2" face="Arial"><b>if</b></font>
condition on line 0095 will evaluate <font size="2" face="Arial"><b>true</b></font>
and line 0096 will call <font size="2" face="Arial"><i>theTuttle</i></font>'s
<font size="2" face="Arial"><i>turnRight()</i></font> method
passing as an argument the <font size="2" face="Arial"><b>int</b></font>
value 15. This will result in the <i>tuttle</i> shown to the user
turning 15 degrees to the right and, as will be demonstrated
below, the feedback shown to the user changing to show the <i>tuttle</i>'s
new direction. </p>

<p>The next commands to be considered originate from the <i>Colors</i>
menu and will contain the command &quot;<i>fg</i>&quot; (<i>foreground</i>)
or &quot;<i>bg</i>&quot; (<i>background</i>) followed by the name
of the color. The &quot;<i>fg</i>&quot; command is processed as
follows. </p>

<pre><font size="3">0101        } <b>else if</b> ( <i>theCommand</i>.equals( &quot;fg&quot;)) {
0102           <b>if</b> ( <i>theArgument</i>.equals( &quot;green&quot;)) { 
0103              <i>theTuttle.setForeground</i>( Color.green);
0116           } <b>else if</b> ( theArgument.equals( &quot;red&quot;)) {             
<b>----           // Other branches omitted
</b>0114           } // End if.
0115           <i>theInterface</i>.<i>setForegroundCheckmark</i>( <i>theArgument</i>);</font></pre>

<p>Line 0101 guards for the &quot;<i>fg</i>&quot; command and the
<font size="2" face="Arial"><b>if</b></font> structure starting
on line 0102 contains a branch for each allowed <font size="2"
face="Arial"><i>tuttle</i></font> color, the branches containing
a call of the <font size="2" face="Arial"><i>theTuttle</i></font>'s<font
size="2" face="Arial"><i> setForeground()</i></font> method
passing as an argument the appropriate manifest value from the
Java <font size="2" face="Arial">Color</font> class. Once the
color has been changed the <font size="2" face="Arial"><i>theInterface</i></font>
<font size="2" face="Arial"><i>setForegroundCheckmark()</i></font>
method is called to update the checkmarks on the interface's <i>foreground&nbsp;color</i>
menu. The implementation of the processing of the &quot;<i>bg</i>&quot;
command is essentially identical.</p>

<p>The processing of the commands from the <i>Screen</i> menu do
not need to consider the value stored in <font size="2"
face="Arial"><i>theArgument</i></font> as they are all single
word commands. The branches corresponding to the last three items
on the menu are as follows. </p>

<pre><font size="3">0135        } <b>else if</b> ( <i>theCommand</i>.equals( &quot;cr&quot;)) {   
0136           <i>theTuttle.clearAndReset</i>();
0137        } <b>else if</b> ( theCommand.equals( &quot;pu&quot;)) {   
0138           <i>theTuttle.setPenUp</i>();
0139           <i>theInterface.setPenUpCheckmark</i>( <b>true</b>);
0140        } <b>else if</b> ( theCommand.equals( &quot;pd&quot;)) {   
0141           <i>theTuttle</i>.<i>setPenDown</i>();
0142           <i>theInterface.setPenUpCheckmark</i>( <b>false</b>);</font></pre>

<p>The &quot;<i>cr</i>&quot; command calls <font size="2"
face="Arial"><i>theTuttle</i></font>'s <font size="2"
face="Arial"><i>clearAndReset()</i></font> method which does not
require an argument. The &quot;<i>pu</i>&quot; and &quot;<i>pd</i>&quot;
commands not only call <font size="2" face="Arial"><i>theTuttle</i></font>'s
<font size="2" face="Arial"><i>setPenUp()</i></font> and <font
size="2" face="Arial"><i>setPenDown()</i></font> methods but also
call <font size="2" face="Arial"><i>theInterface</i></font>'s <font
size="2" face="Arial"><i>setPenStatus()</i></font> method to
update the checkmarks on the <i>Screen</i> menu. The <font
size="2" face="Arial"><i>actionPerformed()</i></font> method
concludes by processing the commands originating from the <i>Help</i>
menu.</p>

<pre><font size="3">0145        } <b>else if</b> ( <i>theCommand</i>.equals( &quot;version&quot;)) {   
0146           <i>versionDialog</i>.<i>setVisible</i>( <b>true</b>);        
0147        } <b>else if</b> ( <i>theCommand</i>.equals( &quot;help&quot;)) {   
0148           <i>helpDialog</i>.<i>setVisible</i>( <b>true</b>);        
0149        } // End if.
0150        
0151        <b>this</b>.<i>feedback</i>();       
0152     } // End <i>actionPerformed</i>.</font></pre>

<p>The <font size="2" face="Arial"><i>versionDialog</i></font>
and <font size="2" face="Arial"><i>helpDialog setVisible()</i></font>
methods will be considered below. After the outer <font size="2"
face="Arial"><b>if</b></font> structure concludes on line 0149
the <font size="2" face="Arial"><i>feedback()</i></font> method
is called to update the feedback shown to the user at the bottom
of the interface and the method concludes on line 0152. </p>

<p>&nbsp;</p>

<hr>

<blockquote>
    <p><a href="..\tuttles\menubartuttle\menubartuttle.java"><font
    size="5"><img src="list.gif" align="middle" border="0"
    width="40" height="35">MenuBarTuttle.java</font></a></p>

    <p><a href="..\tuttles\menubartuttle.html"><font
    size="5"><img src="run.gif" align="middle" border="0"
    width="40" height="27"> MenuBarTuttle</font></a></p>

</blockquote>

<hr>

<blockquote>
    <p><a href="ch66.html"><font size="5"><img src="next.gif"
    align="middle" border="0" width="50" height="40">6.6 The</font><font
    size="7"> </font><font size="4" face="Arial">Dialog</font><font
    size="5"> class</font></a></p>
    <p><a href="ch64.html"><font size="4"><img src="last.gif"
    align="middle" border="0" width="50" height="40"></font><font
    size="5">6.4 The </font><font size="4" face="Arial"><i>MenuBarTuttleInterface</i></font><font
    size="4"> </font><font size="5">class</font></a></p>
</blockquote>

<hr>
</body>
</html>
