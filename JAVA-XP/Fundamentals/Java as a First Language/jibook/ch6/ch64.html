<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPad 2.0">
<title> 6.4 The MenuBarTuttleInterface class </title>
</head>

<body bgcolor="#FFFFFF">

<h1 align="center">6.4 The <font size="5" face="Arial"><i>MenuBarTuttleInterface</i></font><font
size="5"> </font><font size="6">class</font></h1>

<p>The <font size="2" face="Arial"><i>MenuBarTuttleInterface</i></font>
class supplies the entire menu system shown in Figure 6.2. To
accomplish this it constructs an instance hierarchy, part of
which is shown in Figure 6.5, and installs it into the <font
size="2" face="Arial">Frame</font> instance which is passed as an
argument to its constructor.</p>

<p align="center"><b><img src="fig65.gif" width="741"
height="295"></b></p>

<p align="center"><b>Figure 6.5</b> Partial <font face="Arial"><i>MenuBarTuttleInterface</i></font>
instance hierarchy, <br>
showing the <i>File</i> and <i>Move</i> menu structure. </p>

<p>The first part of the constructor, illustrating the
construction of the <font size="2" face="Arial"><i>fileMenu</i></font>
and <font size="2" face="Arial"><i>moveMenu/&nbsp;moveForwardMenu</i></font>,
is as follows. </p>

<pre><font size="3">0036     <b>protected</b> <i>MenuBarTuttleInterface</i>( Frame          <i>itsFrame</i>,
0035                                       ActionListener <i>itsListener</i>) { 
0037     
0039     MenuBar   <i>mainMenuBar</i>;
0040  
0041     Menu      <i>fileMenu</i>;   
0042     MenuItem  <i>exitButton</i>;
0043  
0044     Menu      <i>moveMenu</i>;
0045     
0046     Menu      <i>moveForwardMenu</i>;
0047     MenuItem  <i>forward5</i>;
0048     MenuItem  <i>forward10</i>;
0049     MenuItem  <i>forward25</i>;

<b>----     Other Menu and MenuItem declarations omitted.

</b>0080        
0081        <i>mainMenuBar</i> = <b>new</b> MenuBar(); 
0082                
0083           <i>fileMenu</i> = <b>new</b> Menu( &quot;File&quot;);             
0084              <i>exitButton</i>  = <b>new</b> MenuItem( &quot;Exit ...&quot;);  
0085              <i>exitButton</i>.setActionCommand( &quot;exit show&quot;);
0086              <i>exitButton</i>.addActionListener( <i>itsListener</i>);     
0087              <i>fileMenu</i>.add( <i>exitButton</i>);
0088              
0089        <i>mainMenuBar</i>.add( <i>fileMenu</i>);
0090         
0091           <i>moveMenu</i> = <b>new</b> Menu( &quot;Move&quot;);
0092  
0093              <i>moveForwardMenu</i> = <b>new</b> Menu( &quot;Forward&quot;);
0094              
0095                 <i>forward5</i> = <b>new</b> MenuItem(  &quot;5 Steps&quot;);
0096                 <i>forward5</i>.setActionCommand( &quot;fd 5&quot;);
0097                 <i>forward5</i>.addActionListener( <i>itsListener</i>);
0098                 <i>moveForwardMenu</i>.add( <i>forward5</i>); 
0099                 
0100                 <i>forward10</i> = <b>new</b> MenuItem(  &quot;10 Steps&quot;);
0101                 <i>forward10</i>.setActionCommand( &quot;fd 10&quot;);
0102                 <i>forward10</i>.addActionListener( <i>itsListener</i>);
0103                 <i>moveForwardMenu</i>.add( <i>forward10</i>);   
0104                      
0105                 <i>forward25</i> = new MenuItem(  &quot;25 Steps&quot;);
0106                 <i>forward25</i>.setActionCommand( &quot;fd 25&quot;);
0107                 <i>forward25</i>.addActionListener( <i>itsListener</i>);               
0108                 <i>moveForwardMenu</i>.add( <i>forward25</i>);
0109              <i>moveMenu</i>.add( <i>moveForwardMenu</i>);

<b>----             // Construction of the </b><i>moveBackwardMenu</i><b> omitted.

</b>0125             
0127              <i>moveMenu</i>.add( <i>moveBackwardMenu</i>);
0128        <i>mainMenuBar</i>.add( <i>moveMenu</i>);

<b>----        // Construction of the other menus omitted.

</b>0285         <i>mainMenuBar</i>.add( <i>helpMenu</i>);    
0286         <i>mainMenuBar</i>.setHelpMenu( <i>helpMenu</i>);                  
0287  
0288         <i>itsFrame</i>.setMenuBar( <i>mainMenuBar</i>);
0289      } // End <i>MenuBarTuttleInterface</i> constructor.</font></pre>

<p>This process is not particularly difficult, but it is complex
and provides opportunity for confusing mistakes to creep in. To
assist with understanding and maintaining the code it is
suggested that indentation, which is conventionally used to
indicate levels of program control structure, is used to indicate
levels of the menu hierarchy. Thus the <font size="2"
face="Arial"><i>moveMenu</i></font> steps are indented one level
from the <font size="2" face="Arial"><i>mainMenuBar</i></font>
steps. Likewise the cascading <font size="2" face="Arial"><i>moveForwardMenu</i></font>
and <font size="2" face="Arial"><i>moveBackwardMenu</i></font>
steps are indented to the right of the <font size="2"
face="Arial"><i>moveMenu</i></font>, and the population of these
two cascading menus is one further level of indentation to the
right. </p>

<p>The two arguments to the constructor are the <font size="2"
face="Arial">Frame</font> instance within which the menu is to be
installed and the identity of the <font size="2" face="Arial">ActionListener</font>
object to which all the active menu items are to dispatch <font
size="2" face="Arial">ActionEvent</font>s when they are activated
by the user. On lines 0039 to 0079 the <font size="2"
face="Arial">MenuBar</font> and all the <font size="2"
face="Arial">Menu</font>s and <font size="2" face="Arial">MenuItem</font>s
shown, or implied, in Figure 6.5 are declared. All the <font
size="2" face="Arial"><i>CheckBoxMenuItem</i></font>s, which will
populate the <i>Color</i> menus and the lower part of the <i>Screen</i>
menu are declared, outside the scope of the constructor, as
instance attributes of the class, for reasons which will be
explained below.</p>

<p>The constructor's first step, on line 0081, is to construct
the <font size="2" face="Arial"><i>mainMenuBar</i></font> as an
instance of the <font size="2" face="Arial">MenuBar</font> class.
The <font size="2" face="Arial"><i>fileMenu</i></font> pane is
then constructed on line 0083 and populated with a single item on
lines 0084 to 0087. Line 0084 constructs the <font size="2"
face="Arial"><i>exitButton</i></font> which, as it will control
the posting of a dialog, has the conventional three dots
(&nbsp;&#133;&nbsp;) at the end of its label. Lines 0085 and 0086
then establish its <font size="2" face="Arial">actionCommand</font>
and <font size="2" face="Arial">actionListener</font> resources
before the <font size="2" face="Arial"><i>exitButton</i></font> <font
size="2" face="Arial">MenuItem</font> is added to <font size="2"
face="Arial"><i>fileMenu</i> Menu</font> on line 0087. As the <font
size="2" face="Arial"><i>fileMenu</i></font> is now completely
constructed it is added to the <font size="2" face="Arial"><i>mainMenuBar</i>
MenuBar</font> instance on line 0089.</p>

<p>The construction of the <font size="2" face="Arial"><i>moveMenu</i></font>,
on lines 0091 to 0127, continues this method. The <font size="2"
face="Arial"><i>moveMenu</i> Menu</font> instance is populated by
two items both of which are themselves <font size="2"
face="Arial">Menu</font> instances and so will behave as <i>cascading&nbsp;menus</i>.
The first of these, <font size="2" face="Arial"><i>moveForwardMenu</i></font>,
is constructed on line 0093 and, as it will subsequently be added
to another <font size="2" face="Arial">Menu</font> instance, Java
is able to recognize it as a cascading menu. Because of this the
developer need not explicitly specify that its label should be
followed by an arrow as Java will automatically supply one. </p>

<p>Before the <font size="2" face="Arial"><i>moveForwardMenu</i></font>
is added to the <font size="2" face="Arial"><i>moveMenu</i></font>,
on line 0109, it is populated with its three buttons. The
construction, configuration and installation of the three <font
size="2" face="Arial"><i>MenuItem</i></font>s: <font size="2"
face="Arial"><i>forward5</i></font>, <font size="2" face="Arial"><i>forward10</i></font>
and <font size="2" face="Arial"><i>forward25</i></font>, is
accomplished on lines 0095 to 0108 using techniques which are
essentially identical to those used for the <font size="2"
face="Arial"><i>exitButton</i></font> as described above.</p>

<p>The construction of the <font size="2" face="Arial"><i>moveBackwardMenu</i></font>
is essentially identical to that of the <font size="2"
face="Arial"><i>moveForwardMenu</i></font> and has been omitted
from the listing. When, on line 0127, it has been added to the <font
size="2" face="Arial"><i>moveMenu </i></font>the <font size="2"
face="Arial"><i>moveMenu </i></font>is complete and it is added
to the <font size="2" face="Arial"><i>mainMenuBar</i></font> on
line 0128. </p>

<p>The constructor continues with the construction of the
remaining three menus, whose significant differences will be
described below, concluding with the <font size="2" face="Arial">add</font>ition
of the <font size="2" face="Arial"><i>helpMenu</i></font> on line
0285. This menu is then nominated as the <font size="2"
face="Arial"><i>helpMenu</i></font> on line 0286. This will
ensure that this menu is always the rightmost item on the menu
bar and in some environments, for example X/&nbsp;Motif, will be
positioned at the extreme right of the menu bar. The final step
of the <font size="2" face="Arial"><i>MenuBarTuttleInterface</i></font>
constructor, on line 0288, is to install the <font size="2"
face="Arial">MenuBar</font> into the <font size="2" face="Arial">Frame</font>
passed as an argument to the constructor, using the <font
size="2" face="Arial">Fame</font>'s <font size="2" face="Arial">setMenuBar()</font>
method.</p>

<p>This pattern of construction can be used whenever a top level
menu system needs to be constructed. The contents of each menu
and, if required, of each cascading menu can be designed on paper
using a technique similar to that in Figure 6.2. Having done this
the <font size="2" face="Arial"><i>init()</i></font> method from
this example can be amended to implement the new requirements. </p>

<p>The construction of the <i>Color</i> menu differs a little
from the construction of the <i>Move</i> menu as it is contains <font
size="2" face="Arial">CheckBoxMenuItems</font>, as shown in the
instance hierarchy in Figure 6.6.</p>

<p align="center"><b><img src="fig66.gif" width="770"
height="313"></b></p>

<p align="center"><b>Figure 6.6</b> Partial <font face="Arial"><i>mainMenuBar</i></font>
instance hierarchy. <i>Color</i> menu structure.</p>

<p>This hierarchy is built in the constructor, as follows. </p>

<pre><font size="3">0168            <i>colorMenu</i> = <b>new</b> Menu( &quot;Colors&quot;);
0169         
0170               <i>foregroundMenu</i>  = <b>new</b> Menu( &quot;Foreground&quot;);
0171                  <i>greenTuttle</i>  = <b>new</b> CheckboxMenuItem ( &quot;Green&quot;);
0172                  <i>greenTuttle</i>.setActionCommand( &quot;fg green&quot;);
0173                  <i>greenTuttle</i>.addActionListener( <i>itsListener</i>);
0174                  <i>foregroundMenu</i>.add( <i>greenTuttle</i>);
<b>---                   // Construction of other foreground </b><i>CheckboxMenuItems</i><b> omitted.

</b>0175                  
0236            <i>colorMenu</i>.add( <i>foregroundMenu</i>);
0203  
0204               <i>backgroundMenu</i>  = <b>new</b> Menu( &quot;Background&quot;);
0205                  <i>greenBack</i>  = <b>new</b> CheckboxMenuItem ( &quot;Green&quot;);
0206                  <i>greenTuttle</i>.setActionCommand( &quot;bg green&quot;);
0207                  <i>greenTuttle</i>.addActionListener( <i>itsListener</i>);                
0208                  <i>backgroundMenu</i>.add( <i>greenBack</i>);
0209                  
<b>---                   // Construction of other background </b><i>CheckboxMenuItems</i><b> omitted.
</b>0235            
0237            <i>colorMenu</i>.add( <i>backgroundMenu</i>);
0238         <i>mainMenuBar</i>.add( <i>colorMenu</i>);</font></pre>

<p>The only significant difference in the construction of this
menu structure is that the items added to the cascading menus are
instances of the <font size="2" face="Arial"><i>CheckboxMenuItem</i></font>
class, not the <font size="2" face="Arial"><i>MenuItem</i></font>
class. This will allow each menu item to be accompanied on the
menu by a state indicator, as shown in Figure 6.2. The <font
size="2" face="Arial"><i>CheckboxMenuItem</i></font> constructor
used in their construction does not explicitly specify the state
of the indicator and so the default, unchecked, state is used for
all of them. However these buttons have to the configured as <i>radio&nbsp;buttons</i>,
ensuring that one, and only one, of the items is selected at any
time. This is accomplished by another method of the <font
size="2" face="Arial"><i>MenuBarTuttleInterface</i></font> class,
<font size="2" face="Arial"><i>setForegroundCheckmark(),</i></font>
implemented as follows. </p>

<pre><font size="3">0293     <b>protected void</b> <i>setForegroundCheckmark</i>( String <i>toSet</i>) { 
0294        <b>greenTuttle</b>.setState(  <b>false</b>);
0295        <b>redTuttle</b>.setState(    <b>false</b>);
0296        <b>blueTuttle</b>.setState(   <b>false</b>);
0297        <b>yellowTuttle</b>.setState( <b>false</b>);
0298        <b>whiteTuttle</b>.setState(  <b>false</b>);
0299        <b>blackTuttle</b>.setState(  <b>false</b>);
0300        
0301        <b>if</b> ( <i>toSet</i>.equals( &quot;green&quot;)) { 
0302           <i>greenTuttle</i>.setState( <b>true</b>);
0303        } <b>else if</b> ( <i>toSet</i>.equals( &quot;red&quot;)) {
0304           <i>redTuttle</i>.setState( <b>true</b>);
0305        } <b>else if</b> ( <i>toSet</i>.equals( &quot;blue&quot;)) {
0306           <i>blueTuttle</i>.setState( <b>true</b>);
0307        } <b>else if</b> ( <i>toSet</i>.equals( &quot;yellow&quot;)) {
0308           <i>yellowTuttle</i>.setState( <b>true</b>);
0309        } <b>else if</b> ( <i>toSet</i>.equals( &quot;white&quot;)) {
0310           <i>whiteTuttle</i>.setState( <b>true</b>);
0311        } <b>else if</b> ( <i>toSet</i>.equals( &quot;black&quot;)) {
0312           <i>blackTuttle</i>.setState( <b>true</b>);
0313        } // End if.   
0314     } // End <i>setForegroundCheckmark</i>.</font></pre>

<p>The method commences, on lines 0294 to 0299, by ensuring that
all check markers are set off. The six way <font size="2"
face="Arial"><b>if</b></font> structure on lines 0301 to 0313
then sets the state indicator of the item indicated by the <font
size="2" face="Arial"><i>toSet</i></font> argument. It is the
responsibility of the <font size="2" face="Arial"><i>MenuBarTuttle</i></font>
class to ensure that this method is called to indicate the
initial <font size="2" face="Arial"><i>Tuttle</i></font>
foreground color before the menus are presented to the user for
the first time. Similar <font size="2" face="Arial"><i>setForegroundCheckmark()</i></font>
and<i> </i><font size="2" face="Arial"><i>setPenUpCheckmark()</i></font>
methods are supplied to ensure that the background color buttons
and the pen buttons on the <i>Screen</i> menu, also behave as
radio buttons.</p>

<p>The only remaining significant difference is the inclusion of
separators on the <i>Screen</i> menu, which are constructed and
added by the following code fragment.</p>

<pre><font size="3">----
0250               <i>screenMenu</i>.add( <i>resetScreen</i>);
0251               
0252               <i>screenMenu</i>.addSeparator();
0253               
0254               <i>clsetScreen</i> = new MenuItem( &quot;Clear and Reset&quot;); 
0255               <i>clsetScreen</i>.setActionCommand( &quot;cr&quot;);
0256               <i>clsetScreen</i>.addActionListener( <i>itsListener</i>);             
0257               <i>screenMenu</i>.add( <i>clsetScreen</i>); 
0258               
0259               <i>screenMenu</i>.addSeparator();
0260               
0261               <i>penUpCheck</i>   = new CheckboxMenuItem( &quot;Pen up&quot;); 
0262               <i>screenMenu</i>.add( <i>penUpCheck</i>); 
0263               <i>penDownCheck</i> = new CheckboxMenuItem( &quot;Pen down&quot;); 
0264               <i>screenMenu</i>.add( <i>penDownCheck</i>); 
----</font></pre>

<p><font size="3"></font>&nbsp;</p>

<hr>

<blockquote>
    <p><a
    href="..\tuttles\menubartuttle\menubartuttleinterface.java"><font
    size="5"><img src="list.gif" align="middle" border="0"
    width="40" height="35"> MenuBarTuttleInterface.java</font></a></p>
</blockquote>

<hr>

<blockquote>
    <p><a href="ch65.html"><img src="next.gif" align="middle"
    border="0" width="50" height="40"><font size="5">6.5 The </font><font
    size="4" face="Arial"><i>MenuBarTuttle</i></font><font
    size="5"> class</font></a></p>
    <p><a href="ch63.html"><font size="4"><img src="last.gif"
    align="middle" border="0" width="50" height="40"></font><font
    size="5">6.3 </font><font size="4" face="Arial"><i>MenuBarTuttle</i></font><font
    size="5"> construction overview</font></a></p>
</blockquote>

<hr>
</body>
</html>
