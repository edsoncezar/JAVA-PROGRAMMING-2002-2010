<html>

<head><meta http-equiv="pragma" content="no-cache">

<meta NAME="GENERATOR" CONTENT="Internet Assistant for Microsoft Word 2.0z">
<title>14.5 The OrderedList constructor and add() actions</title>

</head>

<body BGCOLOR="WHITE">

<h2>14.5 The <i>OrderedList</i> constructor and <i>add()</i> actions
</h2>



<p>
The class diagram for the <i>OrderedList</i>
class is given in Figure 14.6.<br>

<p>
<center><img SRC="c14p5i1.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter14/c14p5i1.gif" WIDTH="497" HEIGHT="631">
</center>
<p>
This diagram introduces a new convention for class diagrams: the
names of any interfaces which are implemented by the class are
bracketed and given in grey below the name of the class. So the
start of this diagram indicates that it extends the <i>GenericStructure</i>
class to supply the <i>OrderedList</i>
class and implements the <i>OrderedStructure</i>
interface. As shown on the diagram, a class which implements an
interface need not limit itself to the actions specified by the
interface, it can also supply additional actions. However when
an instance of such a class is passed as an instance of the interface
class, only the interface actions can be used in the action where
it is received.<br>

<p>
The <i>OrderedList</i> constructor
is implemented as call of its parent, <i>GenericStructure</i>,
constructor. The implementation of the class, as far as the end
of the constructor, is as follows. <br>

<pre>
0001  // Filename <i>OrderedList.java</i>.
0002  // Class to implement the <i>OrderedStructure</i> interface
0003  // making use of a Vector. 
0004  //
0005  // Written for JFL book, chapter 14.
0006  // Fintan Culwin, v0.1, August 1997.
0007  
0008  
0009  <b>package</b> <i>Generics</i>;
0010  
0011  <b>import</b> <i>Generics.GenericStructure</i>;
0012  <b>import</b> <i>Generics.GenericException</i>;
0013  <b>import</b> <i>Generics.OrderedStructure</i>;
0014  <b>import</b> <i>Generics</i>.<i>AlreadyPresentException</i>;
0015  
0016  <b>import</b> java.util.Vector;
0017  <b>import</b> java.util.Enumeration;
0018  <b>import</b> java.util.NoSuchElementException;
0019  <b>import</b> java.lang.ArrayIndexOutOfBoundsException;
0020  
0021  <b>public class</b> <i>OrderedList</i> <b>extends</b>     <i>GenericStructure</i>
0022                           <b>implements</b>  <i>OrderedStructure</i>{ 
0023  
0024  <b>private</b> Vector <i>theList</i> = <b>new</b> Vector();
0025  
0026  <b>private static final int</b> <i>KEY_NOT_PRESENT</i> = -1;
0027  
0028  
0029     <b>public</b> <i>OrderedList</i>( Class <i>theElementClass</i>) { 
0030        <b>super</b>( <i>theElementClass</i>);     
0031     } // end <i>OrderedList</i> constructor.<br>

</pre>

<p>
The <i>AlreadyPresentException</i>,
imported on line 0014, is supplied by the <i>Generics</i>
package with the intention that it should be thrown if an attempt
is made to add an element to an <i>OrderedStructure</i>
which has the same key value as an existing element. The class
is declared on lines 0021 and 0022 with the encapsulated Vector
instance, <i>theList</i>, declared
and constructed on line 0024. The manifest value on line 0026
will be used to communicate the result of a search within the
class, as will be explained below. The definition of the constructor
follows on lines 0029 to 0031.<br>

<p>
The design of the <i>add()</i>
action is as follows. <br>

<p>
<center><img SRC="c14p5i2.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter14/c14p5i2.gif" WIDTH="714" HEIGHT="604">
</center>
<p>
The essence of this design can be explained by considering a list
of e-mail addresses and tracing the design as new addresses are
added. Assume that an <i>OrderedList</i>
contains the e-mail addresses shown in Figure 14.6.<br>

<p>
<center><img SRC="c14p5i3.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter14/c14p5i3.gif" WIDTH="444" HEIGHT="162">
</center>
<p>
If the address <i>dull@hopeless.com</i> is to be added the correct
location for it to be inserted is at location 1. On the first
iteration the address at location 0 will be examined and, as it
is not equal to or greater than the address to be inserted, the
loop will iterate to consider location 1. The address at this
location is not equal to the new address but it is alphabetically
greater than it causing the loop to terminate and the new address
to be inserted at location 1, automatically moving all subsequent
addresses down the list.  <br>

<p>
If the address <i>wally@nowhere.edu</i> is to be added to the
list as shown in Figure 14.6 it should be added at location 3,
beyond the end of the existing addresses. In this case the loop
will iterate three times as none of the addresses are equal to
or greater than the new address, and the new address will be appended
to the list. <br>

<p>
If any attempt is made to add an address which is equal to one
of the existing addresses then an <i>AlreadyPresentException</i>
will be thrown. As it is not possible to examine the contents
of an empty list this is treated as a special case. The implementation
of this design is as follows. <br>

<pre>
0034     <b>public void</b> <i>add</i>(<i>Keyable toAdd</i>) {
0035  
0036     <i>Orderable</i>  <i>keyToAdd</i>        = <i>toAdd.keyValueIs</i>();
0037     <i>Orderable</i>  <i>thisKeyValue</i>;
0038     <b>int</b>        <i>thisComparison</i>;
0039     <b>int</b>        <i>thisLocation</i>     = 0;
0040     <b>int</b>        <i>numberOfElements</i> = <i>theList</i>.size();
0041     <b>boolean</b>    <i>locationFound</i>    = false;
0042 
0043        <b>if</b> ( !<i>isAcceptableElement</i>( <i>toAdd</i>) ){ 
0044           <b>throw new</b> <i>GenericException</i>();
0045        } <b>else</b> {      
0046           <b>if</b> ( <b>this</b>.isEmpty()) { 
0047              <i>theList</i>.addElement( <i>toAdd.copy()</i>);
0048           } <b>else</b> { 
0049              <b>while</b> ( !<i>locationFound</i>) {
0050                 <i>thisKeyValue</i> = ( (<i>Keyable</i>) <i>theList</i>.elementAt( 
0051                                            <i>thisLocation</i>)).<i>keyValueIs</i>();
0052                 <b>if</b> ( <i>thisKeyValue.keyIsEqualTo</i>( <i>keyToAdd</i>) ){ 
0053                    <b>throw new</b> <i>AlreadyPresentException</i>();
0054                 } <b>else if</b> ( <i>thisKeyValue.keyIsGreaterThan</i>( <i>keyToAdd</i>) ){ 
0055                    <i>locationFound</i>  = <b>true</b>;
0056                 } <b>else</b> { 
0057                    <i>locationFound</i> = (++<i>thisLocation</i> == <i>numberOfElements)</i>; 
0058                 } // End if.                    
0059              } // End while.                     
0060              <i>theList.insertElementAt</i>( <i>toAdd.copy()</i>, <i>thisLocation</i>);          
0061           } // end if.
0062        } // End if.
0063     } // End add.<br>

</pre>

<p>
On line 0036 the key value of the element which is to be added
is obtained using its <i>keyValueIs()</i>
action. Assuming that the element <i>toAdd</i>
is acceptable and the list is empty a copy of the element is added
to the vector in line 0047.<br>

<p>
Otherwise lines 0050 and 0051 will control an indefinite iteration.
The phrase <i>theList.elementAt(&nbsp;thisLocation)</i>
will return the Object stored
at <i>thisLocation</i> in the
Vector <i>theList</i>.
This has to be cast to the <i>Keyable</i>
class, which is safe as only <i>Keyable</i>
objects have been stored in the list, before its <i>keyValueIs()</i>
action can be applied to obtain its key value. The <i>Orderable</i>
relational actions are then used on lines 0052 and 0054 to decide
if an element with the same key value is already present or if
the next element in the Vector
has a key value greater than the value to be inserted, which would
indicate that the new element should be added at the current location.
Otherwise, on line 0057, the <i>thisLocation</i>
index is incremented and tested to ensure that it does not now
indicate that all elements in the Vector
have been examined, which would indicate that the new element
should be added at then end of the list.<br>

<p>
If the exception is not thrown on line 0053 then, after the loop
has terminated, the value of <i>thisLocation</i>
will indicate where in the Vector
<i>theList</i> a copy of the
element <i>toAdd</i> should be
inserted into the list. This is accomplished on line 0060. The
start of a demonstration harness which illustrates the adding
of elements of the <i>Persons</i>
class to a suitably instantiated <i>OrderedList</i>
is as follows. <br>

<pre>
0001  // Filename <i>OrderedListDemo.java</i>.
0002  // Demonstration harness for the OrderedList class.
0003  //
0004  // Written for JFL book, chapter 14.
0005  // Fintan Culwin, v0.1, August 1997.
0006  
0007  
0008  <b>import</b> <i>Generics.OrderedList</i>;
0009  <b>import</b> <i>Generics.GenericException</i>;
0010  <b>import</b> <i>Persons</i>.*;
0011  
0012  <b>class</b> <i>OrderedListDemo</i> {
0013  
0014    <b>public static void</b> <i>main</i>(String <i>args</i>[]) {
0015  
0016    <i>EmailAddress demoAddress</i>;  
0017    <i>NamedPerson  demoNamedPerson</i> = <b>new</b> <i>NamedPerson</i>(); 
0018    <i>PhonePerson</i>  <i>demoPhonePerson</i>;
0019    String       <i>demoString</i>;
0020    
0021    <i>OrderedList demoList</i> = <b>new</b> <i>OrderedList</i>( <i>demoNamedPerson</i>.getClass());
0022    
0023    
0024       System.out.println( &quot;\tOrdered List Demonstration Program\n\n&quot;);
0025       
0026       System.out.println( &quot;Adding three instances to the list ...&quot;);
0027       
0028       <i>demoNamedPerson</i> = <b>new</b> <i>NamedPerson</i>( &quot;sad@lost.org&quot;,
0029                                          &quot;Suzie Sad&quot;);
0030       <i>demoList.add</i>( <i>demoNamedPerson</i>);      
0031      
0032       <i>demoPhonePerson</i> = <b>new</b> <i>PhonePerson</i>( &quot;geek@nowhere.edu&quot;,
0033                                          &quot;Gary Geek&quot;,
0034                                          &quot;111-2222&quot;);
0035       <i>demoList.add</i>( <i>demoPhonePerson</i>); 
0036
0037       <i>demoNamedPerson</i> = <b>new</b> <i>NamedPerson</i>( &quot;anorak@boring.com&quot;,
0038                                          &quot;Andy Anorak&quot;);
0039       <i>demoList.add</i>( <i>demoNamedPerson</i>);
0040       
0041  
0042      System.out.println( &quot;\nShowing the list ...\n&quot;);
0043      System.out.println( <i>demoList</i>);<br>

</pre>

<p>
The construction of the <i>demoList</i>
on line 0021 is essentially identical, in concept, to the construction
of the <i>Queue</i> class earlier
in this chapter. Once constructed three <i>Persons</i>
instances are constructed and added to the list, in reverse alphabetic
order, before the list is output. The output from this part of
the demonstration, which seems to indicate that parts of the <i>add()</i>
action are operating correctly, was as follows.<br>

<hr>

<pre>
<ul>

          Ordered List Demonstration Program

Adding three instances to the list ...

Showing the list ...

1  E-mail : anorak@boring.com Name : Andy Anorak
2  E-mail : geek@ nowhere.edu Name : Gary Geek Phone : 111-2222
3  E-mail : sad@lost.org Name : Suzie Sad<br>

</ul>
</pre>


<p>
<hr>
<h2>
<ul>
<a HREF="orderedlist.java" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter14/OrderedList.java"><img SRC="..\list.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/list.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="40" HEIGHT="35">
<i>OrderedList.java</i> source code</a>.
<p>
<a HREF="http://www.scism.sbu.ac.uk/tppmsgs/msgs39.htm#7912" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter14/OrderedListdemo.java"><img SRC="..\list.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/list.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="40" HEIGHT="35">
<i>OrderedListDemo.java</i> source code</a>.


<p>
<a HREF="chap14p6.html" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter14/chap14p6.html"><img SRC="..\next.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/next.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="50" HEIGHT="40">
14.6 The <i>OrderedList</i> remaining actions</a>.
<p>
<a HREF="chap14p4.html" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter14/chap14p4.html"><img SRC="..\last.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/last.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="50" HEIGHT="40">
14.4 The <i>Generics</i> interfaces</a>.
<p>
</ul>
</h2>
<hr>
</body>

</html>
