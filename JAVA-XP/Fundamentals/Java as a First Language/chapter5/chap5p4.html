<html>

<head><meta http-equiv="pragma" content="no-cache">

<meta NAME="GENERATOR" CONTENT="Internet Assistant for Microsoft Word 2.0z">
<title>5.4 The MoneyRegister hierarchy &amp; the MoneyRegister implementation</title>

</head>

<body BGCOLOR="WHITE">

<h2>5.4 The <i>MoneyRegister</i> hierarchy &amp; the <i>MoneyRegister</i>
implementation<br>
</h2>

<p>
The second part of this chapter will introduce an extension to
the <i>Counters</i> hierarchy which implements a series of increasingly
sophisticated cash registers. The revised class hierarchy diagram,
including the <i>RoomMonitor</i> class, is given in Figure 5.3.
<br>

<center>
<img SRC="c5p4i0.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter5/c5p4i0.gif" WIDTH="588" HEIGHT="205">
</center>

<p>
<center><font>Figure 5.3. The extended <i>Counters</i>
class hierarchy diagram.<br>
</font></center>
<p>
The <i>MoneyRegister</i> class supplies the basic functionality
including: knowing how much cash is in the register when it is
started, known as the <i><b>initial</b></i>&nbsp;<i><b>float</b></i>,
the amount of cash in the register and, by inheritance, the number
of deposits which have been made. The <i>MultipleRegister </i>keeps
separate accounts for the amount of payments made by cash, by
cheque, by debit card and by credit card. The class diagram of
the <i>MoneyRegister</i> class is given in Figure 5.4.<br>

<p>
<center>
<img SRC="c5p4i1.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter5/c5p4i1.gif" WIDTH="329" HEIGHT="405">
</center>
<p>
<center><font>Figure 5.4 The <i>MoneyRegister</i> class
diagram.<br>
</font></center>
<p>
The diagram indicates that the <i>MoneyRegister</i> is a subclass
of the <i>WarningCounter</i> class whose constructor required
the initial amount of cash in the register to be specified. The
<i>deposit</i> action will allow an amount of money to be deposited
into the register and the <i>numberOfDepositsIs</i> action will
indicate the number of deposits which have been made. The <i>takingsAre</i>
action will return the total amount of money deposited into the
register and the <i>totalInRegisterIs</i> action the total amount,
including the initial cash float. The final action, <i>toString</i>,
returns a string indicating the state of the register. <br>

<p>
The first part of the implementation of this class, as far as
the end of the constructor, is as follows. <br>

<pre>
<font>0001 // Filename <i>Counters/MoneyRegister.java</i>.
0002 // Providing an initial Cash Register model.
0003 //
0004 // Written for JFL book Chapter 5 see text.
0005 // Fintan Culwin, v0.1, January 1997
0006  
0007 <b>package</b> <i>Counters</i>;
0008  
0009 <b>public class</b> <i>MoneyRegister </i><b>extends</b> <i>WarningCounter </i>{ 
0010 
0011 // Largest positive int value, 2147483647 in decimal.
0012 <b>private static final int</b> <i>MAXINTEGER </i>= 0x7FFFFFFF;
0013 
0014  <b>private double</b> <i>theCashFloat</i>;
0015  <b>private double</b> <i>theTakings</i>; 
0016 
0017     <b>public</b> <i>MoneyRegister</i>( <b>double</b> <i>initialCashFloat</i>) {  
0018         <b>super</b>( 0, <i>MAXINTEGER</i>);
0019         <i>theCashFloat </i>= <i>initialCashFloat</i>;
0020         <i>theTakings   </i>= 0;
0020     }  // End Constructor.<br>
</font>
</pre>

<p>
This cash register assumes a currency like British pounds or U.S.
dollars which has a fractional part (e.g. <i>£53.86</i> or
<i>$18.32</i>), unlike currencies like the Italian lira which
have no fractional part ( e.g. <i>7345</i> lira). An revised implementation
of the <i>MoneyRegister</i> hierarchy will be presented in Chapter
?, which allows for this consideration. In order to allow for
the fractional parts a floating point data type will have to be
used for the data attributes and used where appropriate as the
<b><font FACE="Arial">return</font></b> type, or argument
type, of the classes actions. <br>

<p>
Thus the two data attributes, <i><font FACE="Arial">theCashFloat</font>
</i>and<i> <font FACE="Arial">theTakings</font></i> on
lines 0014 and 0015, are declared as being of type <b><font FACE="Arial">double</font></b>,
which is the preferred Java floating point type. Details of the
Java floating point types are given in Appendix A.<br>

<p>
The declaration of the constructor follows on lines 0017 to 0020.
Its first action is a call to the <i><font FACE="Arial">WarningCounters</font></i>
constructor using the <b><font FACE="Arial">super</font></b>
keyword, passing values as described in the <i><font FACE="Arial">RoomMonitor</font></i>
class above. The value of the argument, <i><font FACE="Arial">theCashFloat</font>,</i>
is then assigned to the data attribute <i><font FACE="Arial">theCashFloat</font></i>,
and the value of the other data attribute <i><font FACE="Arial">theTakings</font>
</i>is confirmed as zero. <br>

<p>
The <i><font FACE="Arial">deposit()</font></i> action has
to count an occurrence and then add the value of its argument
indicating the <i><font FACE="Arial">amount</font></i>
deposited to <i><font FACE="Arial">theTakings</font></i>.
The first enquiry action, <i><font FACE="Arial">numberOfDepositsIs()</font></i>
is implemented as a call of the <i><font FACE="Arial">Counters</font></i>
<i><font FACE="Arial">numberCountedIs()</font></i> action.
The <i><font FACE="Arial">takingsAre()</font></i> enquiry
action returns the value of the data attribute <i><font FACE="Arial">theTakings</font></i>.
The final enquiry action, <i><font FACE="Arial">totalInRegisterIs()</font></i>,
uses the <i><font FACE="Arial">takingsAre()</font></i>
enquiry action to determine the value of the takings and adds
the value of the data attribute <i><font FACE="Arial">initialCashFloat</font></i>
to obtain the value of the total amount of money in the register.
<br>

<pre>
<font>0023     <b>public void</b> <i>deposit</i>( <b>double</b> <i>amount</i>) { 
0024         <b>this</b>.<i>count</i>();
0025         <i>theTakings</i> += <i>amount</i>;
0026     } // End <i>deposit</i>. 
0027     
0028     
0029     <b>public int</b> <i>numberOfDepositsIs</i>() { 
0030        <b>return</b> <b>this</b>.<i>numberCountedIs</i>();
0031     } // End <i>numberOfDepositsIs</i>. 
0032     
0033     
0034     <b>public double</b> <i>takingsAre</i>() { 
0035         <b>return </b><i>theTakings</i>;
0036     } // End <i>takingsAre</i>. 
0037     
0038     
0039     <b>public double</b> <i>totalInRegisterIs</i>() { 
0040         <b>return</b> <b>this</b>.<i>takingsAre</i>() + <i>theCashFloat</i>;
0041     } // End <i>totalInRegisterIs</i>. <br>
</font>
</pre>

<p>
It would be possible to implement line 0040 as <b><font FACE="Arial">return</font></b><font FACE="Arial">
<i>theTakings</i> + <i>theCashFloat</i></font><i>; </i>but if
at some stage in the future the data attribute <i><font FACE="Arial">theTakings</font></i>
is changed in some way this implementation might not then return
the correct amount. For example, <i><font FACE="Arial">theTakings</font></i><font FACE="Arial">
</font>might be refined into two data attributes one which records
the amount of sales tax and one the nett amount. The <i><font FACE="Arial">takingsAre()</font></i>
action would now return the combined value of the two attributes
and thus it will still be correct; but the alternative implementation
would be broken. If an enquiry action has been declared to obtain
a value from a class then it should be used in preference to accessing
the value of the data attribute directly. For this reason the
<i><font FACE="Arial">toString()</font></i> action makes
use of the appropriate enquiry actions, as follows.<br>

<pre>
<font>0042     
0043     <b>public</b> String <i>toString</i>() { 
0044        return &quot;Initial float      : &quot; + <i>theCashFloat</i>              + &quot;\n&quot; +
0045               &quot;Number of deposits : &quot; + <b>this</b>.<i>numberOfDepositsIs</i>() + &quot;\n&quot; +
0046               &quot;Total takings      : &quot; + <b>this</b>.<i>takingsAre</i>()         + &quot;\n&quot; +
0047               &quot;Total in register  : &quot; + <b>this</b>.<i>totalInRegisterIs</i>();
0048     } // End <i>toString</i>. 
0049 
0050  } // End <i>MoneyRegister<br>
</i></font>
</pre>

<p>
The output produced by this action will be illustrated in the
demonstration client. <br>
<br>

<p>
<hr>
<h2>
<ul>
<a HREF="moneyregister.java" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter5/MoneyRegister.java"><img SRC="..\list.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/list.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="40" HEIGHT="35">
<i>MoneyRegister.java</i> Source code</a>.
<p>
<a HREF="chap5p5.html" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter5/chap5p5.html"><img SRC="..\next.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/next.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="50" HEIGHT="40">
5.5 The <i>MoneyRegisterDemonstration</i> program client</a>.
<p>
<a HREF="chap5p3.html" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter5/chap5p3.html"><img SRC="..\last.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/last.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="50" HEIGHT="40">
5.3 A second implementation of the <i>RoomMonitor</i> class</a>.

</ul>
</h2>
<hr>
</body>

</html>
&#26;