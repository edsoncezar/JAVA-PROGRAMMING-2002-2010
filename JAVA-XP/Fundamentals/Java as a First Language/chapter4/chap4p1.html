<html>

<head><meta http-equiv="pragma" content="no-cache">

<meta NAME="GENERATOR" CONTENT="Internet Assistant for Microsoft Word 2.0z">
<title>4.1 The design and implementation of the RollOverCounter class</title>

</head>

<body BGCOLOR="WHITE">

<h2>4.1 The design and implementation of the <i>RollOverCounter</i> class
</h2>

<p>
The object diagram for the <i>RollOverCounter</i> class is given
in Figure 4.1. <br>

<p>
<center>
<img SRC="c4p1i1.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter4/c4p1i1.gif" WIDTH="468" HEIGHT="347">
</center>
<p>
<center><font>Figure 4.1 The <i>RollOverCounter</i> class
diagram.<br>
</font></center>
<p>
The diagram shows that the <i>RollOverCounter</i> class is an
extension of the <i>LimitedCounter</i> class, that is has two
public constructors which are comparable to the private constructors
of the <i>LimitedCounter</i> class and that it has two actions
called <i>count</i> and <i>unCount</i>. The implementation of
this design as far as the end of the two constructors is as follows.
<br>

<pre>
<font>0001  // Filename <i>Counters/RollOverCounter.java</i>.
0002  // Providing a non-abstract counter class with 
0003  // roll over behaviour.
0004  //
0005  // Written for JFL book Chapter 4 see text.
0006  // Fintan Culwin, v0.1, January 1997
0007  
0008  <b>package</b> <i>Counters</i>;
0009  
0010  <b>public class</b> <i>RollOverCounter </i><b>extends</b> <i>LimitedCounter </i>{ 
0011 
0012     <b>public</b> <i>RollOverCounter</i>() {  
0013         <b>super</b>();
0014     }  // End default Constructor.
0015     
0016     <b>public</b> <i>RollOverCounter</i>( <b>int</b> <i>minToCount</i>, <b>int</b> <i>maxToCount</i>) {  
0017         <b>super</b>( <i>minToCount</i>, <i>maxToCount</i>);
0018     }  // End principal Constructor.
0019 <br>
</font>
</pre>

<p>
The header comments, package statement and start of the declaration
of the <i><font FACE="Arial">RollOverCounter</font></i>
class on lines 0001 to 0010 are directly comparable to the start
of previous class declaration files. <br>

<p>
The two constructors, between lines 0012 to 0018, are implemented
as dispatching calls to the protected <i><font FACE="Arial">LimitedCounter</font></i>
constructors by making use of the <b><font FACE="Arial">super</font></b>
keyword. Just as the keyword <b><font FACE="Arial">this</font></b>
always refers to the class which is currently being defined, the
keyword <b>super</b> refers to its parent class, or classes. The
<i><font FACE="Arial">RollOverCounter</font></i> class
adds no additional data attributes and so it does not need to
perform any additional initialisation upon construction and can
dispatch immediately to its parent constructors. As was explained
in Chapter 3, the effect of the <i><font FACE="Arial">LimitedCounter</font></i>
constructors is to establish the range of values which an instance
can count between, either the default range for the default constructor
or the range defined by the arguments of the principal constructor.
<br>

<p>
The implementation of the <i>count</i> action will require a design
which introduces a new design technique. A protected <i>count</i>
action without any arguments has already been introduced into
the hierarchy by the <i>BasicCounter</i> class. This action cannot
be used directly as it has no knowledge of the limits introduced
by the <i>LimitedCounter</i> class. The <i>count</i> action in
the <i>RollOverCounter</i> class must only call the <i>BasicCounter</i>
<i>count</i> action if it is appropriate to do so, that is when
the current value is not at the upper limit of its range. If the
counter is at the upper limit of its range then the protected
<i>setCountTo</i> action of the <i>BasicCounter</i> class should
be used to reset the counter to the start of its range, using
the protected <i>minimumIs</i> action of the <i>LimitedCounter</i>
class to provide the value to set the counter to. This can be
expressed on a JSP design as follows. <br>

<p>
<center>
<img SRC="c4p1i2.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter4/c4p1i2.gif" WIDTH="694" HEIGHT="349">
</center>
<p>
The interpretation of this design is that the action <i>count</i>
is a <i><b>selection</b></i> between two possibilities: <i>reset&nbsp;to&nbsp;minimum</i>
and <i>safe&nbsp;to&nbsp;count</i>. Any design step with a <b><sup><font SIZE="5">o</font></sup></b>
in the top right hand corner is taken to be an <b>o</b>ptional
part of a selection and the step must be accompanied by a <b>c</b>ondition
key to explain how the decision between the options will be made.
In this design the decision is made by evaluating condition 1
(&nbsp;<b>c1</b>&nbsp;) and if it is <i>true</i> then the actions
associated with its option, calling the actions <i>set Count To</i>
and <i>minimum Is</i>, will be performed. Otherwise if condition
1 is not true the actions associated with the <b>else </b>option,
calling the <i>BasicCounter</i> <i>count</i> action, will be performed.
The implementation of this design is as follows.<br>

<pre>
<font>0021     <b>public void</b> <i>count</i>(){ 
0022        <b>if</b> ( <b>this</b>.<i>isAtMaximum</i>()) { 
0023          <b>this</b>.<i>setCountTo</i>( <b>this</b>.<i>minimumIs</i>());
0024        } <b>else</b> { 
0025          <b>super</b>.<i>count</i>();
0026        }   
0027     } // End <i>count</i>.<br>
</font>
</pre>

<p>
The implementation of the selection is in the form of an <i><b>if&nbsp;else</b></i>
control structure, the general form of which is as follows.<br>

<pre>
<font>		<b>if</b> ( <i>condition</i> ) { 
			<i>first actions
</i>		} <b>else</b> { 
			<i>second actions
</i>		} // End if.<br>
</font>
</pre>

<p>
When Java meets a structure like this the first thing it does
is work out the value of the <i>condition</i>, which must be written
so that it will only work out to be either <font FACE="Arial">true</font>
or <font FACE="Arial">false</font>. If it is <font FACE="Arial">true</font>
the actions identified as <i>first&nbsp;actions</i> will be performed
and <i>second&nbsp;actions</i> will be ignored. Otherwise the
condition must be false and the <i>second&nbsp;actions</i> will
be performed whilst the <i>first&nbsp;actions</i> are ignored.
<br>

<p>
Returning to the implementation of the <i><font FACE="Arial">count()</font></i>
action, the condition part of the <b><font FACE="Arial">if</font></b>
structure is a call of the <i><font FACE="Arial">isAtMaximum()</font></i>
action. This was introduced into the hierarchy as a protected
action of the <i><font FACE="Arial">LimitedCounter</font></i>
class which returned a <b><font FACE="Arial">boolean</font></b>
value. It was explained in Chapter 3 that a <b><font FACE="Arial">boolean</font></b>
value can either be <b><font FACE="Arial">true</font></b>
or <b><font FACE="Arial">false</font></b>; and that this
action would be <b><font FACE="Arial">true</font></b> if
the counter was at the maximum of its range and <b><font FACE="Arial">false</font></b>
otherwise. As the <i><font FACE="Arial">RollOverCounter</font></i>
class <i><b>is&nbsp;a</b></i>n extended instance of the <i><font FACE="Arial">LimitedCounter</font></i>
class it inherits the <i><font FACE="Arial">isAtMaximum()</font></i>
action as a protected action and thus can call it using <b><font FACE="Arial">this</font></b>.
<br>

<p>
Assuming that the counter is at the maximum of its range the condition
on line 0022 will evaluate <b><font FACE="Arial">true</font></b>
so the statement on line 0023 will be performed and the statement
on line 0025 will be ignored. The effect of the statement on line
0023 is to reset the counter using the <i><font FACE="Arial">setCounterTo()</font></i>
action inherited from <i><font FACE="Arial">BasicCounter</font></i>,
specifying the value obtained from the <i><font FACE="Arial">minimumIs()</font></i>
action inherited from <i><font FACE="Arial">LimitedCounter</font></i>.
As these actions are inherited and thus actions of the current
instance, the <b><font FACE="Arial">this</font></b> designator
is used. The effect is to reset the counter to the minimum of
its range.<br>

<p>
Assuming that the counter is not at the maximum of its range the
condition on line 0022 will evaluate <b><font FACE="Arial">false</font></b>
so the statement on line 0025 will be performed and the statement
on line 0023 will be ignored. The statement on line 0025 calls
the <i><font FACE="Arial">BasicCounter count()</font></i>
action to record an occurrence. If this statement were written
as  <b><font FACE="Arial">this</font></b><font FACE="Arial">.<i>count()</i></font>,
there would be a potential ambiguity. There are two possible meanings
for the <i><font FACE="Arial">count()</font></i> action,
either the one in the <i><font FACE="Arial">RollOverCounter</font></i>
class or the one inherited from the <i><font FACE="Arial">BasicCounter</font></i>
class via the <i><font FACE="Arial">LimitedCounter</font></i>
class. <br>

<p>
However the statement <b><font FACE="Arial">this</font></b><font FACE="Arial">.<i>count()</i></font>
is not ambiguous to Java which would interpret it to mean the
<i><font FACE="Arial">count()</font></i> action in the
class currently being defined. (It does not matter to Java that
it is already in the middle of executing this action; an action
can call itself! This possibility is known as <i><b>recursion</b></i>
and is a very powerful technique which will be introduced in Chapter
?). In order for the developer to indicate to Java that the <i><font FACE="Arial">BasicCounter
count()</font></i> action is intended the <b><font FACE="Arial">super</font></b>
keyword has to be used. This will cause Java to use the <i><font FACE="Arial">count()</font></i>
action inherited from its parent class not the <i><font FACE="Arial">count()</font></i>
action defined in the current class. In this circumstance the
<i><font FACE="Arial">count()</font></i> action is actually
introduced into the class hierarchy by the <i><font FACE="Arial">RollOverCounter</font></i>'s
grandparent class, <i><font FACE="Arial">BasicCounter</font></i><font FACE="Arial">,</font>
but is inherited by the <i><font FACE="Arial">LimitedCounter</font></i>
class which is the <b><font FACE="Arial">super</font></b>
class of the <i><font FACE="Arial">RollOverCounter</font></i>
class.<br>

<p>
When an action with the same return type, name and arguments is
implemented in two places in a hierarchy it is known as <i><b>overriding</b></i>.
It is used to allow a class to specialise an action to its own
requirements. For example: in this case the <i><font FACE="Arial">count()</font></i>
action of the <i><font FACE="Arial">RollOverCounter</font></i>
class behaves in a different way to the <i><font FACE="Arial">count()</font></i>
action of the <i><font FACE="Arial">BasicCounter</font></i>
class; and also in a different way to the <i><font FACE="Arial">count()</font></i>
actions of the <i><font FACE="Arial">StoppingCounter</font></i>
and <i><font FACE="Arial">WarningCounter</font></i> classes,
as will be shown below. Within a class declaration the overriding
action can be explicitly specified by the developer with the <b><font FACE="Arial">this</font></b>
keyword and the overridden action with the <b><font FACE="Arial">super</font></b>
keyword. <br>

<p>
The implementation of the <i><font FACE="Arial">RollOverCounter
unCount()</font></i> action is essentially identical to the implementation
of the <i><font FACE="Arial">count()</font></i> action,
though with a reversal of its logic. Its declaration completes
the declaration of the <i><font FACE="Arial">RollOverCounter</font></i>
class. <br>

<pre>
<font>0030     <b>public</b> <b>void</b> <i>unCount</i>(){ 
0031        <b>if</b> ( <b>this</b>.<i>isAtMinimum</i>()) { 
0032          <b>this</b>.<i>setCountTo</i>( <b>this</b>.<i>maximumIs</i>());
0033        } <b>else</b> { 
0034          <b>super</b>.<i>unCount</i>();
0035        }   
0036     } // End <i>unCount</i>.
0037 
0038  } // End <i>RollOverCounter<br>
<br>
</i></font>
</pre>


<p>
<hr>
<h2>
<ul>
<a HREF="rollovercounter.java" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter4/RollOverCounter.java"><img SRC="..\list.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/list.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="40" HEIGHT="35">
<i>RollOverCounter</i> class source code</a>.
<p>
<a HREF="chap4p2.html" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter4/chap4p2.html"><img SRC="..\next.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/next.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="50" HEIGHT="40">
4.2 The <i>RollOverCounterDemonstration</i> client program</a>.
<p>
<a HREF="chap4.html" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter4/chap4.html"><img SRC="..\last.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/last.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="50" HEIGHT="40">
Chapter 4 The completion of the <i>Counters</i> hierarchy</a>.
</ul>
</h2>
</body>

</html>
&#26;