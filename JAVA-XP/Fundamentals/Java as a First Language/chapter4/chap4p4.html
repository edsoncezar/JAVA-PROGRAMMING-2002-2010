<html>

<head><meta http-equiv="pragma" content="no-cache">

<meta NAME="GENERATOR" CONTENT="Internet Assistant for Microsoft Word 2.0z">
<title>4.4 The design and implementation of the WarningCounter class</title>

</head>

<body BGCOLOR="WHITE">

<h2>4.4 The design and implementation of the <i>WarningCounter</i> class<br>
</h2>

<p>
The behaviour of the <i>RollOverCounter</i> and <i>StoppingCounter</i>
classes is potentially very dangerous. For example: a Geiger counter
could be used to monitor the amount of radiation being used to
treat a cancer. If the software controlling the treatment machine
made use of either of these classes, with its maximum limit set
to the maximum safe dose, then there is no guarantee that it would
stop the treatment before a dangerous dose of radiation was administered.
The <i>WarningCounter</i> class is intended to increase the security
of the software implementation by arranging for a warning to be
issued if any attempt is made to count beyond the maximum limit,
or to uncount below the minimum. This is accomplished in Java
by the <i><b>throwing</b></i> of an <i><b>exception</b></i>, the
details of which will be explained below. <br>

<p>
The class diagram for the <i>WarningCounter</i> class is given
in Figure 4.3. It differs from the previous two classes in that
the <i>count</i> and <i>uncount</i> actions have an exclamation
mark (&nbsp;!&nbsp;) in the top right hand corner to indicate
that an exception might be thrown when they are used. 
<p>
<center>
<img SRC="c4p4i1.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter4/c4p4i1.gif" WIDTH="419" HEIGHT="373">
</center>
<p>
<center><font>Figure 4.3 The <i>WarningCounter</i> class
diagram.<br>
</font></center>
<p>
The exception which will be thrown is an extension of the Java
supplied <i>RuntimeException</i> class, called <i>RuntimeException</i>.
Its object diagram is given in Figure 4.4.<br>

<p>
<center>
<img SRC="c4p4i2.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter4/c4p4i2.gif" WIDTH="374" HEIGHT="255">
</center>
<p>
<center><font>Figure 4.4 The <i>CounterException</i> class diagram.<br>
</font></center>
<p>
The actions of this class consist of two constructors, one a default
constructor and one which requires a reason. As this class will
be used by the <i>WarningCounters</i> class its class declaration
will be presented first. <br>

<pre>
<font>0001  // Filename <i>Counters/CounterException.java</i>.
0002  // Provides an extension of the RuntimeException class 
0003  // for use with the Counters hierarchy.
0004  //
0005  // Written for JFL book Chapter 4 see text.
0006  // Fintan Culwin, v0.1, January 1997
0007  
0008  <b>package</b> <i>Counters</i>;
0009  
0010  <b>class</b> <i>CounterException </i><b>extends</b> <i>RuntimeException </i>{ 
0011  
0012     <b>public</b> <i>CounterException</i>(){
0013       // Do nothing.
0014     } // End default constructor
0015     
0016     <b>public</b> <i>CounterException</i>( String <i>reason</i>) { 
0017        <b>super</b>( <i>reason</i>);
0018     } // End principal constructor
0019     
0020  } // End CounterException<br>
</font>
</pre>

<p>
The implementation of the class is very straightforward: it is
implemented as a non-<b><font FACE="Arial">public</font></b>
class as it is only required by the classes in the <i>Counters</i>
hierarchy and, as its filename indicates, should be stored in
the same directory. The default constructor has to be provided
as a non-default constructor is required, as was explained in
Chapter 3. The non-default constructor is implemented by a call
to the equivalent <i>RuntimeException</i> constructor using <b><font FACE="Arial">super</font></b>;
the use which is made of the <i>reason</i> argument will be explained
below. <br>

<p>
With the <i>CounterException</i> class implemented the <i>WarningCounter</i>
class can be implemented. It differs significantly from the previous
classes only in the design and implementation of the <i>count</i>
and <i>uncount</i> actions. It differs insignificantly in having
to import the <i><font FACE="Arial">Counters.CounterException</font></i>
class in its header. The design of the <i>count</i> action is
as follows. <br>

<p>
<center>
<img SRC="c4p4i3.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter4/c4p4i3.gif" WIDTH="696" HEIGHT="281">
</center>
<p>
The structure of the decision, and its condition, is identical
to the structure and condition of the <i>RollOverCounter count</i>
design. It differs only in the consequences of the counter being
at the maximum of its range, this is the design step <i>cannot
count</i>. This is annotated with a <b>o</b> in the top right
hand corner to indicate that is it part of a selection and also
has a <b>!</b> to indicate that an exception will be thrown. The
exception is keyed at the bottom of the design with a <i><b>q</b></i>,
for <i><b>q</b></i>uit, and the precise reason why the exception
will be thrown. The implementation of this design is as follows.
<br>

<pre>
<font>0021   <b>public void</b> <i>count</i>()  { 
0022      <b>if</b> ( <b>this</b>.<i>isAtMaximum</i>()) { 
0023         <b>throw new</b> <i>CounterException</i>( &quot;Attempt to count beyond limit.&quot;);
0024      } <b>else</b> { 
0025         <b>super</b>.<i>count</i>();
0026      }   
0027   } // End <i>count</i>.<br>
</font>
</pre>

<p>
The design component <i>cannot&nbsp;count</i> is implemented on
line 0023 with a Java <b><font FACE="Arial">throw</font></b>
statement. The exception which is thrown is a <i><font FACE="Arial">CounterException</font></i>
constructed with the <b><font FACE="Arial">new</font></b>
statement and the <i><font FACE="Arial">reason</font></i>
argument set to the string shown. The condition on line 0022 indicates
that this exception will only be thrown if the <i><font FACE="Arial">count()</font></i>
action is called when it is at the maximum limit of its range,
otherwise the call of the <i><font FACE="Arial">BasicCounter
count()</font></i> action on line 0025 will count the occurrence.
The consequences of throwing an exception will be described in
the demonstration client below. <br>

<p>
The design and implementation of the <i><font FACE="Arial">WarningCounter
unCount()</font></i> action are essentially identical. <br>

<p>
<center>
<img SRC="c4p4i4.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter4/c4p4i4.gif" WIDTH="697" HEIGHT="269">
</center>

<pre>
<font>0031     <b>public void</b> <i>unCount</i>()  { 
0032        <b>if</b> ( <b>this</b>.<i>isAtMinimum</i>()) { 
0033          <b>throw new</b> <i>CounterException</i>( &quot;Attempt to count below limit.&quot;);
0034        } <b>else</b> { 
0035          <b>super</b>.<i>unCount</i>();
0036        }   
0037     } // End <i>unCount</i>.<br>
<br>
</font>
</pre>


<p>
<hr>
<h2>
<ul>
<a HREF="warningcounter.java" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter4/WarningCounter.java"><img SRC="..\list.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/list.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="40" HEIGHT="35">
<i>WarningCounter</i> class source code</a>.
<p>
<a HREF="chap4p5.html" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter4/chap4p5.html"><img SRC="..\next.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/next.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="50" HEIGHT="40">
4.5 The design and implementation of the <i>WarningDemonstration</i>
client program </a>.
<p>
<a HREF="chap4p3.html" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter4/chap4p3.html"><img SRC="..\last.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/last.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="50" HEIGHT="40">
4.3 The <i>RollOverCounterDemonstration</i> client program</a>.
</ul>
</h2>
</body>

</html>
&#26;