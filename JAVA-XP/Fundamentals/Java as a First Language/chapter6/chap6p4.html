<html>

<head><meta http-equiv="pragma" content="no-cache">

<meta NAME="GENERATOR" CONTENT="Internet Assistant for Microsoft Word 2.0z">
<title>6.4 The BasicMenu constructor</title>

</head>

<body BGCOLOR="WHITE">

<h2>6.4 The <i>BasicMenu</i> constructor<br>
</h2>

<p>
The design of the constructor is as follows. 
<p>
<center><img SRC="c6p4i1.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter6/c6p4i1.gif" WIDTH="748" HEIGHT="470"></center>
<p>
The first and third steps of the design are concerned with the
menu's title and prompt and will be considered after the middle
step, <i>copy&nbsp;options</i>. The declaration of the private
array data attribute,<i> theOptions[]</i> emphasised that it can
store an iteration of strings, but that it did not specify the
actual number of strings. The number of strings which will have
to be stored in each instance of this structure depends upon the
number of options in the menu and this cannot be known until the
menu is constructed. <br>

<p>
Thus the first action of this step is to set the size of <i>theOptions[]</i>
instance attribute array from the size of the <i>options[]</i>
argument array. Once this has been done each option in turn can
be copied from the argument array, <i>options[]</i>, to the instance
array, <i>theOptions[]</i>. To accomplish this a <i><b>definite&nbsp;iteration</b></i>
is indicated on the design. An iterated step is indicated with
an asterisk (&nbsp;*&nbsp;) in the top right hand corner of its
box and is accompanied by a <i><b>c</b></i>ondition key which
states the number of times which it has to be repeated. So the
<i>copy&nbsp;all&nbsp;options&nbsp;to&nbsp;array</i> step is implemented
as an iteration of the <i>copy&nbsp;an&nbsp;option&nbsp;to&nbsp;array</i>
step, with the iterated step being repeated as many times as there
are strings in the argument array. The condition key identifies
this as a definite iteration by using the word <i><b>for</b></i>.
<br>

<p>
The implementation of this design, with the <i>copy&nbsp;options</i>
step between lines 0031 and 0036, is as follows. <br>

<pre>
0021    <b>public</b> <i>BasicMenu</i>( String <i>title</i>,
0022                      String <i>options</i>[],
0023                      String <i>prompt</i>) { 
0024                      
0025    <b>int</b> <i>thisOption</i>;                     
0026 
0027      <b>if</b> ( <i>title</i>.length() &gt; 0 ) { 
0028         <i>theTitle</i> = <b>new</b> String( <i>title</i>);
0029      } // End if.
0030      
0031      <i>theOptions</i> = <b>new</b> String[ <i>options</i>.length];
0032      <b>for</b> ( <i>thisString</i> = 0; 
0033            <i>thisString</i> &lt; <i>options</i>.length;
0034            <i>thisString</i>++                  ) { 
0035         <i>theOptions</i>[ <i>thisString</i>] = <b>new</b> String( <i>options</i>[ <i>thisString</i>]);  
0036      } // End for.      
0037                           
0038      if ( <i>prompt</i>.length() &gt; 0) { 
0039         <i>thePrompt</i> = <b>new</b> String( <i>prompt</i>);
0040      } // End if. 
0041   } // End <i>BasicMenu.</i>   <br>

</pre>

<p>
Line 0031 implements the design step <i>set&nbsp;size&nbsp;of&nbsp;the&nbsp;options&nbsp;array</i>.
It does this by using an array constructor (&nbsp;<b><font SIZE="2" FACE="Arial">new</font></b>&nbsp;[]&nbsp;)
to construct a new array of strings (&nbsp;<font SIZE="2" FACE="Arial">String[]</font>&nbsp;)
and causes <i><font SIZE="2" FACE="Arial">theOptions</font></i>
private array attribute to reference it. The number of <font SIZE="2" FACE="Arial">String</font>s
is determined by the argument to the constructor and uses the
<font SIZE="2" FACE="Arial">length</font> attribute of the <i><font SIZE="2" FACE="Arial">options</font></i><font SIZE="2" FACE="Arial">[]</font>
argument array. The effect is that <i><font SIZE="2" FACE="Arial">theOptions</font></i><font SIZE="2" FACE="Arial">[]</font>
array is now ready to contain as many <font SIZE="2" FACE="Arial">String</font>s
as there are <font SIZE="2" FACE="Arial">String</font>s in options[],
but does not yet contain them.<br>

<p>
Each <font SIZE="2" FACE="Arial">String</font> in <i><font SIZE="2" FACE="Arial">theOptions</font></i><font SIZE="2" FACE="Arial">[]</font>
array is created in turn, on line 0035, using the <font SIZE="2" FACE="Arial">String</font>
constructor specifying as its argument the corresponding <font SIZE="2" FACE="Arial">String</font>
from <i><font SIZE="2" FACE="Arial">options</font></i>[], using
<i><font SIZE="2" FACE="Arial">thisOption</font></i> as the array
index. This is accomplished by enclosing line 0035 within a <b><font SIZE="2" FACE="Arial">for</font></b>
loop structure, whose general form is as follows. <br>

<pre>
       <b>for</b>( Initial Actions;
            Termination Condition;
            Loop End Actions     ){ 
         // Loop Body.
       } // End for loop.<br>

</pre>

<p>
The behaviour of this structure is first to execute the <i>Initial&nbsp;Actions</i>
and to immediately evaluate the <i>Termination Condition</i>.
If the <i>Termination Condition</i> evaluates <b><font SIZE="2" FACE="Arial">false</font></b>
at this stage the loop structure will terminate without the body
of the loop being performed even once. Otherwise the <i>Loop&nbsp;Body</i>
actions will be executed, following which the <i>Loop&nbsp;End&nbsp;Actions</i>
will be performed. At this stage the <i>Termination Condition</i>
is evaluated for a second time and will cause the loop structure
to terminate if it is now <b><font SIZE="2" FACE="Arial">false</font></b>.
If not, the pattern of executing the <i>Loop&nbsp;Body</i> and
the <i>Loop&nbsp;End&nbsp;Actions</i> before re-evaluating the
<i>Termination Condition</i> will continue until at some stage
the condition will (hopefully) evaluate <b><font SIZE="2" FACE="Arial">false</font></b>
and terminate the loop. <br>

<p>
This should become clearer if this part of the constructor is
traced using a menu consisting of three options, &quot;<i>First&nbsp;option</i>&quot;,
&quot;<i>Second&nbsp;option</i>&quot; and &quot;<i>Third&nbsp;option</i>&quot;.
The state of the program objects just before line 0031 is executed
can be visualised as shown in Figure 6.2.<br>

<p>
<center><img SRC="c6p4i2.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter6/c6p4i2.gif" WIDTH="688" HEIGHT="199"><br>
</center>
<p>
<center>Figure 6.2. <i>BasicMenu</i> constructor before array sizing.<br>
</center>
<p>
The diagram shows the <i>options</i> array of type <i>String</i>[]
at the left containing an array of three strings indexed by the
values 0, 1 and 2. In the middle is the local variable <i>thisOption</i>
of type <b>int</b> with its default value 0 and on the right is
<i>theOptions</i> of type <i>String</i>[] which does not yet reference
an array. <br>

<p>
The execution of line 0031 will cause Java to determine the number
of strings in the <i>options</i> array (&nbsp;<i><font SIZE="2" FACE="Arial">options</font></i><font SIZE="2" FACE="Arial">.length</font>&nbsp;)
and use this value to construct a new array of strings with the
same number of elements (&nbsp;<b><font SIZE="2" FACE="Arial">new</font></b><font SIZE="2" FACE="Arial">&nbsp;String[&nbsp;<i>options</i>.length]</font>&nbsp;)
and cause <i><font SIZE="2" FACE="Arial">theOptions</font></i> to
reference it. The situation is now as shown in Figure 6.3.<br>

<p>
<center><img SRC="c6p4i3.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter6/c6p4i3.gif" WIDTH="687" HEIGHT="192"></center>
<p>
<center>Figure 6.3. <i>BasicMenu</i> constructor after array sizing.<br>
</center>
<p>
The array <i><font SIZE="2" FACE="Arial">theOptions</font></i> is
now capable of storing three strings, but does not at this stage
actually contain any strings. The first action of the <b><font SIZE="2" FACE="Arial">for</font></b>
loop on line 0032 is to assign the value 0 to <i><font SIZE="2" FACE="Arial">thisOption</font></i>
and then test the termination condition, <i><font SIZE="2" FACE="Arial">thisOption</font></i><font SIZE="2" FACE="Arial">&nbsp;&lt;&nbsp;<i>options</i>.length</font>.
This is effectively 0&nbsp;&lt;&nbsp;3 which is <b><font SIZE="2" FACE="Arial">true</font></b>
and causes the body of the loop on line 0035 to be performed.
This line causes the <i><font SIZE="2" FACE="Arial">theOptions</font></i>
array element indexed by the value of <i><font SIZE="2" FACE="Arial">thisOption</font></i>
to refer to a newly created <font SIZE="2" FACE="Arial">String</font>
object with a value initialised from the <i><font SIZE="2" FACE="Arial">options</font></i>
array element indexed by the same value. Or, put more simply,
if a little less accurately, it copies the string from position
0 in the <i><font SIZE="2" FACE="Arial">options</font></i> array
to the same position in <i><font SIZE="2" FACE="Arial">theOptions</font></i>
array. As this is the end of the loop body the <i>Loop&nbsp;End&nbsp;Actions</i>
of the <b><font SIZE="2" FACE="Arial">for</font></b> structure,
on line 0034, are performed, incrementing the value of <i><font SIZE="2" FACE="Arial">thisOption</font></i>
to 1. The situation is now as shown in Figure 6.4.<br>

<p>
<center><img SRC="c6p4i4.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter6/c6p4i4.gif" WIDTH="687" HEIGHT="190"></center>
<p>
<center>Figure 6.4. <i>BasicMenu</i> constructor after first iteration of the loop.<br>
</center>
<p>
At this point the <i>Termination&nbsp;Condition</i> will be evaluated
for a second time, effectively 1&nbsp;&lt;&nbsp;3 which is still
<b><font SIZE="2" FACE="Arial">true</font></b>. The loop body will
iterate for a second time making a copy of the string indexed
by 1 in <i><font SIZE="2" FACE="Arial">theOptions</font></i> array
and incrementing the value of <i><font SIZE="2" FACE="Arial">thisOption</font></i>
to 2. The condition will still evaluate <b><font SIZE="2" FACE="Arial">true</font></b>
causing a third iteration copying the string at index position
2 before incrementing <i><font SIZE="2" FACE="Arial">thisOption</font></i>
to 3. The situation at this stage is shown in Figure 6.5.<br>

<p>
<center><img SRC="c6p4i5.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter6/c6p4i5.gif" WIDTH="688" HEIGHT="188"></center>
<p>
<center>Figure 6.5. <i>BasicMenu</i> constructor after third iteration of the loop.<br>
</center>
<p>
At this stage the <i>Termination&nbsp;Condition</i> will be, effectively,
3&lt;3 which is <b><font SIZE="2" FACE="Arial">false</font></b>
and the loop will terminate. <br>

<p>
The remaining parts of the constructor are concerned with initialising
<i><font SIZE="2" FACE="Arial">theTitle</font></i> and <i><font SIZE="2" FACE="Arial">thePrompt</font></i>
data attributes from their corresponding arguments. <i><font SIZE="2" FACE="Arial">TheTitle</font></i>
is declared on line 0011 with no default value and <i><font SIZE="2" FACE="Arial">thePrompt</font></i>
on line 0012 with the default value &quot;Please enter your choice
:&quot;. The call to the constructor need not specify a <i><font SIZE="2" FACE="Arial">Title</font></i>
argument in which case no <i><font SIZE="2" FACE="Arial">theTitle</font></i>
string is constructed on lines 0027 to 0029; and, as will be shown,
no title will be displayed before the menu is shown. Likewise
the constructor need not be provided with a <i><font SIZE="2" FACE="Arial">Prompt</font></i>
argument, in which case the default prompt is not changed on lines
0038 to 0040.<br>

<p>
Before finishing the consideration of the <i><font SIZE="2" FACE="Arial">BasicMenu</font></i>
constructor one potential insecurity ought to be noted. If the
call of the constructor does not specify any strings in the <i><font SIZE="2" FACE="Arial">options[]</font></i>
argument, or even if it specifies only a single string, this implementation
will not notice and will present a menu with no choices or a single
choice. This insecurity will be addressed in an end of chapter
exercise. <br>
<br>


<p>
<hr>
<h2>
<ul>
<a HREF="chap6p5.html" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter6/chap6p5.html"><img SRC="..\next.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/next.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="50" HEIGHT="40">
6.5 The <i>BasicMenu</i> <i>showMenu</i>() action, and its supporting actions</a>.
<p>
<a HREF="chap6p3.html" tppabs="http://www.scism.sbu.ac.uk/jfl/Chapter6/chap6p3.html"><img SRC="..\last.gif" tppabs="http://www.scism.sbu.ac.uk/jfl/last.gif" ALIGN="MIDDLE" BORDER="0" WIDTH="50" HEIGHT="40">
6.3 The <i>BasicMenu</i> data attributes</a>.
</ul>
</h2>
<hr>
</body>

</html>
&#26;