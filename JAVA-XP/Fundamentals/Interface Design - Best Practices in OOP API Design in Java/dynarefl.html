<HTML>
<HEAD>
<TITLE>Prefer dynamic extension over reflection</TITLE>
<META name="description" content="An object-oriented design idiom from Interface Design: Best Practices in Object-Oriented API Design in Java by Bill Venners.">
<META name="keywords" content="Java Design, Java Book, Object Oriented Design, Thread Safe Design">
<LINK rel="stylesheet" type="text/css" href="http://www.artima.com/artima.css">
</HEAD>
<BODY text="#000000" alink="#006666">
<TABLE width="100%" cellspacing="0">
<TR>
<TD align="left" valign="bottom">
<A href="http://www.artima.com/index.jsp"><IMG src="..\images\ac.gif" alt="artima.com" border="0" width="150" height="31"></A>
</TD>
<TD align="right">
<a href="http://www.artima.com/cgi-bin/redirect.cgi/5c2c3c20?REGION=Cyan&CAMPAIGN=Default&ACCOUNT=Artima&BANNER=ArtimaTraining" ><img src="..\cgi-bin\getimage.cgi\5c2c3c20\region=cyan&campaign=default&account=artima&banner" border=0 width=468 height=60 alt="ad" ></a>
</TD>
</TR>
</TABLE>
<TABLE width="100%" bgcolor="#006666">
<TR>
<TD align="center">
<DIV class="ml">
<A href="http://www.artima.com/search.html" class="hl">Search</A>&nbsp;|
<A href="http://www.artima.com/java/index.html" class="hl">Java</A>&nbsp;|
<A href="http://www.artima.com/javadesign/index.html" class="hl">Design</A>&nbsp;|
<A href="http://www.artima.com/jvm/index.html" class="hl">JVM</A>&nbsp;|
<A href="http://www.artima.com/jini/index.html" class="hl">Jini</A>&nbsp;|
<A href="http://www.artima.com/forums/index.jsp" class="hl">Forums</A>&nbsp;|
<A href="http://www.artima.com/javaseminars/index.html" class="hl">Seminars</A>&nbsp;|
<A href="http://lists.artima.com/mailman/listinfo/artima-newsletter/" class="hl">Subscribe</A>
</DIV>
</TD>
</TR>
</TABLE>
<BR>
<DIV class="vegies">
<DIV class="tc">
<SPAN class="sts">Interface Design by Bill Venners</SPAN><BR>
<SPAN class="ts">Prefer dynamic extension over reflection</SPAN><BR>
</DIV>

<!--BEGIN_PRECISE_OBJECT_LINKS-->
<CENTER>
<FONT size="1" face="geneva, arial, sans-serif">
<STRONG>
<A href="index.html">Interface&nbsp;Design</A>&nbsp;|
<A href="contents.html">Contents</A>&nbsp;|
<A href="preferpoly.html">Previous</A>&nbsp;|
<A href="enlisthelp.html">Next</A>
</STRONG>
</FONT>
</CENTER>
<!--END_PRECISE_OBJECT_LINKS-->

<H2>What's Wrong with Reflection?</H2>
<UL>
<LI>
Reflection useful for: bean builders, object inspectors, object serialization,
automated testers
<LI>
Use reflection when you don't know what's coming, and you want to do
something <EM>to</EM> objects
<LI>
Programming with types is more efficient than reflection, exceptions.
<LI>
Can find more errors sooner, because compiler does type checking.
<LI>
Encourages meaning-rich code: a type name implies an interface, a set
of services, and a semantic contract.
<LI>
Types form a vocabulary with which team members talk about the program --
they are the units of communication
</UL>

<HR align="left" width="100%" size="4" noshade>
<H2>Reflection: Method Name in HTML Post</H2>
<UL>
<LI>
I think it's a way of gaining flexibility and not losing it,
if you design your application to be able to handle
any Java object that can be thrown at it :) Always having to know
the type of things that are coming at you is a woeful left-over
from strong-typing fanatics.
<LI>
I've used code such as:<BR>
<BR>
this.getClass().getMethod(methodName, null).invoke(this, null);<BR>
<BR>
in a servlet where 'methodName' is a CGI parameter. I agree that
runtime info should be avoided if possible, but I think that in
this case it is justified. What does anyone else think?
</UL>

<P>
I.e., don't design an API that takes a method name, design APIs that
take type names.

<P>
Performance hit from reflection doesn't matter here because the network
latency is much bigger. But I would have gone for an interface or class
name that has a method in it that has defined semantics.

<P>
Use <CODE>ResourceBundle</CODE>s as an example.

<P>
Can talk a bit about weak typing. weak typing may actually make programmers more productive
without much cost in runtime robustness (word of mouth stories about Python). Java needs strong
tpying because the design center of Java's architecture is network mobility of code and objects.
A big part of that is security, and the cornerstone of Java's security model is type safety.
Since Java is a strongly typed language, should use it that way (except probably for enums).
Of course, the argument against enums (the fake it way that is in Bruce's book) is a combination
of the weak typing over strong typing argument (you get a runtime error instead of a compile
time error) plus tradition (in most Java APIs enums are just
defined constants), of course blindly following tradition is well discussed in the Lottery.
The language does guide one in how you design with it.

<P>
What you end up with in an API design is no real objects, just blueprints. Like an architect
designs a house but in the end there's no real house, just the blueprints. Or a machine designer
designs a machine and in the end there's no real machine, just the plan for that machine.
In an object-oriented API, those blueprints take the form of types (in Java, classes and interfaces), each of
which communicates some semantics to humans that use the types. That's what object-oriented API design
is, designing types that marry syntax of how you request services with semantics that describe the
full range of possible behavior when you request that service.

<P>
My suspicion about weak typing is this. 99.9% of the time the programmer probably does get the
semantics guessed right. (Remember monomorphic, bimorphic, and polymorphic empirical percentages?)
Plus how often do two identical method signatures with different semantics actually happen in
practice?
The other thing is that the semantic contract of a method in a type is only fulfilled to the
extent that there aren't bugs (could come not just from accidents, but misunderstandings of
the semantic contract fence among clients and service providers -- its real challenging to
get those understandings compatible) Thus, the small percentage of times when a programmer may
guess the semantics wrong in a weakly typed language may be less than the times there's a bug
in the provider's implementation of the contract, so the programmers productivity may be
more enhanced by the ability to not have to declare variables with known types.

</TD>
</TR>

</DIV>
<HR width="100%">
<TABLE width="100%">
<TR>
<TD align="left">
<DIV class="sp">
Last Updated: Sunday, March 3, 2002<BR>
<A href="http://www.artima.com/copyright.html">Copyright</A> &copy; 1996-2002 Artima Software, Inc. All Rights Reserved.
</DIV>
</TD>
<TD align="right">
<DIV class="sp">
URL: http://www.artima.com/interfacedesign/DynaRefl.html<BR>
Artima.com is created by <A href="http://www.artima.com/consulting.html">Bill Venners</A>
</DIV>
</TD>
</TR>
</TABLE>
</BODY>
</HTML>
