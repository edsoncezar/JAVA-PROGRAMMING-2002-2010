<HTML>
<HEAD>
<TITLE>Use messengers to transmit information</TITLE>
<META name="description" content="An object-oriented design idiom from Interface Design: Best Practices in Object Oriented API Design in Java by Bill Venners.">
<META name="keywords" content="Java Design, Java Book, Object Oriented Design, Thread Safe Design">
<LINK rel="stylesheet" type="text/css" href="http://www.artima.com/artima.css">
</HEAD>
<BODY text="#000000" alink="#006666">
<TABLE width="100%" cellspacing="0">
<TR>
<TD align="left" valign="bottom">
<A href="http://www.artima.com/index.jsp"><IMG src="..\images\ac.gif" alt="artima.com" border="0" width="150" height="31"></A>
</TD>
<TD align="right">
<a href="http://www.artima.com/cgi-bin/redirect.cgi/16ea29ea?REGION=Cyan&CAMPAIGN=Default&ACCOUNT=Artima&BANNER=ArtimaTraining" ><img src="..\cgi-bin\getimage.cgi\16ea29ea\region=cyan&campaign=default&account=artima&banner" border=0 width=468 height=60 alt="ad" ></a>
</TD>
</TR>
</TABLE>
<TABLE width="100%" bgcolor="#006666">
<TR>
<TD align="center">
<DIV class="ml">
<A href="http://www.artima.com/search.html" class="hl">Search</A>&nbsp;|
<A href="http://www.artima.com/java/index.html" class="hl">Java</A>&nbsp;|
<A href="http://www.artima.com/javadesign/index.html" class="hl">Design</A>&nbsp;|
<A href="http://www.artima.com/jvm/index.html" class="hl">JVM</A>&nbsp;|
<A href="http://www.artima.com/jini/index.html" class="hl">Jini</A>&nbsp;|
<A href="http://www.artima.com/forums/index.jsp" class="hl">Forums</A>&nbsp;|
<A href="http://www.artima.com/javaseminars/index.html" class="hl">Seminars</A>&nbsp;|
<A href="http://lists.artima.com/mailman/listinfo/artima-newsletter/" class="hl">Subscribe</A>
</DIV>
</TD>
</TR>
</TABLE>
<BR>
<DIV class="vegies">
<DIV class="tc">
<SPAN class="sts">Guideline 4</SPAN><BR>
<SPAN class="sts">Interface Design by Bill Venners</SPAN><BR>
<SPAN class="ts">Use Messengers to transmit information</SPAN><BR>
</DIV>

<!--BEGIN_PRECISE_OBJECT_LINKS-->
<CENTER>
<FONT size="1" face="geneva, arial, sans-serif">
<STRONG>
<A href="index.html">Interface&nbsp;Design</A>&nbsp;|
<A href="contents.html">Contents</A>&nbsp;|
<A href="statepattern.html">Previous</A>&nbsp;|
<A href="flyweights.html">Next</A>
</STRONG>
</FONT>
</CENTER>
<!--END_PRECISE_OBJECT_LINKS-->

<P>
<A href="bundleservices.html">Guideline 2</A> encourages you to think of objects of bundles
of services, not bundles of data.
This guideline irreverently suggests that sometimes its OK
to design objects that are bundles of data.

<P>
On occasion, you will see objects that are nothing more than containers for data. I like to call
such objects <EM>Messengers</em>. A messenger allows you to package and send bundles of
data. Often the data is passed to the messenger's constructor, and the messenger is
sent along its way. Recipients of the messenger
access the data via get methods. Messengers are usually short-lived objects. Once
a recipient retrieves the information contained in a messenger, it usually kills the
messenger (even if the news is good).

<P>
In general, you should move code to data as described in <A href="bundleservices.html">Guideline 1</A>.
Most of your object designs should be service-oriented objects, as described
in <A href="serviceoriented.html">Guideline 2</A>.
But on occasion, you may find yourself with some data that you don't know what to do with.
Sometimes you know some information, but you don't know what behavior that
information implies. You can't move the code to the data, because even though you
have the data, you don't know what the code should do. In such cases, you can encapsulate the
data inside a messenger object, and send the messenger to some recipient that does know the
behavior implied by the data.
The recipient extracts the data from the messenger and takes
appropriate action.

<P>
One common example of messengers is exceptions. As mentioned in
Guideline ?, exception objects are usually composed of little more a small
amount of data (if any), which is passed to the constructor, and some access methods
to let catch clauses get at that data. The primary information in an exception
is carried in the name of the exception itself.

<PRE>
 1 package com.artima.examples.account.ex1;
 2
 3 <EM>/**
 4 * Exception thrown by &lt;code&gt;Account&lt;/code&gt;s to indicate that
 5 * a requested withdrawal has failed because of insufficient funds.
 6 */</EM>
 7 public class InsufficientFundsException
 8     extends Exception {
 9
10     <EM>/**
11     * Minimum additional balance required for the requested
12     * withdrawal to succeed.
13     */</EM>
14     private long shortfall;
15
16     <EM>/**
17     * Constructs an &lt;code&gt;InsufficientFundsException&lt;/code&gt; with
18     * the passed shortfall and no specified detail message.
19     *
20     * @param shortfall the amount in excess of available funds
21     *    that caused a withdrawal request to fail.
22     */</EM>
23     public InsufficientFundsException(long shortfall) {
24         this.shortfall = shortfall;
25     }
26
27     <EM>/**
28     * Constructs an &lt;code&gt;InsufficientFundsException&lt;/code&gt; with
29     * the passed detail message and shortfall.
30     *
31     * @param message the detail message
32     * @param shortfall the amount in excess of available funds
33     *    that caused a withdrawal request to fail.
34     */</EM>
35     public InsufficientFundsException(String message, long shortfall) {
36         super(message);
37         this.shortfall = shortfall;
38     }
39
40     <EM>/**
41     * Returns the shortfall that caused a withrawal request
42     * to fail. The shortfall is the minimum additional balance
43     * required for the requested withdrawal to succeed.
44     *
45     * @returns shortfall the amount in excess of available funds
46     *    that caused a withdrawal request to fail.
47     */</EM>
48     public long getShortfall() {
49         return shortfall;
50     }
51 }
52
53
</PRE>

<P>
Another example of the Messenger are events. Like exceptions, event
objects often just encapsulate some data, which is passed to the constructor,
and offers access methods to let listeners get at the data. For examples
of this see the Event Generator idiom.

<P>
Like exceptions and events, multivalued return objects are Messengers. It
has some data, which must be passed to the constructor, and offers access
methods so the calling method can get at the returned data.


<P>
Messengers are usually immutable (but not always: AWT event can be consumed)

<P>
In parting, I want to warn you to be suspicious of messengers when they appear in your designs. Challenge
their existence. A messenger makes sense when you don't know the behavior that should result
accompany some data. If you do know the behavior, then you know the code that should use that
data. In this case, you should refactor. You should move the code to the data, which will
transform the messenger into a service-oriented object. This is, in fact, the very process demonstrated
in <A href="bundleservices.html">Guideline 2</A>: The <CODE>Matrix</CODE> of Listing 2-1 was
a messenger, which was transformed into a service-oriented <CODE>Matrix</CODE> in Listing 2-3.
To get from Listing 2-1 to Listing 2-3, I moved the code for matrix addition, subtraction,
multiplication, conversion to string, etc., to the
<CODE>Matrix</CODE> class that contained the matrix data.

<P>
Probably mention the attribute classes in the Service UI API, and talk about EJB Blueprints "value" objects.
Or perhaps value objects belong in Immutable.

</TD>
</TR>

</DIV>
<HR width="100%">
<TABLE width="100%">
<TR>
<TD align="left">
<DIV class="sp">
Last Updated: Sunday, March 3, 2002<BR>
<A href="http://www.artima.com/copyright.html">Copyright</A> &copy; 1996-2002 Artima Software, Inc. All Rights Reserved.
</DIV>
</TD>
<TD align="right">
<DIV class="sp">
URL: http://www.artima.com/interfacedesign/Messenger.html<BR>
Artima.com is created by <A href="http://www.artima.com/consulting.html">Bill Venners</A>
</DIV>
</TD>
</TR>
</TABLE>
</BODY>
</HTML>
