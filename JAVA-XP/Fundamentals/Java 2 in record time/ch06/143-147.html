<HTML>
<HEAD>

<TITLE>Java 1.2 In Record Time:Adding Scroll Bars</TITLE>




<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="139-143.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="147-152.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>Now you will continue constructing your horizontal scroll bar, <TT>scroll1</TT>, by passing these parameters to its constructor (see Table 6.1): its orientation (you use the pre-defined <TT>Scrollbar</TT> class constants <TT>Scrollbar.HORIZONTAL</TT> or <TT>Scrollbar VERTICAL</TT>&#151;these constants are built into the <TT>Scrollbar</TT> class), the scroll bar&#146;s initial value (i.e., the location of the scroll box in the scroll bar&#151;called the <I>thumb</I>), the size of the scroll thumb in pixels, and the scroll bar&#146;s minimum possible value (use 1) and its maximum possible value (use 100):</P>
<PRE>
  import java.applet.Applet;
  import java.awt.event.*;
  import java.awt.*;

  public class scroller extends Applet &#123;

      TextField text1;
      Scrollbar scroll1, scroll2;

      public void init()&#123;
           text1 = new TextField(20);
           add(text1);

&#8594;          scroll1 = new Scrollbar(Scrollbar.HORIZONTAL, 1, 10, 1, 100);
&#8594;          add(scroll1);
                .
                .
                .
      &#125;
  &#125;
</PRE>
<BLOCKQUOTE>
<P><FONT SIZE="-1"><HR><B>TIP:&nbsp;&nbsp;</B>Using the <TT>setValues()</TT> method, you can change a scroll bar&#146;s maximum and minimum possible values while your applet is running. You can also scroll the scroll bar from code with the <TT>setValue()</TT> method. (It&#146;s a common error to confuse <TT>setValue()</TT> with <TT>setValues()</TT>, but note that these are two different methods.)<HR></FONT>
</BLOCKQUOTE>
<P>Using this code, you will create a new horizontal scroll bar whose values can range from 1 to 100, and whose initial value is 1.
</P>
<P>In the same way, you can create a similar scroll bar, <TT>scroll2</TT>, which has the same value range but is vertical:</P>
<PRE>
  import java.applet.Applet;
  import java.awt.event.*;
  import java.awt.*;

  public class scroller extends Applet &#123;

      TextField text1;
      Scrollbar scroll1, scroll2;
      public void init()&#123;
           text1 = new TextField(20);
           add(text1);
           scroll1 = new Scrollbar(Scrollbar.HORIZONTAL, 1, 10, 1, 100);
           add(scroll1);

&#8594;          scroll2 = new Scrollbar(Scrollbar.VERTICAL, 1, 10, 1, 100);
&#8594;          add(scroll2);
      &#125;
  &#125;
</PRE>
<P>That&#146;s it&#151;your scroll bars will now appear in your applet now.
</P>
<H4 ALIGN="LEFT"><A NAME="Heading4"></A><FONT COLOR="#000077">Connecting Scroll Bars to Code</FONT></H4>
<P>The next step is to connect them to code, and you might think that&#146;s done with an ActionListener or ItemListener interface&#151;but in fact, the <I>AdjustmentListener</I> interface is used this time, because scroll bars are considered <I>adjustable</I> controls. Use the <TT>addAdjustmentListener()</TT> method of the <TT>Scrollbar</TT> class like you used the <TT>addItemListener()</TT> and <TT>addActionListener()</TT>.</P>
<PRE>
  import java.applet.Applet;
  import java.awt.event.*;
  import java.awt.*;

&#8594;public class scroller extends Applet implements AdjustmentListener &#123;

      TextField text1;
      Scrollbar scroll1, scroll2;

      public void init()&#123;
           text1 = new TextField(20);
           add(text1);
           scroll1 = new Scrollbar(Scrollbar.HORIZONTAL, 1, 10, 1, 100);
           add(scroll1);
&#8594;          scroll1.addAdjustmentListener(this);
           scroll2 = new Scrollbar(Scrollbar.VERTICAL, 1, 10, 1, 100);
           add(scroll2);
&#8594;          scroll2.addAdjustmentListener(this);
      &#125;
  &#125;
</PRE>
<P>You can determine which scroll bar caused the event by overriding the <TT>adjustmentValueChanged()</TT> method. That method takes a parameter of class <TT>AdjustmentEvent</TT>:</P>
<PRE>
  import java.applet.Applet;
  import java.awt.event.*;
  import java.awt.*;

  public class scroller extends Applet implements AdjustmentListener &#123;

      TextField text1;
      Scrollbar scroll1, scroll2;

      public void init()&#123;
           text1 = new TextField(20);
           add(text1);
           scroll1 = new Scrollbar(Scrollbar.HORIZONTAL, 1, 10, 1, 100);
           add(scroll1);
           scroll1.addAdjustmentListener(this);
           scroll2 = new Scrollbar(Scrollbar.VERTICAL, 1, 10, 1, 100);
           add(scroll2);
           scroll2.addAdjustmentListener(this);
      &#125;

&#8594;     public void adjustmentValueChanged(AdjustmentEvent e)&#123;
                     .
                     .
                     .
      &#125;
  &#125;
</PRE>
<P>You can determine which scroll bar caused the event with the <TT>AdjustableEvent</TT> class&#146;s <TT>getAdjustable()</TT> method the following way, where you check to see if <TT>scroll1</TT> caused the scroll event:</P>
<PRE>
  import java.applet.Applet;
  import java.awt.event.*;
  import java.awt.*;

  public class scroller extends Applet implements AdjustmentListener &#123;

      TextField text1;
      Scrollbar scroll1, scroll2;

      public void init()&#123;
           text1 = new TextField(20);
           add(text1);
           scroll1 = new Scrollbar(Scrollbar.HORIZONTAL, 1, 10, 1, 100);
           add(scroll1);
           scroll1.addAdjustmentListener(this);
           scroll2 = new Scrollbar(Scrollbar.VERTICAL, 1, 10, 1, 100);
           add(scroll2);
           scroll2.addAdjustmentListener(this);
      &#125;

      public void adjustmentValueChanged(AdjustmentEvent e)&#123;
&#8594;          if(e.getAdjustable() == scroll1) &#123;
                .
                .
                .
&#8594;          &#125;
      &#125;
  &#125;
</PRE>
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="139-143.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="147-152.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>





</BODY>
</HTML>

