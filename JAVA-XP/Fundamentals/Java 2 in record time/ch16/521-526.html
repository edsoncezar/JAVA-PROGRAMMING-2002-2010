<HTML>
<HEAD>

<TITLE>Java 1.2 In Record Time:Working with Multi-Threaded Programs and JAR Files</TITLE>




<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="517-521.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="..\ewtoc.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>As it turns out, Java lets you enclose the sensitive part of your code in a synchronized block. You can indicate what data you consider sensitive in parentheses following the <TT>synchronized</TT> keyword. Here, that&#146;s the <TT>sensitiveData</TT> object, so you can set up your synchronized code block this way in the applet:</P>
<PRE>
     public void run() &#123;
          String out_string;
          int loop_index;
          out_string = new String();
&#8594;          synchronized(sensitiveData)&#123;
               for(loop_index = 1; loop_index &lt; 500;
               loop_index&#43;&#43;)&#123;
                    sensitiveData.internal_data&#43;&#43;;
                    System.out.println("data value = " &#43;
                    &#8658; out_string.valueOf(sensitiveData.internal_data));
               &#125;
&#8594;          &#125;
     &#125;
</PRE>
<P>Doing so has the same effect as setting up a synchronized function&#151;you restrict access to the sensitive data such that only one thread has access to it at a time. When you run this applet, you&#146;ll see the stream of integers scrolling up the screen, in order. The code for the latest version of this applet appears in <TT>synchronize.java,</TT> <TT>version 3</TT>.</P>
<P><B>synchronize.java, version 3</B></P>
<PRE>
import java.awt.*;
import java.applet.Applet;

public class synchronize extends Applet implements Runnable&#123;

     Thread Thread1, Thread2;
     dataClass sensitiveData;

     public void init() &#123;
          sensitiveData = new dataClass();
     &#125;

     public void start() &#123;
          Thread1 = new Thread(this);
          Thread1.start();
          Thread2 = new Thread(this);
          Thread2.start();
     &#125;

     public void run() &#123;
          String out_string;
          int loop_index;
          out_string = new String();
          synchronized(sensitiveData)&#123;
               for(loop_index = 1; loop_index &lt; 500;
               loop_index&#43;&#43;)&#123;
                    sensitiveData.internal_data&#43;&#43;;
                    System.out.println("data value = " &#43;
            &#8658; out_string.valueOf(sensitiveData.internal_data));
               &#125;
          &#125;
     &#125;
&#125;
class dataClass&#123;
     public int internal_data;
     public void dataClass()&#123;
          internal_data = 0;
     &#125;
&#125;
</PRE>
<P>That&#146;s it for synchronizing your threads and for an overview of multi-threaded programming in Java.
</P>
<H3><A NAME="Heading13"></A><FONT COLOR="#000077">Fast Downloading: JAR Files</FONT></H3>
<P>You&#146;ve created a lot of applets in this book, and applets are targeted for the World Wide Web. Java 1.2 includes Java Archive (JAR) files, a new way of speeding the downloading process. Before you finish the book, let&#146;s take a look at how to use them.
</P>
<P>You can use JAR files to zip and enclose a number of files so they are downloaded all at once in a small package, making the downloading process speedy. To create a JAR file, you use the <TT>jar.exe</TT> tool. For example, the <TT>canvaser.java</TT> applet creates two class files when compiled: <TT>canvaser.class</TT> and <TT>BoxCanvas.class</TT>. You can zip both of those and place them in one JAR file so they are downloaded together. To do that, use <TT>jar.exe</TT> to create <TT>canvaser.jar</TT> as follows:</P>
<PRE>
  C:\java1-1\canvaser&gt;jar cvf canvaser.jar *
</PRE>
<P>The * at the end means that you will compress all the files in the current directory into this JAR file, and the <TT>cvf</TT> string indicates the options you want to use with the <TT>jar.exe</TT>. These options are listed in Table 16.1.</P>
<TABLE WIDTH="100%"><CAPTION ALIGN=LEFT><B>Table 16.1:</B> Options available with <TT>jar.exe</TT>
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TH WIDTH="20%" ALIGN="LEFT">Option
<TH WIDTH="80%" ALIGN="LEFT">Does This
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD><TT>c</TT>
<TD>Creates a new or empty archive on the standard output
<TR>
<TD><TT>t</TT>
<TD>Lists the table of contents from standard output
<TR>
<TD VALIGN="TOP"><TT>x [file]</TT>
<TD>Extracts all files, or just the named files, from standard input. If <TT>file</TT> is omitted, all files are extracted; otherwise, only the specified file or files are extracted
<TR>
<TD VALIGN="TOP"><TT>f [jar-file]</TT>
<TD>The second argument specifies a JAR file to process. In the case of creation, this refers to the name of the JAR file to be created (instead of on stdout). For table or extract, the second argument identifies the JAR file to be listed or extracted
<TR>
<TD><TT>v</TT>
<TD>Generates verbose output on stderr
<TR>
<TD COLSPAN="2"><HR>
</TABLE>
<P>Now that you&#146;ve created a JAR file, you can upload it to your ISP&#151;this is the file users will download, not the applet&#146;s <TT>.class</TT> files. But how do you tell a Java 1.2 enabled Web browser to download and unpack this JAR file? That turns out to be easy: just add this <TT>&lt;param&gt;</TT> tag to the <TT>&lt;applet&gt;</TT> tag, naming this parameter <TT>archives</TT> and giving as its value your JAR file, <TT>canvaser.jar</TT>:</P>
<PRE>
 &lt;html&gt;

 &lt;!&#151; Web page written for the Sun Applet Viewer&gt;

 &lt;head&gt;
 &lt;title&gt;canvaser&lt;/title&gt;
 &lt;/head&gt;

 &lt;body&gt;
 &lt;hr&gt;

 &lt;applet code=canvaser.class
           width=200 height=200&gt;
&#8594;          &lt;param name=archives value="canvaser.jar"&gt;
 &lt;/applet&gt;

 &lt;hr&gt;
 &lt;/body&gt;
 &lt;/html&gt;
</PRE>
<P>And the Web browser will do the rest. You can run the applet now.
</P>
<P>In this book, you have seen many aspects of Java at work, including text fields and text areas, radio buttons and check boxes, a popup adding calculator, printing, the Java <TT>ScrollPane</TT> class, the system clipboard, popup menus, the Delegated event method, scroll bars and scrolling lists, clickable hyperlink-filled images, popup windows, menus, Card layouts, GridBag layouts, dialog boxes, buttons, panels, multi-threading, navigating to URLs, the mouse, a mouse-driven paint program, a mouse-driven image resizer, using the keyboard directly, fonts, animation, the Sun <TT>Animator</TT> class, JAR files, double buffered graphics animation, and Java applications. All that remains is putting all this power to work for yourself. Happy programming!</P>
<H3><A NAME="Heading14"></A><FONT COLOR="#000077">Are You up to Speed?</FONT></H3>
<P><FONT SIZE="+1"><B>Now you can. . .</B></FONT></P>
<DL>
<DD><B>&#149;</B>&nbsp;&nbsp;create Java <I>Thread</I> objects
<DD><B>&#149;</B>&nbsp;&nbsp;use Applet methods and multi-threading at the same time
<DD><B>&#149;</B>&nbsp;&nbsp;coordinate multiple threads using synchronization techniques
<DD><B>&#149;</B>&nbsp;&nbsp;distinguish which thread is executing in the <I>run()</I> method by naming threads
<DD><B>&#149;</B>&nbsp;&nbsp;prevent threads from accessing sensitive data
<DD><B>&#149;</B>&nbsp;&nbsp;use JAR files to compress multiple files for easier and faster downloading
</DL>
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="517-521.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="..\ewtoc.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>





</BODY>
</HTML>

