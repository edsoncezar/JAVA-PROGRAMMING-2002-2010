<HTML>
<HEAD>

<TITLE>Java 1.2 In Record Time:Working with Multi-Threaded Programs and JAR Files</TITLE>




<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="..\ch15\488-491.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="497-501.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<H2><A NAME="Heading1"></A><FONT COLOR="#000077">Skill 16<BR>Working with Multi-Threaded Programs and JAR Files
</FONT></H2>
<DL>
<DD><B>&#149;</B>&nbsp;&nbsp;Understanding the Runnable Interface
<DD><B>&#149;</B>&nbsp;&nbsp;Synchronizing threads
<DD><B>&#149;</B>&nbsp;&nbsp;Protecting data when working with multiple threads
<DD><B>&#149;</B>&nbsp;&nbsp;Creating and using JAR files
</DL>
<P><BIG><BIG>I</BIG></BIG>n this skill, we&#146;re going to explore an aspect of Java that we touched on in Skills 14 and 15&#151;multi-threading. Animation gave you a good introduction to this topic; you learned that the way animation works in Java is to have a thread (that is, an independent stream of execution) endlessly place animation frames in an applet while the applet&#146;s main thread is able to do other work.</P>
<P>In this skill, we&#146;ll see how to set the priority of the different threads in an applet, how to coordinate threads at work, and how to use multiple threads. Let&#146;s start by working through the process of creating a threaded applet.</P>
<H3><A NAME="Heading2"></A><FONT COLOR="#000077">Creating Thread Objects</FONT></H3>
<P>To begin exploring threads, you&#146;ll create an applet with a thread object that repeatedly prints the message &#147;Hello from Java&#148; on the screen. You&#146;ll give your applet two buttons, one to start the thread printing its message, and one to stop it, as shown in Figure 16.1.
</P>
<P><A NAME="Fig1"></A><A HREF="images\16-01.jpg"><IMG SRC="images\16-01t.jpg"></A>
<BR><A HREF="images\16-01.jpg"><FONT COLOR="#000077"><B>FIGURE 16.1:</B></FONT></A>&nbsp;&nbsp;Your applet&#146;s two buttons</P>
<P>Create a new file named <TT>threads.java</TT> now. Then start with the usual code, and implement the ActionListener interface for the buttons you&#146;ll use:</P>
<PRE>
  import java.applet.Applet;
  import java.awt.*;
  import java.awt.event.*;

&#8594;public class threads extends Applet implements ActionListener &#123;
                .
                .
                .
&#125;
</PRE>
<P>Next, add the Start Thread button and the Stop Thread button. Connect them up to your code by installing ActionListeners in each button object:
</P>
<PRE>
  import java.applet.Applet;
  import java.awt.*;
  import java.awt.event.*;

public class threads extends Applet implements ActionListener &#123;

&#8594;    Button button1, button2;

&#8594;    public void init()&#123;
&#8594;         button1 = new Button("Start thread");
&#8594;         add(button1);
&#8594;         button1.addActionListener(this);
&#8594;         button2 = new Button("Stop thread");
&#8594;         add(button2);
&#8594;         button2.addActionListener(this);
                   .
                   .
                   .
&#125;
</PRE>
<P>Now you&#146;re ready to add your new thread to your applet.
</P>
<H4 ALIGN="LEFT"><A NAME="Heading3"></A><FONT COLOR="#000077">Using the Java Thread Class</FONT></H4>
<P>Threads in Java are supported by the <TT>Thread</TT> class; add a new thread that you&#146;ll name <TT>printingThread</TT>. You will create the <TT>printingThread</TT> class soon.</P>
<BLOCKQUOTE>
<P><FONT SIZE="-1"><HR><B>NOTE:&nbsp;&nbsp;</B>It is intentional that you aren&#146;t implementing the Runnable interface in this example; you will make use of the Runnable interface in the next example.<HR></FONT>
</BLOCKQUOTE>
<PRE>
  import java.applet.Applet;
  import java.awt.*;
  import java.awt.event.*;

  public class threads extends Applet implements ActionListener &#123;
     Button button1, button2;
&#8594;    printingThread Thread1;

     public void init()&#123;
          button1 = new Button("Start thread");
          add(button1);
          button1.addActionListener(this);
          button2 = new Button("Stop thread");
          add(button2);
          button2.addActionListener(this);
&#8594;         Thread1 = new printingThread();
     &#125;         .
               .
               .
</PRE>
<P>To start this new thread, use the <TT>Thread</TT> class&#146;s <TT>start()</TT> method, and to stop it, use a flag as you have in the last two skills. This way you connect those methods up to your buttons in the <TT>actionPerformed()</TT> method:</P>
<PRE>
  import java.applet.Applet;
  import java.awt.*;
  import java.awt.event.*;

  public class threads extends Applet implements ActionListener &#123;

       Button button1, button2;
       printingThread Thread1;

       public void init()&#123;
            button1 = new Button("Start thread");
            add(button1);
            button1.addActionListener(this);
            button2 = new Button("Stop thread");
            add(button2);
            button2.addActionListener(this);
            Thread1 = new printingThread();
       &#125;

&#8594;public void actionPerformed(ActionEvent e)&#123;
&#8594;     if(e.getSource() == button1)&#123;
&#8594;          Thread1.start();
&#8594;     &#125;
&#8594;     if(e.getSource() == button2)&#123;
&#8594;          Thread1.animateFlag = false;
&#8594;     &#125;
     &#125;
&#125;
</PRE>
<BLOCKQUOTE>
<P><FONT SIZE="-1"><HR><B>NOTE:&nbsp;&nbsp;</B>Note this time the reference to the thread&#146;s animation flag as <TT>Thread1.animateFlag</TT>, not just <TT>animateFlag</TT>. We did that because the thread checks that flag in its <TT>run()</TT> method&#151;and that method will be part of the <TT>printingThread</TT> class, not the main applet class. To make sure <TT>run()</TT> has access to the <TT>animateFlag</TT> variable, then, you will make that variable a member of the <TT>printingThread</TT> class, and so refer to it as <TT>Thread1.animateFlag</TT>.<HR></FONT>
</BLOCKQUOTE>
<P>Now you can create the <TT>printing</TT> <TT>Thread</TT> class. This class extends the Java <TT>Thread</TT> class as follows:</P>
<PRE>
  public class threads extends Applet implements ActionListener &#123;

       Button button1, button2;
       printingThread Thread1;

       public void init()&#123;
            button1 = new Button("Start thread");
            add(button1);
            button1.addActionListener(this);
            button2 = new Button("Stop thread");
            add(button2);
            button2.addActionListener(this);
            Thread1 = new printingThread();
       &#125;    .
                 .
                 .
  &#125;

&#8594;class printingThread extends Thread &#123;
                 .
                 .
                 .
&#8594;&#125;
</PRE>
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="..\ch15\488-491.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="497-501.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>





</BODY>
</HTML>

