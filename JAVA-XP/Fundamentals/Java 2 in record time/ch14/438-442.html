<HTML>
<HEAD>

<TITLE>Java 1.2 In Record Time:Understanding Graphics Animation</TITLE>




<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="435-438.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="442-446.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>Now add the <TT>start()</TT> method:</P>
<PRE>
 import java.awt.*;
 import java.applet.Applet;
 public class spinner extends Applet implements Runnable&#123;

      Image spinImages[] = new Image[4];
      Thread spinThread;

      public void init() &#123;
           spinImages[0] = getImage(getCodeBase(), "spin1.gif");
           spinImages[1] = getImage(getCodeBase(), "spin2.gif");
           spinImages[2] = getImage(getCodeBase(), "spin3.gif");
           spinImages[3] = getImage(getCodeBase(), "spin4.gif");
      &#125;
&#8594;     public void start() &#123;
                .
                .
                .
&#8594;     &#125;
</PRE>
<P>Now create your new <TT>thread</TT> object as follows:</P>
<PRE>
 import java.awt.*;
 import java.applet.Applet;

 public class spinner extends Applet implements Runnable&#123;

      Image spinImages[] = new Image[4];
      Thread spinThread;

      public void init() &#123;
           spinImages[0] = getImage(getCodeBase(), "spin1.gif");
           spinImages[1] = getImage(getCodeBase(), "spin2.gif");
           spinImages[2] = getImage(getCodeBase(), "spin3.gif");
           spinImages[3] = getImage(getCodeBase(), "spin4.gif");
      &#125;

      public void start() &#123;
&#8594;          spinThread = new Thread(this);
                .
                .
                .
      &#125;
</PRE>
<P>Next, start that thread running with its <TT>start()</TT> method. That is, start executing the code in the <TT>run()</TT> method as follows:</P>
<PRE>
 import java.awt.*;
 import java.applet.Applet;

 public class spinner extends Applet implements Runnable&#123;

      Image spinImages[] = new Image[4];
      Thread spinThread;

      public void init() &#123;
           spinImages[0] = getImage(getCodeBase(), "spin1.gif");
           spinImages[1] = getImage(getCodeBase(), "spin2.gif");
           spinImages[2] = getImage(getCodeBase(), "spin3.gif");
           spinImages[3] = getImage(getCodeBase(), "spin4.gif");
      &#125;

      public void start() &#123;
           spinThread = new Thread(this);
&#8594;          spinThread.start();
      &#125;
</PRE>
<P>The <TT>start()</TT> method is ready to go, so now let&#146;s turn to the <TT>stop()</TT> method.</P>
<H4 ALIGN="LEFT"><A NAME="Heading6"></A><FONT COLOR="#000077">Handling the stop() Method</FONT></H4>
<P>You&#146;ve started your new thread, but you have to be able to stop it. You can do that in the <TT>stop()</TT> method, as follows:</P>
<PRE>
 public void start() &#123;
           spinThread = new Thread(this);
           spinThread.start();
      &#125;

&#8594;     public void stop() &#123;
           .
           .
           .
&#8594;     &#125;
</PRE>
<P>When the <TT>stop()</TT> method is called, you should stop your thread. You used to do that with the <TT>Thread</TT> class&#146;s <TT>stop()</TT> method, however, this method is now deprecated in Java 1.2, because Sun considers it unsafe.</P>
<P>Instead of using the <TT>Thread</TT> class&#146;s <TT>Stop()</TT> method, then, set a boolean flag named <TT>animateFlag</TT> to <TT>false</TT> when you should stop the thread:</P>
<PRE>
&#8594;boolean animateFlag = true;
 public void start() &#123;
           spinThread = new Thread(this);
           spinThread.start();
      &#125;
      public void stop() &#123;
&#8594;          animateFlag = false;
      &#125;
</PRE>
<P>And the <TT>stop()</TT> method is all set. Now we&#146;ll turn to the <TT>run()</TT> method, where the real work takes place, and you&#146;ll make use of your new flag, <TT>animateFlag</TT>.</P>
<H4 ALIGN="LEFT"><A NAME="Heading7"></A><FONT COLOR="#000077">Handling the run() Method</FONT></H4>
<P>Now the thread enters the <TT>run()</TT> method. Here, you&#146;ll set up a loop that runs until the <TT>stop()</TT> method is called, terminating the thread. You&#146;ll use a Java <TT>while</TT> loop here, which keeps executing while its conditional statement is true. That conditional statement will simply be your variable <TT>animateFlag</TT>, which is set to <TT>true</TT> until you should stop the animation:</P>
<PRE>
 public void start() &#123;
           spinThread = new Thread(this);
           spinThread.start();
      &#125;

      public void stop() &#123;
           spinThread.stop();
      &#125;

      public void run() &#123;
&#8594;          while(animateFlag)&#123;
                .
                .
                .
&#8594;          &#125;
      &#125;
</PRE>
<P>Here&#146;s where you&#146;ll perform your animation. To do so, simply keep flashing a new image on the screen continually. You&#146;ll set up an index named <TT>spinIndex</TT> that you can loop over; this will be your index into your array of images, <TT>spinImages[]</TT>. You&#146;ll also load the current image to display now in an <TT>Image</TT> object named <TT>nowImage</TT>:</P>
<PRE>
 import java.awt.*;
 import java.applet.Applet;

 public class spinner extends Applet implements Runnable&#123;

      Image spinImages[] = new Image[4];
&#8594;     Image nowImage;
&#8594;     int spinIndex = 0;
      Thread spinThread;
</PRE>
<P>You can keep loading a new image into <TT>nowImage</TT> each time the loop is executed this way, as follows:</P>
<PRE>
         public void run() &#123;
              while(animateFlag)&#123;
&#8594;               nowImage = spinImages[spinIndex&#43;&#43;];
                   if(spinIndex &gt; 3)spinIndex = 0;
                       .
                       .
                       .
             &#125;
        &#125;
</PRE>
<P>At this point, the image in <TT>nowImage</TT> is continually updated, and the next step is to display it on the screen. You can do that in the <TT>paint()</TT> method (where you&#146;ll find a <TT>Graphics</TT> object to draw with), so you can force a <TT>paint</TT> event now by calling <TT>repaint()</TT>:</P>
<PRE>
        public void run() &#123;
             while(animateFlag)&#123;
                  nowImage = spinImages[spinIndex&#43;&#43;];
                  if(spinIndex &gt; 3)spinIndex = 0;
&#8594;               repaint();
                      .
                      .
                      .
</PRE>
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="435-438.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="442-446.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>





</BODY>
</HTML>

