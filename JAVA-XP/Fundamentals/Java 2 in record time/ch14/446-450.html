<HTML>
<HEAD>

<TITLE>Java 1.2 In Record Time:Understanding Graphics Animation</TITLE>




<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="442-446.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="450-452.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>Here, you can skip the step of clearing the applet&#146;s display entirely and simply call the <TT>paint()</TT> method as follows:</P>
<PRE>
 import java.awt.*;
 import java.applet.Applet;

 public class spinner extends Applet implements Runnable&#123;

      Image spinImages[] = new Image[4];
      Image nowImage;
      int spinIndex = 0;
      Thread spinThread;

      public void init() &#123;
           spinImages[0] = getImage(getCodeBase(), "spin1.gif");
           spinImages[1] = getImage(getCodeBase(), "spin2.gif");
           spinImages[2] = getImage(getCodeBase(), "spin3.gif");
           spinImages[3] = getImage(getCodeBase(), "spin4.gif");
      &#125;         .
                     .
                     .
      public void run() &#123;
           while(animateFlag)&#123;
                nowImage = spinImages[spinIndex&#43;&#43;];
                if(spinIndex &gt; 3)spinIndex = 0;
                repaint();
                try &#123;Thread.sleep(200);&#125;
                catch(InterruptedException e) &#123; &#125;
           &#125;
      &#125;

      public void paint (Graphics g) &#123;
           if(nowImage != null) g.drawImage(nowImage, 10, 10, this);
      &#125;

      public void update(Graphics g) &#123;
&#8594;          paint(g);
      &#125;
 &#125;
</PRE>
<P>You&#146;ve done a lot of good&#151;now the applet isn&#146;t cleared between images. However, you can do more. The <TT>paint()</TT> method still paints the entire applet display each time it is called. It turns out you can restrict the drawing operations to just part of the applet&#146;s display, and in this case, that means you can restrict drawing to just the space in which your images appear. This saves time and reduces flicker.</P>
<H4 ALIGN="LEFT"><A NAME="Heading10"></A><FONT COLOR="#000077">Restricting Drawing to a Section of the Applet</FONT></H4>
<P>To restrict drawing operations to a specific region of the display, you can use the <TT>Graphics</TT> class&#146;s <TT>clipRect()</TT> method. Using this method means that drawing operations will only take place in the rectangle given; you can make that rectangle correspond to the location of your images this way:</P>
<PRE>
      public void update(Graphics g) &#123;
&#8594;          g.clipRect(10, 10, 100, 100);
           paint(g);
      &#125;
</PRE>
<P>Your new version of the spinner applet works just as the first one did, but without the screen flicker. The new version of spinner is a success. The code for this applet appears in <TT>spinner.java, version 2</TT> (Version 2 of the <TT>spinner.java</TT> file can be found in the <TT>spinner2</TT> directory where you installed the example source code.)</P>
<P><B>spinner.java, version 2</B></P>
<PRE>
 import java.awt.*;
 import java.applet.Applet;

 public class spinner extends Applet implements Runnable&#123;

      Image spinImages[] = new Image[4];
      Image nowImage;
      int spinIndex = 0;
      Thread spinThread;
      boolean animateFlag = true;

      public void init() &#123;
           spinImages[0] = getImage(getCodeBase(), "spin1.gif");
           spinImages[1] = getImage(getCodeBase(), "spin2.gif");
           spinImages[2] = getImage(getCodeBase(), "spin3.gif");
           spinImages[3] = getImage(getCodeBase(), "spin4.gif");
      &#125;

      public void start() &#123;
           spinThread = new Thread(this);
           spinThread.start();
      &#125;

      public void stop() &#123;
           animateFlag = false;
      &#125;

      public void run() &#123;
           while(animateFlag)&#123;
                nowImage = spinImages[spinIndex&#43;&#43;];
                if(spinIndex &gt; 3)spinIndex = 0;
                repaint();
                try &#123;Thread.sleep(200);&#125;
                catch(InterruptedException e) &#123; &#125;
           &#125;
      &#125;

      public void paint (Graphics g) &#123;
           if(nowImage != null) g.drawImage(nowImage, 10, 10, this);
      &#125;

      public void update(Graphics g) &#123;
           g.clipRect(10, 10, 100, 100);
           paint(g);
      &#125;
 &#125;
</PRE>
<P>So far, you&#146;ve seen several ways of creating graphics animation in Java. It turns out that Sun has created a class that it distributes as an example to support animation, so let&#146;s explore that now.
</P>
<H3><A NAME="Heading11"></A><FONT COLOR="#000077">The <I>Animator</I> Class
</FONT></H3>
<P>You can use the <TT>Animator</TT> class to create motion in your applets. The <TT>Animator</TT> class comes with the JDK 1.2 as an example. To use this class, you pass various parameters to the <TT>Animator</TT> class as parameters in your Web page. Here is Sun&#146;s own documentation for the <TT>Animator</TT> class:</P>
<CENTER>
<TABLE WIDTH="85%"><TR>
<TD WIDTH="50%"><TT>&lt;APPLET CODE=&#147;Animator.class&#148;</TT>
<TD>
<TR>
<TD VALIGN="TOP"><TT>WIDTH = &#147;aNumber&#148;</TT>
<TD><TT>the width (in pixels) of<BR>the widest frame</TT>
<TR>
<TD VALIGN="TOP"><TT>HEIGHT = &#147;aNumber&#148;&gt;</TT>
<TD><TT>the height (in pixels) of<BR>the tallest frame</TT>
<TR>
<TD><TT>&lt;PARAM NAME=&#147;IMAGESOURCE&#148;</TT>
<TR>
<TD VALIGN="TOP"><TT>VALUE=&#147;aDirectory&#148;&gt;</TT>
<TD><TT>the directory that has<BR>the animation frames (a series of<BR>pictures in GIF or JPEG<BR>format, by default named T1.gif, T2.gif, ...)</TT>
<TR>
<TD><TT>&lt;PARAM NAME=&#147;STARTUP&#148;</TT>
<TR>
<TD VALIGN="TOP"><TT>VALUE=&#147;aFile&#148;&gt;</TT>
<TD><TT>an image to display at<BR>load time
<TR>
<TD><TT>&lt;PARAM NAME=&#147;BACKGROUND&#148;</TT>
<TR>
<TD VALIGN="TOP"><TT>VALUE=&#147;aFile&#148;&gt;</TT>
<TD><TT>an image to paint the<BR>frames against</TT>
<TR>
<TD><TT>&lt;PARAM NAME=&#147;STARTIMAGE&#148;</TT>
<TR>
<TD VALIGN="TOP"><TT>VALUE=&#147;aNumber&#148;&gt;</TT>
<TD><TT>number of the starting<BR>frame (1..n)</TT>
<TR>
<TD><TT>&lt;PARAM NAME=&#147;ENDIMAGE&#148;</TT>
<TR>
<TD VALIGN="TOP"><TT>VALUE=&#147;aNumber&#148;&gt;</TT>
<TD><TT>number of the end frame<BR>(1..n)</TT>
<TR>
<TD><TT>&lt;PARAM NAME=&#147;NAMEPATTERN&#148;</TT>
<TR>
<TD VALIGN="TOP"><TT>VALUE=&#147;dir/prefix%N.suffix&#148;</TT>
<TD><TT>a pattern to use for<BR>generating names<BR>based on STARTIMAGE and<BR>ENDIMAGE (See below.)</TT>
<TR>
<TD><TT>&lt;PARAM NAME=&#147;PAUSE&#148;</TT>
<TR>
<TD VALIGN="TOP"><TT>VALUE=&#148;100&#148;&gt;</TT>
<TD><TT>milliseconds to pause<BR>between images<BR>default (can be overriden<BR>by PAUSES)</TT>
<TR>
<TD><TT>&lt;PARAM NAME=&#147;PAUSES&#148;</TT>
<TR>
<TD VALIGN="TOP"><TT>VALUE=&#147;300|200||400|200&#148;&gt;</TT>
<TD><TT>millisecond delay per<BR>frame. Blank<BR>uses default PAUSE value</TT>
<TR>
<TD><TT>&lt;PARAM NAME=&#147;REPEAT&#148;</TT>
<TR>
<TD><TT>VALUE=&#147;true&#148;&gt;</TT>
<TD><TT>repeat the sequence?</TT>
<TR>
<TD><TT>&lt;PARAM NAME=&#147;POSITIONS&#148;</TT>
<TR>
<TD COLSPAN="2"><TT>VALUE=&#147;100@200||200@100||200@200|100@100|105@105&#148;&gt;</TT>
<TR>
<TD>
<TD><TT>positions (X@Y) for each<BR>frame. Blank means use previous<BR>frame&#146;s position</TT>
<TR>
<TD><TT>&lt;PARAM NAME=&#147;IMAGES&#148;</TT>
<TR>
<TD VALIGN="TOP"><TT>VALUE=&#147;3|3|2|1|2|3|17&#148;&gt;</TT>
<TD><TT>explicit order for frames<BR>(see below)</TT>
<TR>
<TD><TT>&lt;PARAM NAME=&#147;SOUNDSOURCE&#148;</TT>
<TR>
<TD VALIGN="TOP"><TT>VALUE=&#147;aDirectory&#148;&gt;</TT>
<TD><TT>the directory that has the<BR>audio files</TT>
<TR>
<TD><TT>&lt;PARAM NAME=&#147;SOUNDTRACK&#148;</TT>
<TR>
<TD VALIGN="TOP"><TT>VALUE=&#147;aFile&#148;&gt;</TT>
<TD><TT>an audio file to play<BR>throughout</TT>
<TR>
<TD><TT>&lt;PARAM NAME=&#147;SOUNDS&#148;</TT>
<TR>
<TD VALIGN="TOP"><TT>SOUNDS=&#148;aFile.au|||||bFile.au&#148;&gt;</TT>
<TD><TT>audio files keyed to<BR>individual frames</TT>
<TR>
<TD><TT>&lt;/APPLET&gt;</TT>
</TABLE>
</CENTER>
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="442-446.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="450-452.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>





</BODY>
</HTML>

