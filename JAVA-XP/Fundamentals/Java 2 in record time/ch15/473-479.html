<HTML>
<HEAD>

<TITLE>Java 1.2 In Record Time:More Graphics Animation Power</TITLE>




<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="470-473.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="479-483.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>And the new version of dauber is ready to run. Run the applet now, as shown in Figure 15.5. When you draw a new figure, that figure stretches until you release the mouse button. The code for this applet appears in <TT>dauber.java</TT>, version 2.</P>
<P><A NAME="Fig10"></A><A HREF="images\15-10.jpg"><IMG SRC="images\15-10t.jpg"></A>
<BR><A HREF="images\15-10.jpg"><FONT COLOR="#000077"><B>FIGURE 15.5</B></FONT></A>&nbsp;&nbsp;Now you can stretch figures in dauber, implementing user-driven animation.</P>
<P><B>dauber.java, version 2</B></P>
<PRE>
 import java.awt.Graphics;
 import java.awt.*;
 import java.awt.event.*;
 import java.lang.Math;
 import java.applet.Applet;

 public class dauber extends Applet implements ActionListener,
 MouseListener MouseMotionListener &#123;

     Button buttonDraw, buttonLine, buttonOval, buttonRect, button3DRect;
     Button buttonRounded;

     Point pts[] = new Point[1000];
     Point ptAnchor, ptDrawTo, ptOldDrawTo;
     int ptindex = 0;

     boolean bMouseDownFlag = false;
     boolean bMouseUpFlag = false;
     boolean bDrawFlag = false;
     boolean bLineFlag = false;
     boolean bOvalFlag = false;
     boolean bRectFlag = false;
     boolean b3DRectFlag = false;
     boolean bRoundedFlag = false;

     public void init() &#123;

          buttonDraw = new Button("Draw Freehand");
          buttonLine = new Button("Line");
          buttonOval = new Button("Oval");
          buttonRect = new Button("Rect");
          button3DRect = new Button("3D Rect");
          buttonRounded = new Button("Round");

          add(buttonDraw);
          buttonDraw.addActionListener(this);
          add(buttonLine);
          buttonLine.addActionListener(this);
          add(buttonOval);
          buttonOval.addActionListener(this);
          add(buttonRect);
          buttonRect.addActionListener(this);
          add(button3DRect);
          button3DRect.addActionListener(this);
          add(buttonRounded);
          buttonRounded.addActionListener(this);
          addMouseListener(this);
          addMouseMotionListener(this);
          ptAnchor = new Point(0, 0);
          ptOldDrawTo = new Point(0, 0);
          ptDrawTo = new Point(0, 0);
     &#125;

     public void mousePressed(MouseEvent e)&#123;
          bMouseDownFlag = true;
          bMouseUpFlag = false;
          ptOldDrawTo = new Point(e.getX(), e.getY());
          ptDrawTo = new Point(e.getX(), e.getY());
          ptAnchor = new Point(e.getX(), e.getY());
     &#125;

     public void mouseReleased(MouseEvent e)&#123;
          bMouseDownFlag = false;
          bMouseUpFlag = true;
          ptOldDrawTo = ptDrawTo;
          ptDrawTo = new Point(e.getX(), e.getY());
          if(!bLineFlag)&#123;
               ptDrawTo = new Point(Math.max(ptAnchor.x, ptDrawTo.x), &#8658;
 Math.max(ptAnchor.y, ptDrawTo.y));
               ptAnchor = new Point(Math.min(ptDrawTo.x, ptAnchor.x), &#8658;
 Math.min(ptDrawTo.y, ptAnchor.y));
          &#125;
          repaint();

     &#125;

     public void mouseDragged(MouseEvent e)&#123;
          if(bDrawFlag)&#123;
               pts[ptindex] = new Point(e.getX(), e.getY());
               ptindex&#43;&#43;;
          &#125;
          else&#123;
               ptOldDrawTo = ptDrawTo;
               ptDrawTo = new Point(e.getX(), e.getY());
          &#125;
          repaint();
     &#125;

     public void mouseClicked(MouseEvent e)&#123;&#125;

     public void mouseEntered(MouseEvent e)&#123;&#125;

     public void mouseExited(MouseEvent e)&#123;&#125;

     public void mouseMoved(MouseEvent e)&#123;&#125;

     public void paint (Graphics g) &#123;
          int loop_index;
          int figureWidth, figureHeight;
          Point topLeft;

          if(bDrawFlag)&#123;
               for(loop_index = 0; loop_index &lt; ptindex - 1;
               loop_index&#43;&#43;)&#123;
               g.drawLine(pts[loop_index].x, pts[loop_index].y, &#8658;
 pts[loop_index &#43; 1].x, pts[loop_index &#43; 1].y);
               &#125;
               return;
          &#125;

          g.setColor(new Color(0, 0, 0));
          g.setXORMode(getBackground());

          topLeft = new Point(Math.min(ptAnchor.x, ptOldDrawTo.x),
          &#8658; Math.min(ptAnchor.y, ptOldDrawTo.y));
          figureWidth = Math.abs(ptOldDrawTo.x - ptAnchor.x);
          figureHeight = Math.abs(ptOldDrawTo.y - ptAnchor.y);

          if(bLineFlag)&#123;
               g.drawLine(ptAnchor.x, ptAnchor.y, ptOldDrawTo.x, &#8658;
 ptOldDrawTo.y);
          &#125;
          if(bOvalFlag)&#123;
               g.drawOval(topLeft.x, topLeft.y, figureWidth, figureHeight);
          &#125;
          if(bRectFlag)&#123;
               g.drawRect(topLeft.x, topLeft.y, figureWidth, figureHeight);
          &#125;
          if(b3DRectFlag)&#123;
               g.draw3DRect(topLeft.x, topLeft.y, figureWidth, &#8658;
 FigureHeight  true);
          &#125;
          if(bRoundedFlag)&#123;
               g.drawRoundRect(topLeft.x, topLeft.y, figureWidth, &#8658;
 figureHeight, 10, 10);
          &#125;

          g.setColor(getBackground());
          topLeft = new Point(Math.min(ptAnchor.x, ptDrawTo.x), &#8658;
 Math.min(ptAnchor.y, ptDrawTo.y));

          figureWidth = Math.abs(ptDrawTo.x - ptAnchor.x);
          figureHeight = Math.abs(ptDrawTo.y - ptAnchor.y);

          if(bLineFlag)&#123;
               g.drawLine(ptAnchor.x, ptAnchor.y,
               ptDrawTo.x, ptDrawTo.y);
          &#125;
          if(bOvalFlag)&#123;
               g.drawOval(topLeft.x, topLeft.y,
               figureWidth, figureHeight);
          &#125;
          if(bRectFlag)&#123;
               g.drawRect(topLeft.x, topLeft.y,
               figureWidth, figureHeight);
          &#125;
          if(b3DRectFlag)&#123;
               g.draw3DRect(topLeft.x, topLeft.y,
               figureWidth, &#8658;
               figureHeight, true);
          &#125;
          if(bRoundedFlag)&#123;
               g.drawRoundRect(topLeft.x, topLeft.y, figureWidth, &#8658;
 figureHeight, 10, 10);
          &#125;
     &#125;

     public void actionPerformed(ActionEvent e)&#123;
          if(e.getSource() == buttonDraw)&#123;
               bDrawFlag = !bDrawFlag;
               bLineFlag = false;
               bOvalFlag = false;
               bRectFlag = false;
               b3DRectFlag = false;
               bRoundedFlag = false;
          &#125;
          if(e.getSource() == buttonLine)&#123;
               bLineFlag = !bLineFlag;
               bDrawFlag = false;
               bOvalFlag = false;
               bRectFlag = false;
               b3DRectFlag = false;
               bRoundedFlag = false;
          &#125;
          if(e.getSource() == buttonOval)&#123;
               bOvalFlag = !bOvalFlag;
               bLineFlag = false;
               bDrawFlag = false;
               bRectFlag = false;
               b3DRectFlag = false;
               bRoundedFlag = false;
          &#125;
          if(e.getSource() == buttonRect)&#123;
               bRectFlag = !bRectFlag;
               bLineFlag = false;
               bOvalFlag = false;
               bDrawFlag = false;
               b3DRectFlag = false;
               bRoundedFlag = false;
          &#125;
          if(e.getSource() == button3DRect)&#123;
               b3DRectFlag = !b3DRectFlag;
               bLineFlag = false;
               bOvalFlag = false;
               bRectFlag = false;
               bDrawFlag = false;
               bRoundedFlag = false;
          &#125;
          if(e.getSource() == buttonRounded)&#123;
               bRoundedFlag = !bRoundedFlag;
               bLineFlag = false;
               bOvalFlag = false;
               bRectFlag = false;
               b3DRectFlag = false;
               bDrawFlag = false;
           &#125;
      &#125;
 &#125;
</PRE>
<P>Your improved dauber applet is complete, and it&#146;s pretty powerful, thanks to the Java <TT>Graphics</TT> class.</P>
<P>The last animation topic we&#146;ll take up in this skill is using the card layout manager. With this new layout manager, you can animate not just images, but whole panels complete with controls. Let&#146;s look at that now.</P><P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="470-473.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="479-483.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>





</BODY>
</HTML>

