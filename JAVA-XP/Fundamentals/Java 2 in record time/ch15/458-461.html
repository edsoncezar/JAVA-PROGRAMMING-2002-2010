<HTML>
<HEAD>

<TITLE>Java 1.2 In Record Time:More Graphics Animation Power</TITLE>




<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="453-458.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="462-467.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<H4 ALIGN="LEFT"><A NAME="Heading4"></A><FONT COLOR="#000077">Implementing the <I>run()</I> Method
</FONT></H4>
<P>Now that you&#146;ve drawn your images, it&#146;s time to create the <TT>run()</TT> method. In this case, simply cause the<TT> paint()</TT> method to be called repeatedly by calling <TT>repaint()</TT> every .2 seconds:</P>
<PRE>
 import java.awt.*;
 import java.applet.Applet;

 public class doublebuffer extends Applet implements Runnable&#123;

     Image memoryimage;
     Graphics memorygraphics;
     Thread doublebufferthread;

     public void init() &#123;
          memoryimage = createImage(100, 100);
          memorygraphics = memoryimage.getGraphics();
     &#125;

     public void start() &#123;
          doublebufferthread = new Thread(this);
          doublebufferthread.start();
     &#125;

     public void stop() &#123;
          doublebufferthread.stop();
     &#125;

&#8594;    public void run() &#123;
&#8594;         while(animateFlag)&#123;
&#8594;              repaint();
&#8594;              try &#123;Thread.sleep(200);&#125;
&#8594;              catch(InterruptedException e) &#123; &#125;
&#8594;         &#125;
&#8594;     &#125;
</PRE>
<P>You&#146;ll put the real code in the <TT>paint()</TT> method, so open that method now:</P>
<PRE>
     public void paint (Graphics g) &#123;
               .
               .
               .
 &#125;
</PRE>
<P>You will need a loop index to keep track of the current size of your rectangle. Call the index <TT>loop_index</TT> and add it to your applet as follows:</P>
<PRE>
 import java.awt.*;
 import java.applet.Applet;

 public class doublebuffer extends Applet implements Runnable&#123;

     Image memoryimage;
     Graphics memorygraphics;
     Thread doublebufferthread;
     boolean animateFlag = true;
&#8594;    int loop_index = 0;
          .
          .
          .
</PRE>
<P>In this example, you&#146;ll make each box five pixels larger than the last, so you&#146;ll increment the <TT>loop_index</TT> variable by five each time the <TT>paint()</TT> method is called:</P>
<PRE>
     public void paint (Graphics g) &#123;

          loop_index &#43;= 5;
               .
               .
               .
 &#125;
</PRE>
<P>And if that loop index exceeds 100 pixels (the size of the image), you can set it back to 5:
</P>
<PRE>
     public void paint (Graphics g) &#123;

          loop_index &#43;= 5;
&#8594;         if(loop_index &gt;= 100) loop_index = 5;
               .
               .
               .
     &#125;
</PRE>
<P>Now you can draw the box itself in your <TT>memorygraphics</TT> object. Because you also want to draw over any previous boxes, you&#146;ll start by drawing a white rectangle to clear the display. To do that, first set the drawing color in the applet to white (with red, green, and blue color values of 255, 255, and 255) with the Graphics <TT>setColor()</TT> method, which you can use with your memory graphics object, <TT>memorygraphics</TT>:</P>
<PRE>
     public void paint (Graphics g) &#123;

          loop_index &#43;= 5;
          if(loop_index &gt;= 100) loop_index = 5;

&#8594;         memorygraphics.setColor(new Color(255, 255, 255));
                    .
                    .
                    .
     &#125;
</PRE>
<P>Next, draw your filled-in rectangle with the <TT>fillRect()</TT> method to erase any previous rectangles:</P>
<PRE>
     public void paint (Graphics g) &#123;

          loop_index &#43;= 5;
          if(loop_index &gt;= 100) loop_index = 5;

          memorygraphics.setColor(new Color(255, 255, 255));
&#8594;         memorygraphics.fillRect(0, 0, 100, 100);
                    .
                    .
                    .
     &#125;
</PRE>
<P>At this point, you are ready to draw your box in the memory image, so set the drawing color back to black (color values 0, 0, 0):
</P>
<PRE>
     public void paint (Graphics g) &#123;

          loop_index &#43;= 5;
          if(loop_index &gt;= 100) loop_index = 5;

          memorygraphics.setColor(new Color(255, 255, 255));
          memorygraphics.fillRect(0, 0, 100, 100);
&#8594;         memorygraphics.setColor(new Color(0, 0, 0));
                    .
                    .
                    .
     &#125;
</PRE>
<P>Then draw the box itself using the <TT>loop_index</TT> (incremented by 5 each time you draw an image) as the extent of the box:</P>
<PRE>
     public void paint (Graphics g) &#123;

          loop_index &#43;= 5;
          if(loop_index &gt;= 100) loop_index = 5;

          memorygraphics.setColor(new Col .,or(255, 255, 255));
          memorygraphics.fillRect(0, 0, 100, 100);
          memorygraphics.setColor(new Color(0, 0, 0));
&#8594;         memorygraphics.drawRect(0, 0, loop_index, loop_index);
                    .
                    .
                    .
     &#125;
</PRE>
<P>And finally, draw the new image with the <TT>Graphics</TT> class&#146;s <TT>drawImage()</TT> method:</P>
<PRE>
     public void paint (Graphics g) &#123;

          loop_index &#43;= 5;
          if(loop_index &gt;= 100) loop_index = 5;

          memorygraphics.setColor(new Color(255, 255, 255));
          memorygraphics.fillRect(0, 0, 100, 100);
          memorygraphics.setColor(new Color(0, 0, 0));
          memorygraphics.drawRect(0, 0, loop_index, loop_index);

&#8594;         g.drawImage(memoryimage, 10, 10, this);
     &#125;
</PRE>
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="453-458.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="462-467.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>





</BODY>
</HTML>

