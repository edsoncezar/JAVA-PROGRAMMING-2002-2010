<HTML>
<HEAD>

<TITLE>Java 1.2 In Record Time:Displaying and Stretching Images</TITLE>




<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="337-341.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="346-350.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<P>Another way to use the <TT>getImage()</TT> method is to pass the URL of the directory containing the image and the name of the image file like this: <TT>getImage(url, &#147;figure.jpg&#148;);</TT>. In this case, you can assume the figure is in the same directory as the file <TT>figure.jpg</TT>, and you can use the handy <TT>Applet</TT> method <TT>getCodeBase()</TT>. This method returns the URL of the <TT>.class</TT> file you are executing, and that means you can read your image in the applet&#146;s <TT>init()</TT> method as follows:</P>
<PRE>
 import java.awt.*;
 import java.awt.event.*;
 import java.applet.Applet;

 public class imagesizer extends Applet &#123;

      Image image;

      public void init() &#123;
&#8594;               image = getImage(getCodeBase(), "figure.jpg");
                     .
                     .
                     .
      &#125;
</PRE>
<P>The line of code marked above reads the image into your applet and stores it in the <TT>Image</TT> object, <TT>image</TT>. In addition, you can add a MouseListener to your applet in <TT>init()</TT>:</P>
<PRE>
 import java.awt.*;
 import java.awt.event.*;
 import java.applet.Applet;

&#8594;     public class imagesizer extends Applet implements MouseListener&#123;

      Image image;
      boolean bMouseDownFlag = false;
      boolean bMouseUpFlag = false;
      Point ptAnchor, ptDrawTo;

      public void init() &#123;
           image = getImage(getCodeBase(), "figure.jpg");
&#8594;               addMouseListener(this);
      &#125;
</PRE>
<P>You&#146;ll set up your applet much like the dauber applet was set up: when the user presses the mouse button, you can set the anchor point, and when they release it, you can draw your image in the given rectangle:
</P>
<P><A NAME="Fig3"></A><A HREF="images\11-03.jpg"><IMG SRC="images\11-03t.jpg"></A></P>
<P>Add those points to your applet now:
</P>
<PRE>
 import java.awt.*;
 import java.awt.event.*;
 import java.applet.Applet;

 public class imagesizer extends Applet implements MouseListener &#123;

      Image image;
&#8594;          Point ptAnchor, ptDrawTo;
                .
                .
                .
</PRE>
<P>In addition, you can keep track of the mouse state with two flags, <TT>bMouseUpFlag</TT> and <TT>bMouseDownFlag</TT>, as you did in the dauber applet. You should add those flags to your applet now:</P>
<PRE>
 import java.awt.*;
 import java.awt.event.*;
 import java.applet.Applet;

 public class imagesizer extends Applet implements MouseListener &#123;

      Image image;
&#8594;          boolean bMouseDownFlag = false;
&#8594;          boolean bMouseUpFlag = false;
      Point ptAnchor, ptDrawTo;
                .
                .
                .
</PRE>
<P>When the user presses the mouse button, you can store the location at which they did so (the anchor point) and set the mouse flags in the <TT>mousePressed()</TT> method:</P>
<PRE>
&#8594;     public void mousePressed(MouseEvent e)&#123;
&#8594;          bMouseDownFlag = true;
&#8594;          bMouseUpFlag = false;
&#8594;          ptAnchor = new Point(e.getX(), e.getY());
&#8594;     &#125;
</PRE>
<P>Next, add the <TT>mouseReleased()</TT> method:</P>
<PRE>
     public void mouseReleased(MouseEvent e)&#123;
                    .
                    .
                    .
     &#125;
</PRE>
<P>Here you first set the mouse flags:
</P>
<PRE>
     public void mouseReleased(MouseEvent e)&#123;
&#8594;              bMouseDownFlag = false;
&#8594;              bMouseUpFlag = true;
               .
               .
               .
     &#125;
</PRE>
<P>When the user releases the mouse button, you can set the DrawTo point. In fact, you should order the Anchor and DrawTo points as you did in the dauber applet, so the Anchor point is at upper left and the DrawTo point is at lower right:
</P>
<PRE>
     public void mouseReleased(MouseEvent e)&#123;
          bMouseDownFlag = false;
          bMouseUpFlag = true;

          ptDrawTo = new Point(Math.max(e.getX(), ptAnchor.x),
 Math.max(e.getY(), ptAnchor.y));
          ptAnchor = new Point(Math.min(e.getX(), ptAnchor.x),
 Math.min(e.getY(), ptAnchor.y));
                .
                .
                .
     &#125;
</PRE>
<P>Now you&#146;re ready to draw the image. You do that in the <TT>paint()</TT> method, so call <TT>repaint()</TT> here to make sure <TT>paint()</TT> is called:</P>
<PRE>
     public void mouseReleased(MouseEvent e)&#123;
          bMouseDownFlag = false;
          bMouseUpFlag = true;

          ptDrawTo = new Point(Math.max(e.getX(), ptAnchor.x),
 Math.max(e.getY(), ptAnchor.y));
          ptAnchor = new Point(Math.min(e.getX(), ptAnchor.x),
 Math.min(e.getY(), ptAnchor.y));
          repaint();
      &#125;
</PRE>
<H4 ALIGN="LEFT"><A NAME="Heading3"></A><FONT COLOR="#000077">Displaying Images in Java</FONT></H4>
<P>Because you have the image in the <TT>image</TT> object, and the coordinates in which to draw it, you can now draw your image. Add the <TT>paint()</TT> method below.</P>
<PRE>
     public void paint (Graphics g) &#123;
               .
               .
               .
     &#125;
</PRE>
<P>First, check to make sure you should be drawing your image by making sure the mouse is up:
</P>
<PRE>
     public void paint (Graphics g) &#123;

          if(bMouseUpFlag)&#123;
               .
               .
               .
          &#125;
     &#125;
</PRE>
<P>If the mouse is up, you will use the <TT>drawImage()</TT> method to draw your image in the given coordinates. To do that, you&#146;ll need the width and height of your image, and you get those measurements as follows:</P>
<PRE>
     public void paint (Graphics g) &#123;
          int drawWidth, drawHeight;

          if(bMouseUpFlag)&#123;

&#8594;                   drawWidth = ptDrawTo.x - ptAnchor.x;
&#8594;                   drawHeight = ptDrawTo.y - ptAnchor.y;
                              .
                              .
                              .
          &#125;
     &#125;
</PRE>
<P>Next, draw a rectangle to surround your image:
</P>
<PRE>
     public void paint (Graphics g) &#123;
          int drawWidth, drawHeight;

          if(bMouseUpFlag)&#123;
               drawWidth = ptDrawTo.x - ptAnchor.x;
               drawHeight = ptDrawTo.y - ptAnchor.y;
&#8594;                   g.drawRect(ptAnchor.x, ptAnchor.y, drawWidth,
 drawHeight);
                    .
                    .
                    .
          &#125;
      &#125;
</PRE>
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="337-341.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="346-350.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>





</BODY>
</HTML>

