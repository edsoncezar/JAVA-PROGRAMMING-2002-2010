<HTML>
<HEAD>

<TITLE>Java 1.2 In Record Time:Setting and Modifying Text and Fonts</TITLE>




<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="414-420.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="..\ch14\425-430.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<P><BR></P>
<H3><A NAME="Heading8"></A><FONT COLOR="#000077">Using the Clipboard from Java</FONT></H3>
<P>To see how to use the clipboard in Java, place a small text string, &#147;Hello from Java&#148;, into the clipboard. Then you&#146;ll be able to paste that text string into other programs, like Microsoft Word (using Word&#146;s Paste menu item). Create a new file named <TT>clipboarder.java</TT> now. This program will be a Java application because, as is the case with printing, applets cannot access the clipboard for security reasons. Add the application&#146;s main class to <TT>clipboarder.java</TT> now:</P>
<PRE>
 public class clipboarder &#123;
           .
           .
           .
 &#125;
</PRE>
<P>Because this is a Java application, add a <TT>main()</TT> method:</P>
<PRE>
 public class clipboarder &#123;
      public static void main(String[] argv) &#123;
                .
                .
                .
      &#125;
 &#125;
</PRE>
<P>Here you can simply create a new object of the class you&#146;ll name <TT>writetext</TT>, which will write to the clipboard. You create that object this way:</P>
<PRE>
 public class clipboarder &#123;
      public static void main(String[] argv) &#123;
           writetext w = new writetext();
      &#125;
 &#125;
</PRE>
<P>Next, write the <TT>writetext</TT> class. You&#146;ll need a frame window to implement the ClipboardOwner interface, so you can start with the following code:</P>
<PRE>
 class writetext extends Frame &#123;
           .
           .
           .
 &#125;
</PRE>
<P>To handle clipboard operations, add the ClipboardOwner interface this way:
</P>
<PRE>
&#8594;class writetext extends Frame implements ClipboardOwner  &#123;
           .
           .
           .
 &#125;
</PRE>
<P>Now create the <TT>writetext</TT> class&#146;s constructor and the <TT>lostOwnership()</TT> method, which is required to implement this interface:</P>
<PRE>
 class writetext extends Frame implements ClipboardOwner &#123;
&#8594;     writetext() &#123;
      &#125;

&#8594;     public void lostOwnership(Clipboard clipboard, Transferable &#8594;
 contents)&#123;&#125;
 &#125;
</PRE>
<P>You can get an object of the <TT>Clipboard</TT> class as follows:</P>
<PRE>
 class writetext extends Frame implements ClipboardOwner &#123;
      writetext() &#123;
&#8594;          Clipboard clipboard = getToolkit().getSystemClipboard();
               .
               .
               .
      &#125;

      public void lostOwnership(Clipboard clipboard, Transferable &#8594;
 contents)&#123;&#125;
 &#125;
</PRE>
<P>The Java <TT>Clipboard</TT> class&#146;s methods appear in Table 13.3&#151;you can place text in the clipboard with <TT>setContents()</TT>, and you can retrieve it with <TT>getContents()</TT>.</P>
<TABLE WIDTH="100%"><CAPTION ALIGN=LEFT><B>Table 13.3:</B> The <TT>Clipboard</TT> class methods
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TH WIDTH="50%" ALIGN="LEFT">Method
<TH WIDTH="50%" ALIGN="LEFT">Does This
<TR>
<TD COLSPAN="2"><HR>
<TR>
<TD><TT>Clipboard(String)</TT>
<TD>Creates a clipboard object
<TR>
<TD VALIGN="TOP"><TT>getContents(Object)</TT>
<TD>Returns a transferable object representing the current contents of the clipboard
<TR>
<TD><TT>getName()</TT>
<TD>Returns the name of this clipboard object
<TR>
<TD VALIGN="TOP"><TT>setContents(Transferable, ClipboardOwner)</TT>
<TD>Sets the current contents of the clipboard to the specified transferable object and registers the specified clipboard owner as the owner of the new contents
<TR>
<TD COLSPAN="2"><HR>
</TABLE>
<P>Next, create the string of text you want to place in the clipboard with the Java <TT>StringSelection</TT> class; in this case, that string is simply &#147;Hello from Java.&#148;</P>
<PRE>
 class writetext extends Frame implements ClipboardOwner &#123;
      writetext() &#123;
           Clipboard clipboard = getToolkit().getSystemClipboard();
&#8594;          StringSelection contents = new StringSelection("Hello from &#8594;
 Java");
                     .
                     .
                     .
      &#125;

      public void lostOwnership(Clipboard clipboard, Transferable &#8594;
 contents)&#123;&#125;
 &#125;
</PRE>
<P>Finally, place the string into the clipboard with the <TT>Clipboard</TT> class&#146;s <TT>setContents()</TT> method:</P>
<PRE>
 class writetext extends Frame implements ClipboardOwner &#123;
      writetext() &#123;
           Clipboard clipboard = getToolkit().getSystemClipboard();
           StringSelection contents = new StringSelection("Hello from &#8594;
 Java");
&#8594;          clipboard.setContents(contents, this);
      &#125;

      public void lostOwnership(Clipboard clipboard, Transferable &#8594;O
 contents)&#123;&#125;
 &#125;
</PRE>
<P>Use <TT>javac.exe</TT> to compile <TT>clipboarder.java</TT> and <TT>java.exe</TT> to run it. When the application runs, the string &#147;Hello from Java&#148; is placed in the clipboard, and you can paste it into other applications, like Microsoft Word, as shown in Figure 13.4. The code for this application appears in <TT>clipboarder.java</TT>.</P>
<P><A NAME="Fig4"></A><A HREF="images\13-04.jpg"><IMG SRC="images\13-04t.jpg"></A>
<BR><A HREF="images\13-04.jpg"><FONT COLOR="#000077"><B>FIGURE 13.4</B></FONT></A>&nbsp;&nbsp;You can place text into the Clipboard and paste it into other applications such as Microsoft Word.</P>
<P><B>clipboarder.java</B></P>
<PRE>
public class clipboarder &#123;
     public static void main(String[] argv) &#123;
          writetext w = new writetext();
     &#125;
&#125;

class writetext extends Frame implements ClipboardOwner &#123;
     writetext() &#123;
          Clipboard clipboard = getToolkit().getSystemClipboard();
          StringSelection contents = new StringSelection("Hello from &#8658;
Java");
          clipboard.setContents(contents, this);
     &#125;

     public void lostOwnership(Clipboard clipboard, Transferable &#8658;
contents)&#123;&#125;
&#125;
</PRE>
<P>As you can see, working with fonts can be an indispensable technique, allowing you to display text in Java in a wide variety of formats. In Skill 14, you&#146;ll turn to an important and very popular Java topic: graphics animation.
</P>
<H3><A NAME="Heading9"></A><FONT COLOR="#000077">Are You up to Speed?</FONT></H3>
<P><B>Now you can. . .</B></P>
<DL>
<DD><B>&#149;</B>&nbsp;&nbsp;set a program&#146;s font by using <I>setFont()</I>
<DD><B>&#149;</B>&nbsp;&nbsp;make text bold or italic as you require
<DD><B>&#149;</B>&nbsp;&nbsp;read keys directly from the keyboard, using the <I>KeyListener</I> methods
<DD><B>&#149;</B>&nbsp;&nbsp;use the <I>FontMetric</I> class to determine a text string&#146;s length
<DD><B>&#149;</B>&nbsp;&nbsp;center displayed text
<DD><B>&#149;</B>&nbsp;&nbsp;copy and paste text to and from other applications with the system Clipboard
</DL>
<P><BR></P>
<CENTER>
<TABLE BORDER>
<TR>
<TD><A HREF="414-420.html">Previous</A></TD>
<TD><A HREF="..\ewtoc.html">Table of Contents</A></TD>
<TD><A HREF="..\ch14\425-430.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>





</BODY>
</HTML>

