










<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>Loading Images</title>
</head>
<body BGCOLOR="#ffffff">








<table width="100%">
<tr>
<td align=left>
<a href="usingimages.html"><img src="http://docs.rinet.ru/OLDui/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="drawingimages.html"><img src="http://docs.rinet.ru/OLDui/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="http://docs.rinet.ru:8080/OLDui/trailmap.html"><img src="http://docs.rinet.ru/OLDui/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/OLDui/images/uiHeader.gif" width=26 height=26 align=bottom border=0 alt="Creating a User Interface (AWT Only) | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Working with Graphics</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/OLDui/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/OLDui/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    Loading Images
</h2>
<p>
<blockquote>

This page describes how to get the Image object
corresponding to an image.
As long as the image data
is in GIF or JPEG format and you know its filename or URL,
it's easy to get an Image object for it:
just use one of the Applet or Toolkit <code>getImage()</code> methods.
The <code>getImage()</code> methods return immediately,
without checking whether the image data exists.
The actual loading of image data
normally doesn't start until the first time
the program tries to draw the image.

<p>

For many programs, 
this invisible background loading works well.
Others, though, need to
keep track of the progress of the image loading.
This page explains how to do so
using the MediaTracker class and the ImageObserver interface.

<p>

Finally, this page tells you how to 
create images on the fly, 
using a class such as MemoryImageSource.


<h4>Using the getImage() Methods</h4>
<blockquote>

This section discusses first the Applet <code>getImage()</code> methods
and then the Toolkit <code>getImage()</code> methods.

<p>

The Applet class supplies two <code>getImage()</code> methods:

<p>
<ul>
<li> <code>public Image getImage(URL url)</code>
<li> <code>public Image getImage(URL url, String name)</code>
</ul>
<p>

Only applets can use the Applet <code>getImage()</code> methods.
Moreover, the Applet <code>getImage()</code> methods
don't work until the applet has a full context (AppletContext).
For this reason, these methods <em>do not work</em>
if called in a constructor
or in a statement that declares an instance variable.
You should instead call <code>getImage()</code> from a method
such as <code>init()</code>.

<p>

This following code examples show you 
how to use the Applet <code>getImage()</code> methods.
See 
<a target="_top" href="http://docs.rinet.ru:8080/OLDui/applet/practical/gui.html">Creating a GUI</a><a target="_top" href="http://docs.rinet.ru:8080/OLDui/applet/practical/gui.html"><img src="http://docs.rinet.ru/OLDui/images/appletIcon.gif" width=20 height=20 border=0 alt="(in the Writing Applets trail)"></a> for an explanation of the <code>getCodeBase()</code>
and <code>getDocumentBase()</code> methods.

<blockquote>
<pre>
<em>//In a method in an Applet subclass:</em>
Image image1 = getImage(getCodeBase(), "imageFile.gif");
Image image2 = getImage(getDocumentBase(), "anImageFile.jpeg");
Image image3 = getImage(new URL("http://java.sun.com/graphics/people.gif"));
</pre>
</blockquote>
<p>

The Toolkit class declares two more <code>getImage()</code> methods:

<ul>
<li> <code>public abstract Image getImage(URL url)</code>
<li> <code>public abstract Image getImage(String filename)</code>
</ul>
<p>

You can get a Toolkit object either by invoking Toolkit's
<code>getDefaultToolkit()</code> class method
or by invoking the Component <code>getToolkit()</code> instance method.
The Component <code>getToolkit()</code> method
returns the toolkit that was used (or will be used)
to implement the Component.

<p>

Here are examples of using the Toolkit <code>getImage()</code> methods.
Every Java application and applet 
can use these methods,
with applets subject to the usual security restrictions.
You can read about applet security in
<a target="_top" href="http://docs.rinet.ru:8080/OLDui/applet/practical/security.html">Security Restrictions</a><a target="_top" href="http://docs.rinet.ru:8080/OLDui/applet/practical/security.html"><img src="http://docs.rinet.ru/OLDui/images/appletIcon.gif" width=20 height=20 border=0 alt="(in the Writing Applets trail)"></a>.

<blockquote>
<pre>
Toolkit toolkit = Toolkit.getDefaultToolkit();
Image image1 = toolkit.getImage("imageFile.gif");
Image image2 = toolkit.getImage(new URL("http://java.sun.com/graphics/people.gif"));
</pre>
</blockquote>


</blockquote>
<h4>Requesting and Tracking Image Loading:  MediaTracker and ImageObserver</h4>
<blockquote>

The AWT provides two ways for you to track image loading:
the
<a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.awt.MediaTracker.html">MediaTracker</a><a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.awt.MediaTracker.html"><img src="http://docs.rinet.ru/OLDui/images/apiIcon.gif" width=20 height=20 border=0 alt="(in the API reference documentation)"></a> class and the 
<a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.awt.image.ImageObserver.html">ImageObserver</a><a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.awt.image.ImageObserver.html"><img src="http://docs.rinet.ru/OLDui/images/apiIcon.gif" width=20 height=20 border=0 alt="(in the API reference documentation)"></a> interface.
The MediaTracker class is sufficient for many programs.
You just create a MediaTracker instance,
tell it to track one or more images,
and then ask the MediaTracker the status of those images, as needed.
An example is explained in 
<a href=improvingimageanim.html>Improving the Appearance
and Performance of Image Animation.</a>

<p>

The animation example shows 
two particularly useful MediaTracker features:
requesting that the data for a group of images be loaded,
and waiting for a group of images to be loaded.
To request that the image data for a group of images be loaded,
you can use the forms of <code>checkID()</code>
and <code>checkAll()</code> that take a boolean argument.
Setting the boolean argument to <code>true</code>
starts loading the data for any images
that aren't yet being loaded.
Or you can request that the image data be loaded
and wait for it using
the <code>waitForID()</code>
and <code>waitForAll()</code> methods.

<p>

The ImageObserver interface lets you keep
even closer track of image loading than MediaTracker allows.
The Component class uses it
so that components are repainted
as the images they display are loaded.
To use the ImageObserver interface,
you implement the ImageObserver <code>imageUpdate()</code> method
and make sure the implementing object 
is registered as the image observer.
Usually, this registration happens 
when you specify an ImageObserver
to the <code>drawImage</code> method,
as described on the next page.
The <code>imageUpdate()</code> method is called 
whenever information about an image becomes available.

<p>

Here is an example of implementing
the Image Observer interface's <code>imageUpdate()</code> method.
This example uses <code>imageUpdate()</code>
to position two images as soon as their size is known,
and to repaint every 100 milliseconds until both images are loaded.
(Here's the
<a href=http://docs.rinet.ru/OLDui/OLDui/drawing/example/ImageUpdater.java>whole program</a>.)
<blockquote>
<pre>
public boolean imageUpdate(Image theimg, int infoflags,
                           int x, int y, int w, int h) {
    if ((infoflags & (ERROR)) != 0) {
        errored = true;
    }
    if ((infoflags & (WIDTH | HEIGHT)) != 0) {
        positionImages();
    }
    boolean done = ((infoflags & (ERROR | FRAMEBITS | ALLBITS)) != 0);
    // Repaint immediately if we are done, otherwise batch up
    // repaint requests every 100 milliseconds
    repaint(done ? 0 : 100); 
    return !done; //If done, no further updates required.
}
</pre>
</blockquote>

<p>

If you browse the MediaTracker API documentation,
you might notice that the Component class defines
two useful-looking methods:  
<code>checkImage()</code> and <code>prepareImage()</code>.
The MediaTracker class has made these methods largely unnecessary.


</blockquote>
<h4>Creating Images with MemoryImageSource</h4>
<blockquote>

With the help of an image producer such as the
<a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.awt.image.MemoryImageSource.html">MemoryImageSource</a><a target="_top" href="http://java.sun.com/products/jdk/1.1/api/java.awt.image.MemoryImageSource.html"><img src="http://docs.rinet.ru/OLDui/images/apiIcon.gif" width=20 height=20 border=0 alt="(in the API reference documentation)"></a> class,
you can construct images from scratch.
The following code example 
calculates a 100x100 image representing
a fade from black to blue along the X axis
and a fade from black to red along the Y axis.

<blockquote>
<pre>
int w = 100;
int h = 100;
int[] pix = new int[w * h];
int index = 0;
for (int y = 0; y &lt; h; y++) {
    int red = (y * 255) / (h - 1);
    for (int x = 0; x &lt; w; x++) {
          int blue = (x * 255) / (w - 1);
          pix[index++] = (255 &lt;&lt; 24) | (red &lt;&lt; 16) | blue;
    }
}
Image img = createImage(new MemoryImageSource(w, h, pix, 0, w));
</pre>
</blockquote>

<!--Should provide an applet that includes the above code.-->


</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="usingimages.html"><img src="http://docs.rinet.ru/OLDui/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="drawingimages.html"><img src="http://docs.rinet.ru/OLDui/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="http://docs.rinet.ru:8080/OLDui/trailmap.html"><img src="http://docs.rinet.ru/OLDui/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/OLDui/images/uiHeader.gif" width=26 height=26 align=top border=0 alt="Creating a User Interface (AWT Only) | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Working with Graphics</em></strong></a>
</td>
</tr>
</table>
</body>
</html>
