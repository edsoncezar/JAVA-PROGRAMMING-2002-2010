










<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<title>Eliminating Flashing: Overriding the update() Method</title>
</head>
<body BGCOLOR="#ffffff">








<table width="100%">
<tr>
<td align=left>
<a href="noflashing.html"><img src="http://docs.rinet.ru/OLDui/images/PreviousArrow.gif" width=26 height=26 align=bottom border=0 alt="Previous | "></a><a
href="doublebuffer.html"><img src="http://docs.rinet.ru/OLDui/images/NextArrow.gif" width=26 height=26 align=bottom border=0 alt="Next | "></a><a
href="http://docs.rinet.ru:8080/OLDui/trailmap.html"><img src="http://docs.rinet.ru/OLDui/images/WayUpArrow.gif" width=26 height=26 align=bottom border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/OLDui/images/uiHeader.gif" width=26 height=26 align=bottom border=0 alt="Creating a User Interface (AWT Only) | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Working with Graphics</em></strong></a>
</td>
</tr>
</table>
<p>
<center>
<IMG SRC="http://docs.rinet.ru/OLDui/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
<IMG SRC="http://docs.rinet.ru/OLDui/images/shoeline2.GIF" ALIGN="BOTTOM" BORDER="0" WIDTH="202"
    HEIGHT="25" NATURALSIZEFLAG="3">
</center>
<p> 

<h2>
    Eliminating Flashing: Overriding the update() Method
</h2>
<p>
<blockquote>


To eliminate flashing, 
you must override the <code>update()</code> method.
The reason lies in the way the AWT requests that a Component 
(such as an Applet, Canvas, or Frame)
repaint itself.

<p>
The AWT requests a repaint
by calling the Component's <code>update()</code> method.
The default implementation of <code>update()</code>
clears the Component's background before calling <code>paint()</code>.
Because eliminating flashing requires
that you eliminate all unnecessary drawing,
your first step is always to override <code>update()</code>
so that it clears the entire background 
only when necessary.
When moving drawing code from the <code>paint()</code> method
to <code>update()</code>,
you might need to modify the drawing code
so that it doesn't depend on the background being cleared.

<p>

<strong>Note:</strong>
Even if your implementation of <code>update()</code>
doesn't call <code>paint()</code>,
you must still implement a <code>paint()</code> method.
The reason:  
When an area that your Component displays is suddenly revealed
after being hidden (behind another window, for example),
the AWT calls <code>paint()</code> directly,
without calling <code>update()</code>.
An easy way to implement <code>paint()</code>
is to simply have it call <code>update()</code>.

<p>

Here is the 
<a href=http://docs.rinet.ru/OLDui/OLDui/drawing/example/Update.java>code</a>
for a modified version of the previous example
that implements <code>update()</code>
to eliminate flashing.  
Here is the applet in action:

<p>

<applet codebase=http://docs.rinet.ru:8080/OLDui/OLDui/drawing/example code=Update.class width=450 height=60>
<blockquote>
<hr>
<em>
Your browser can't run 1.0 Java applets.
Here is a snapshot of what you'd see:
</em>
<blockquote><IMG SRC="http://docs.rinet.ru/OLDui/figures/ui/animGraphics.gif" WIDTH="450" HEIGHT="60" ALIGN="BOTTOM" NATURALSIZEFLAG="3" ALT=""></blockquote><hr>
</blockquote>
</applet>

<p>

Here's the new version of the
<code>paint()</code> method,
along with the new <code>update()</code> method.
All of the drawing code that used to be in the <code>paint()</code> method
is now in the <code>update()</code> method.
Significant changes in the drawing code are in <b>bold font</b>.
<blockquote>
<pre>
public void paint(Graphics g) {
    <b>update(g);</b>
}

public void update(Graphics g) {
    <b>Color bg = getBackground();
    Color fg = getForeground();</b>

    ...<em>//same as old paint() method until we draw the rectangle:</em>
            if (fillSquare) {
                g.fillRect(x, y, w, h);
                fillSquare = false;
            } else {
                <b>g.setColor(bg);
                g.fillRect(x, y, w, h);
                g.setColor(fg);</b>
                fillSquare = true;
            } 
    ...<em>//same as old paint() method</em>
<b>}</b>
</pre>
</blockquote>

Note that since the background is no longer automatically cleared,
the drawing code must now draw the non-black rectangles,
as well as the black ones.


<h4>
Clipping the Drawing Area
</h4>
<blockquote>

One technique you might be able to use
in your <code>update()</code> method
is <em>clipping</em> the area you draw.
This doesn't work for the example applet on this page,
since the entire drawing area
changes with every frame.
Clipping works well, though,
when only a small part of the drawing area changes --
such as when the user drags an object
across a background.

<p>

You perform clipping using the <code>clipRect()</code> method.
An example of using <code>clipRect()</code> is in
<a href=improvingimageanim.html>Improving 
the Appearance and Performance of Image Animation</a>.

</blockquote>
</blockquote>
<p>
<hr size=4>
<p> 
<table width="100%">
<tr>
<td align=left>
<a href="noflashing.html"><img src="http://docs.rinet.ru/OLDui/images/PreviousArrow.gif" width=26 height=26 align=top border=0 alt="Previous | "></a><a
href="doublebuffer.html"><img src="http://docs.rinet.ru/OLDui/images/NextArrow.gif" width=26 height=26 align=top border=0 alt="Next | "></a><a
href="http://docs.rinet.ru:8080/OLDui/trailmap.html"><img src="http://docs.rinet.ru/OLDui/images/WayUpArrow.gif" width=26 height=26 align=top border=0 alt="Trail Map | "></a><a
href="..\index.html"><img src="http://docs.rinet.ru/OLDui/images/uiHeader.gif" width=26 height=26 align=top border=0 alt="Creating a User Interface (AWT Only) | "></a>
</td>
<td align=right>
<a href="index.html"><strong><em>Working with Graphics</em></strong></a>
</td>
</tr>
</table>
</body>
</html>
