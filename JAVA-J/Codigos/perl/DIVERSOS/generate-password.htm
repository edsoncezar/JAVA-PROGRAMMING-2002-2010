<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0087)http://www.planet-source-code.com/vb/scripts/ShowCodeAsText.asp?txtCodeId=6345&lngWId=4 -->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content="MSHTML 6.00.2719.2200" name=GENERATOR></HEAD>
<BODY><XMP>    '**************************************
    ' Name: GeneratePassword
    ' Description:With this code, you can ge
    '     nerate a pronounceable password. By modi
    '     fying 3 constants, you can adapt this co
    '     de to your language
    ' By: Gérard Dupont
    '
    '
    ' Inputs:The length of the password
    '
    ' Returns:A string
    '
    'Assumes:None
    '
    'Side Effects:None
    'This code is copyrighted and has limite
    '     d warranties.
    'Please see http://www.Planet-Source-Cod
    '     e.com/xq/ASP/txtCodeId.6345/lngWId.4/qx/
    '     vb/scripts/ShowCode.htm
    'for details.
    '**************************************
    
    <% '**********************************************************************************************
    	'*
    	'*
    	'*		Function GeneratePassword
    	'*				Description	:	Generate a pronounceable password (here in French,
    	'								but you can easily adapt the code to your language
    	'								with other choices for strVowel, strConsonant, strDoubleConsonant
    	'*				Input		:	number of letters
    	'*				Output		:	string
    	'*
    	'**********************************************************************************************
    	
    	Private Function GeneratePassword(LenPassword)
    	'adapt these Const to your language
    			Const strVowel = "aeiou"						'All the vowels except y
    			Const strConsonant = "bcdfghjklmnprstv"			'All the consonants except q,w,x,z
    	Const strDoubleConsonant = "cdfglmnprst"		'These consonants may be double	
    			
    			Dim WriteConsonant			'boolean
    			Dim nbRnd					'a random number
    			Dim i, tmp
    			
    	GeneratePassword = ""
    	WriteConsonant = False
    			Randomize
    	For i = 0 To LenPassword	
    	nbRnd = Rnd
    	'Write a single or a double consonant ?
    	'1.No word begin with a double consonant
    					'2.About 10% of double consonants
    	If GeneratePassword <> "" And (WriteConsonant = False) And (nbRnd < 0.10) Then
    	'choose a double consonant
    	tmp = Mid(strDoubleConsonant, Int(Len(strDoubleConsonant) * Rnd + 1), 1)
    							'write it
    	tmp = tmp & tmp
    							i = i + 1
    	'next letter may be a consonant
    							WriteConsonant = True
    	Else
    							'if the last letter is a vowel, the probability is 90% to have a consonant							
    	If (WriteConsonant = False) And (nbRnd < 0.90) Then
    	'single consonant
    	tmp= Mid(strConsonant, Int(Len(strConsonant) * Rnd + 1), 1)
    	WriteConsonant = True
    							'If the last letter is a double consonant,
    							'the next letter is necessary a vowel !
    	Else
    	'write it
    	tmp = Mid(strVowel,Int(Len(strVowel) * Rnd + 1), 1)
    	WriteConsonant = False
    	End If
    	End If
    	'add a letter
    	GeneratePassword = GeneratePassword & tmp
    	Next
    	
    	'Check password length
    	If Len(GeneratePassword) > LenPassword Then
    	GeneratePassword = Left(GeneratePassword, LenPassword)
    	End If
    	End Function
    	 %>

		</XMP></BODY></HTML>
